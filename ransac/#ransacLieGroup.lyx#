#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass IEEEtran
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 1in
\topmargin 1in
\rightmargin 1in
\bottommargin 1in
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
R-RANSAC with Lie Groups
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
This note assumes the reader has a basic understanding of the theory relating
 to Matrix Lie Groups and their corresponding Lie algebras.
 This includes the matrix exponential and logarithm map, the vector space
 isomorphic to specific Lie algebras, the adjoint of the group and the algebra,
 and the left and right Jacobians.
 It also assumes that the reader has a basic understanding of R-RANSAC.
\end_layout

\begin_layout Section
Terminology, Parameters, and Notation
\end_layout

\begin_layout Standard
The terminology, parameters, and notation used is previous version of R-RANSAC
 have varied which has created confusion and inconsistencies.
 In this section, we hope to solidify certain terminology, parameters and
 notation that are suitable for expanding R-RANSAC to work with Lie Groups,
 and incorporating other improvements we have made to the general algorithm.
\end_layout

\begin_layout Subsection
Terminology
\end_layout

\begin_layout Standard
R-RANSAC has very specific terminology that we that will facilitate the
 discussion.
 
\end_layout

\begin_layout Itemize

\series bold
Phenomenon
\series default
: Something that produces an observable signal.
 In the case of target tracking, the phenomenon is referred to as a 
\series bold
target
\series default
, which is an object that exists in physical space.
\end_layout

\begin_layout Itemize

\series bold
Measurement Source
\series default
: A sensor equipped with an algorithm that captures information from the
 environment and produces meaningful measurements used to observe the target.
\end_layout

\begin_layout Itemize

\series bold
Surveillance Region
\series default
: The portion of the environment that is observable by the measurement sources.
 There is a local surveillance region (LSR) for each measurement source
 and a global surveillance region (GSR) that is a union of all the local
 surveillance regions.
 
\end_layout

\begin_layout Itemize

\series bold
Frame of reference
\series default
: Consists of an abstract coordinate system and the set of physical reference
 points that uniquely fix (locate and orient) the coordinate system and
 standardize measurements within that frame.
 We will often refer to a frame of reference as just 
\series bold
frame
\series default
.
\end_layout

\begin_layout Itemize

\series bold
Local Frame
\series default
: The frame that coincides with a local surveillance region.
\end_layout

\begin_layout Itemize

\series bold
Global Frame
\series default
: The frame that coincides with the global surveillance region.
 It is possible that the global frame is the same as a local frame.
\end_layout

\begin_layout Itemize

\series bold
Sensor Scan
\series default
: When a sensor observes its surveillance region and extracts meaningful
 data.
 For example, the sensor scan of a camera occurs when the camera produces
 a new image of its surveillance region.
\end_layout

\begin_layout Itemize

\series bold
False Measurement
\series default
: A measurement extracted from a sensor scan that does not correspond to
 a phenomenon of interest.
 For example, motion in a camera can generate false measurements due to
 parallax depending on the algorithm.
 Another example is just noisy sensors.
\end_layout

\begin_layout Itemize

\series bold
True Measurement
\series default
: A measurement extracted from a sensor scan that corresponds to a phenomenon
 of interest.
\end_layout

\begin_layout Itemize

\series bold
Model
\series default
: This is simply a model of the phenomenon.
 In regards to target tracking, a model is referred to as a 
\series bold
track
\series default
.
\end_layout

\begin_layout Itemize

\series bold
Model Hypothesis
\series default
: This is a hypothetical model of the phenomenon (i.e.
 a possible model) created by the RANSAC algorithm.
 A model hypothesis that meets certain criteria becomes a model.
 In regards to target tracking, a model hypothesis is referred to as a 
\series bold
track
\series default
 
\series bold
hypothesis
\series default
.
 We will often abbreviate the term and mention only 
\series bold
hypothesis
\series default
.
\end_layout

\begin_layout Itemize

\series bold
Model Likelihood
\series default
: The probability that a model represents an actual target.
\end_layout

\begin_layout Itemize

\series bold
Good
\series default
 
\series bold
Model
\series default
: A model that is deemed very likely to correctly describe a phenomenon,
 based on predefined criteria, becomes a good model.
 In regards to target tracking, a good model is referred to as a 
\series bold
good
\series default
 
\series bold
track
\series default
.
\end_layout

\begin_layout Itemize

\series bold
Poor
\series default
 
\series bold
Model
\series default
: A model that is not a good model.
 In regards to target tracking, a poor model is referred to as a 
\series bold
poor
\series default
 
\series bold
track
\series default
.
\end_layout

\begin_layout Itemize

\series bold
Time Window
\series default
: An interval of time extending into the past from the current time.
\end_layout

\begin_layout Itemize

\series bold
Expired
\series default
 
\series bold
Measurement
\series default
: A measurement that was observed in the past outside the time window.
\end_layout

\begin_layout Itemize

\series bold
Measurement
\series default
 
\series bold
Source
\series default
: An algorithm that takes sensor data and produces a measurement.
 We will often refer to a measurement source as just a source.
\end_layout

\begin_layout Standard
Don't worry if some of the terms do not make much sense now.
 We will elaborate on them later in the text.
\end_layout

\begin_layout Subsection
Parameters
\end_layout

\begin_layout Standard
There are various parameters used throughout R-RANSAC.
 A parameter can either be a scalar or a tuple.
 In case the context doesn't make it clear, we will specify which one is
 a scalar and a tuple.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
noindent
\end_layout

\end_inset

 RANSAC parameters
\end_layout

\begin_layout Itemize
\begin_inset Formula $\ell$
\end_inset

 - max iterations
\end_layout

\begin_layout Itemize
\begin_inset Formula $\tau_{E}$
\end_inset

 - RANSAC early termination threshold
\end_layout

\begin_layout Itemize
\begin_inset Formula $\tau_{I}$
\end_inset

 - RANSAC inlier threshold
\end_layout

\begin_layout Standard
Cluster parameters
\end_layout

\begin_layout Itemize
\begin_inset Formula $\tau_{D}$
\end_inset

 - neighborhood distance threshold
\end_layout

\begin_layout Itemize
\begin_inset Formula $\tau_{C}$
\end_inset

 - cluster min cardinality threshold
\end_layout

\begin_layout Standard
Model Management Parameters
\end_layout

\begin_layout Itemize
\begin_inset Formula $\tau_{S}$
\end_inset

 - Similarity merge threshold
\end_layout

\begin_layout Itemize
\begin_inset Formula $\tau_{\rho}$
\end_inset

 - Good track threshold
\end_layout

\begin_layout Itemize
\begin_inset Formula $\tau_{\alpha}$
\end_inset

- Missed detection threshold
\end_layout

\begin_layout Standard
PDAF
\end_layout

\begin_layout Itemize
\begin_inset Formula $P_{D}$
\end_inset

 - Probability of detection
\end_layout

\begin_layout Itemize
\begin_inset Formula $P_{G}$
\end_inset

 - Probability of being in the validation region
\end_layout

\begin_layout Itemize
\begin_inset Formula $\lambda$
\end_inset

 - The spacial density of false measurements in a local surveillance region
 per sensor scan
\end_layout

\begin_layout Standard
Other
\end_layout

\begin_layout Itemize
\begin_inset Formula $T_{W}$
\end_inset

 - Time window
\end_layout

\begin_layout Itemize
\begin_inset Formula $M$
\end_inset

 - The number of models
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Subsection
Notation
\end_layout

\begin_layout Standard
In this note we are assuming a discrete system whose measurements arrive
 at non-fixed time intervals.
 We denote the current time using a subscript 
\begin_inset Formula $k$
\end_inset

, the previous time using a subscript 
\begin_inset Formula $k^{-}$
\end_inset

, and a previous time using the subscript 
\begin_inset Formula $m$
\end_inset

 such that 
\begin_inset Formula $m\leq k$
\end_inset

.
 We denote the time at the beginning of the time window using 
\begin_inset Formula $0$
\end_inset

.
 For example 
\begin_inset Formula $x_{0}$
\end_inset

 is the state of the system at the beginning of the time window.
 Let 
\begin_inset Formula $\delta_{k}$
\end_inset

 denote the time elapsed from 
\begin_inset Formula $k^{-}$
\end_inset

 to 
\begin_inset Formula $k$
\end_inset

, and 
\begin_inset Formula $\delta_{m:k}$
\end_inset

 denote the time elapsed from 
\begin_inset Formula $m$
\end_inset

 to 
\begin_inset Formula $k$
\end_inset

.
 Note that 
\begin_inset Formula $\delta_{m:k},\delta_{k^{-}}\geq0$
\end_inset

.
 Lastly, let 
\begin_inset Formula $\delta_{-k}=-\delta_{k}$
\end_inset

 and 
\begin_inset Formula $\delta_{k:m}=-\delta_{m:k}$
\end_inset

.
\end_layout

\begin_layout Itemize
Let 
\begin_inset Formula $G$
\end_inset

 denote a Lie group
\end_layout

\begin_layout Itemize
Let 
\begin_inset Formula $\mathfrak{g}$
\end_inset

 denote the Lie algebra of 
\begin_inset Formula $G$
\end_inset


\end_layout

\begin_layout Itemize
Let 
\begin_inset Formula $E$
\end_inset

 denote the Euclidean vector space isomorphic to 
\begin_inset Formula $\mathfrak{g}$
\end_inset


\end_layout

\begin_layout Itemize
Let 
\begin_inset Formula $x\in G\times\mathfrak{g}$
\end_inset

 denote the state of the system
\end_layout

\begin_layout Itemize
Let 
\begin_inset Formula $N$
\end_inset

 denote the measurement space which is a Lie group
\end_layout

\begin_layout Itemize
Let 
\begin_inset Formula $p\left(x\right)$
\end_inset

 denote the probability of 
\begin_inset Formula $x$
\end_inset

, 
\begin_inset Formula $p\left(x,y\right)$
\end_inset

 the joint probability of 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

, and 
\begin_inset Formula $p\left(x|y\right)$
\end_inset

 the probability of 
\begin_inset Formula $x$
\end_inset

 conditioned on 
\begin_inset Formula $y$
\end_inset

.
 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\psi_{k}^{i}$
\end_inset

 The set of measurements received at time 
\begin_inset Formula $k$
\end_inset

 from the 
\begin_inset Formula $i^{th}$
\end_inset

 measurement sensor.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\Psi_{k}$
\end_inset

 The set of measurements received at time 
\begin_inset Formula $k$
\end_inset

.
 
\begin_inset Formula $\Psi_{k}=\cup_{i\in J}\psi_{k}^{i}$
\end_inset

 where 
\begin_inset Formula $J$
\end_inset

 is an index associated with the measurement sources.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\Psi_{m:k}$
\end_inset

 The set of measurements received from time 
\begin_inset Formula $m$
\end_inset

 to time 
\begin_inset Formula $k$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\Psi_{T_{W}}$
\end_inset

 The set of measurements received over the current time window.
 
\end_layout

\begin_layout Itemize
\begin_inset Formula $Y^{i}$
\end_inset

 The set of measurements pertaining to the 
\begin_inset Formula $i^{th}$
\end_inset

 cluster during the time window.
\end_layout

\begin_layout Itemize
\begin_inset Formula $y_{0:k}^{i}$
\end_inset

 A minimum subset of 
\begin_inset Formula $Y^{i}$
\end_inset

 such that the model can be observed using the measurements from 
\begin_inset Formula $y_{0:k}^{i}$
\end_inset

.
 One measurement from 
\begin_inset Formula $y_{0:k}^{i}$
\end_inset

 must be a new measurement and the others are randomly sampled from 
\begin_inset Formula $Y^{i}$
\end_inset

.
\end_layout

\begin_layout Section
Lie Theory Review
\end_layout

\begin_layout Standard
The objective of this section is to provide a review of the pertinent concepts
 of Lie theory that we will use.
 We assume that the reader is familiar with Lie group and Lie algebra theory.
 For those unfamiliar with this material, we refer the interested reader
 primarily to 
\begin_inset CommandInset citation
LatexCommand cite
key "Sola2018"

\end_inset

.
 Solá offers a very gentle introduction to Lie theory that covers the majority
 of information needed to understand this paper.
 We also follow much of the notation prescribed by Solá and Hertzberg in
\begin_inset CommandInset citation
LatexCommand cite
key "Sola2018"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand cite
key "Hertzberg2013"

\end_inset

.
 For those who are interested in a more rigorous treatment of Lie theory,
 we refer the reader to 
\begin_inset CommandInset citation
LatexCommand cite
key "Barfoot2019,Stillwell2008,Hall2003,Bullo2005a,Lee2013,Abraham1998"

\end_inset

.
 In this document we will focus on targets with a discrete system model
 and constant velocity, this is merely to simplify the presentation of the
 material.
 With no loss in generality, everything we present can be extended to targets
 with a continuous system model and constant acceleration by using a semidirect
 product group formed from a Lie group and its Lie algebra to form a new
 Lie group.
 A good discussion of the semidirect product group formed from a Lie group
 and its Lie algebra can be found in 
\begin_inset CommandInset citation
LatexCommand cite
key "Engo2003"

\end_inset

.
 If using a continuous system that requires numerical integration on the
 manifold, we refer the reader to 
\begin_inset CommandInset citation
LatexCommand cite
key "Munthe-Kaas1995,Munthe-Kaas1998,Munthe-Kaas1999"

\end_inset

 which describe the Runge-Kutta-Muthe-Kass numerical integration technique.
 
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $G$
\end_inset

 denote a Lie group and 
\begin_inset Formula $\mathfrak{g}$
\end_inset

 denote it's corresponding Lie algebra.
 The exponential function is a surjective function that maps an element
 of the Lie algebra to an element of the Lie group, and the logarithmic
 map is the inverse of the exponential map.
 We denote both as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{align*}
\exp:\mathfrak{g} & \to G\\
\log:G & \to\mathfrak{g}.
\end{align*}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset

 The definition of these maps is dependent on the Lie group.
 For matrix Lie groups, the exponential and logarithm maps are defined as
 the matrix exponential and matrix logarithm.
 
\end_layout

\begin_layout Standard
The Lie algebra is isomorphic to the Euclidean space 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

 where 
\begin_inset Formula $n$
\end_inset

 is the dimension of the Lie algebra.
 We will denote this Euclidean space as 
\begin_inset Formula $E$
\end_inset

.
 The Wedge function maps an element from the Euclidean space to the Lie
 algebra, and the Vee function is the inverse function which we denote as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{align*}
\cdot^{\wedge}:E\to\mathfrak{g} & \quad\left(v\right)\mapsto v^{\wedge}\\
\cdot^{\vee}:\mathfrak{g}\to V & \quad\left(v^{\wedge}\right)^{\vee}\mapsto v.
\end{align*}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset

.
 The definition of these maps is dependent on the Lie algebra.
 We will rely on context to distinguish between elements of 
\begin_inset Formula $E$
\end_inset

 and 
\begin_inset Formula $\mathfrak{g}$
\end_inset

.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\text{Exp}:E\to G$
\end_inset

 and its inverse be defined as the composite function 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{align*}
\text{Exp}:E\to G & \quad\left(v\right)\mapsto\exp\left(v^{\wedge}\right)\\
\text{Log}:G\to V & \quad\left(g\right)\mapsto\log\left(g\right)^{\vee}.
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Other functions of importance are the box-plus/minus and the o-plus/minus
 defined as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{align*}
\boxplus:G\times\mathfrak{g}\to G & \quad\left(g,u\right)\mapsto g\bullet\exp\left(u\right)\\
\boxminus:G\times G\to\mathfrak{g} & \quad\left(g_{1},g_{2}\right)\mapsto\log\left(g_{2}^{-1}\bullet g_{1}\right)\\
\oplus:G\times E\to G & \quad\left(g,v\right)\mapsto g\bullet\text{Exp}\left(v\right)\\
\ominus:G\times G\to E & \quad\left(g_{1},g_{2}\right)\mapsto\text{Log}\left(g_{2}^{-1}\bullet g\right).
\end{align*}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset

 where 
\begin_inset Formula $\bullet$
\end_inset

 represents the group operator which we will omit in the future, and 
\begin_inset Formula $g_{2}^{-1}$
\end_inset

 is the inverse element of 
\begin_inset Formula $g_{2}$
\end_inset

.
 We have based the definition of these function on left trivializations
 (using vector fields that are left invariant) since we will present the
 material using the left trivialization.
 Note that we could easily use the right trivialization as well.
\end_layout

\begin_layout Standard
The adjoint of 
\begin_inset Formula $G$
\end_inset

 is a representation of 
\begin_inset Formula $G$
\end_inset

 that acts on 
\begin_inset Formula $\mathfrak{g}$
\end_inset

, and is denoted and generically defined as 
\begin_inset Formula 
\begin{align*}
Ad_{g}:\mathfrak{g} & \to\mathfrak{g}\quad\left(u\right)\mapsto gug^{-1}
\end{align*}

\end_inset

where 
\begin_inset Formula $g\in G$
\end_inset

.
 Since the adjoint is a linear function, we can find a matrix version that
 operates on the associated Euclidean space generically defined as 
\begin_inset Formula 
\[
\mathbf{Ad}_{g}:E\to E\quad\left(v\right)\mapsto\mathbf{Ad}_{g}v
\]

\end_inset

where 
\begin_inset Formula $\mathbf{Ad}_{g}$
\end_inset

 is the matrix adjoint representation of 
\begin_inset Formula $G$
\end_inset

.
 
\end_layout

\begin_layout Standard
The adjoint of 
\begin_inset Formula $\mathfrak{g}$
\end_inset

 is a representation of 
\begin_inset Formula $\mathfrak{g}$
\end_inset

 that acts on 
\begin_inset Formula $\mathfrak{g}$
\end_inset

.
 It is also the Lie bracket 
\begin_inset Formula $\left[\cdot,\cdot\right]$
\end_inset

 which we will denoted and generically define as 
\begin_inset Formula 
\[
ad_{u}:\mathfrak{g}\to\mathfrak{g}\quad\left(v\right)\mapsto\left[u,v\right]
\]

\end_inset

where 
\begin_inset Formula $u\in\mathfrak{g}$
\end_inset

.
 Since the adjoint is a linear function, we can find a matrix version that
 operates on the associated Euclidean space generically defined as 
\begin_inset Formula 
\[
\mathbf{ad}_{u}:E\to E\quad\left(v\right)\mapsto\mathbf{ad}_{u}v
\]

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $u\in\mathfrak{g}$
\end_inset

 and 
\begin_inset Formula $\mathbf{ad}_{u}$
\end_inset

 is the matrix adjoint representation of 
\begin_inset Formula $\mathfrak{g}$
\end_inset

.
 
\end_layout

\begin_layout Standard
As stated in 
\begin_inset CommandInset citation
LatexCommand cite
key "Iserles2000a"

\end_inset

, we can defined the differential of the exponential mapping as the 'left
 trivialized' tangent of the exponential map or as the right trivialized'
 tangent of the exponential map.
 These differentials are also commonly called the right and left Jacobians.
 The right Jacobian, 
\begin_inset Formula $J_{r}:E\to GL\left(E\right)$
\end_inset

, is defined as
\begin_inset Formula 
\[
J_{r}\left(v\right)=\frac{^{r}\partial\text{Exp}\left(v\right)}{\partial v},
\]

\end_inset

and the left Jacobian is defined as 
\begin_inset Formula 
\[
J_{l}\left(v\right)=\frac{^{l}\partial\text{Exp}\left(v\right)}{\partial v}.
\]

\end_inset


\end_layout

\begin_layout Standard
Their inverses are defined as 
\begin_inset Formula 
\[
J_{r}^{-1}\left(v\right)=\frac{^{r}\partial\text{Log}\left(v\right)}{\partial v}
\]

\end_inset

and 
\begin_inset Formula 
\[
J_{l}^{-1}\left(v\right)=\frac{^{l}\partial\text{Log}\left(v\right)}{\partial v}.
\]

\end_inset

The right Jacobian has the property that for small 
\begin_inset Formula $\delta v\in E$
\end_inset

 given 
\begin_inset Formula $v\in E$
\end_inset

 we get that 
\begin_inset Formula 
\begin{align*}
\text{Exp}\left(\delta v+u\right) & \approx\text{Exp}\left(v\right)\text{Exp}\left(J_{r}\left(v\right)\delta v\right)\\
\text{Exp}\left(v\right)\text{Exp}\left(\delta v\right) & \approx\text{Exp}\left(v+J_{r}^{-1}\left(v\right)\delta v\right)\\
\text{Log}\left(\text{Exp}\left(v\right)\text{Exp}\left(\delta v\right)\right) & \approx v+J_{r}^{-1}\left(v\right)\delta v.
\end{align*}

\end_inset

The left Jacobian has the similar property that for small 
\begin_inset Formula $\delta v\in E$
\end_inset

 given 
\begin_inset Formula $v\in E$
\end_inset

 we get that
\begin_inset Formula 
\begin{align*}
\text{Exp}\left(v+\delta v\right) & \approx\text{Exp}\left(J_{l}\left(v\right)\delta v\right)\text{Exp}\left(v\right)\\
\text{Exp}\left(\delta v\right)\text{Exp}\left(v\right) & \approx\text{Exp}\left(v+J_{l}^{-1}\left(v\right)\delta v\right)\\
\text{Log}\left(\text{Exp}\left(\delta v\right)\text{Exp}\left(v\right)\right) & \approx v+J_{l}^{-1}\left(v\right)\delta v.
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
The derivation of the left and right Jacobians stems from the Baker-Campbell-Hau
sdorff formula and can be studied in 
\begin_inset CommandInset citation
LatexCommand cite
key "Hall2003"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand cite
key "Barfoot2019"

\end_inset

.
 
\end_layout

\begin_layout Section
Problem Description
\end_layout

\begin_layout Standard
The objective is to estimate the states of multiple dynamic targets given
 a set of measurements from multiple sensors and a dynamic model without
 a prior information about the number of targets in the global surveillance
 region.
 Let the state of the system at time 
\begin_inset Formula $k$
\end_inset

 be given by 
\begin_inset Formula $x_{k}=\left(g_{k},u_{k}\right)\in G\times E$
\end_inset

 where 
\begin_inset Formula $g_{k}\in G$
\end_inset

 and 
\begin_inset Formula $u_{k}\in E$
\end_inset

.
 We assume the system model to be continuous, near constant velocity, and
 time invariant defined as
\begin_inset Formula 
\begin{align*}
\dot{g}_{k} & =\xi_{u_{k}}\left(g_{k}\right)\\
\dot{u}_{k} & =w_{k}^{u},
\end{align*}

\end_inset

where 
\begin_inset Formula $\xi_{u_{k}}\left(g_{k}\right)$
\end_inset

 is an infinitesimal generator constructed from 
\begin_inset Formula $u_{k}$
\end_inset

, 
\begin_inset Formula $w_{k}=\begin{bmatrix}w_{k}^{g}\\
w_{k}^{u}
\end{bmatrix}$
\end_inset

 is process noise sampled from a zero-mean, white-noise, Gaussian distribution
 with covariance 
\begin_inset Formula $Q$
\end_inset

.
 Under the assumption that 
\begin_inset Formula $w_{k}$
\end_inset

 stays constant over a time period 
\begin_inset Formula $\delta_{k}$
\end_inset

 we can discretize the model to get the discrete system model described
 as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "eq:system-model"

\end_inset


\begin_inset Formula 
\begin{align}
g_{k} & =g_{k^{-}}\oplus\left(\delta_{k}u_{k^{-}}+\delta_{k}w_{k}^{g}+\frac{\delta_{k}^{2}}{2}w_{k}^{u}\right)\\
u_{k} & =u_{k^{-}}+\delta_{k}w_{k}^{u}.
\end{align}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset

 This form is similar to the one found in 
\begin_inset CommandInset citation
LatexCommand cite
key "SjÃžberg2019"

\end_inset

, and is an exact solution provided that the Lie group is commutative.
 If the Lie group is not commutative, the exact numeric solution is cumbersome
 if not impossible to derive, thus we will use the system model as an approximat
e numerical solution.
\end_layout

\begin_layout Standard
The complete discrete system is defined as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "eq:system"

\end_inset

 
\begin_inset Formula 
\begin{align}
x_{k} & =f\left(x_{k^{-}},w_{k},\delta_{k}\right)\\
y_{k} & =h\left(x_{k},v_{k}\right),
\end{align}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset

 where 
\begin_inset Formula $f$
\end_inset

 is the system model defined in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:system-model"

\end_inset

, 
\begin_inset Formula $y_{k}\in N$
\end_inset

 is the output and 
\begin_inset Formula $N$
\end_inset

 is a Lie group, 
\begin_inset Formula $h:G\to N$
\end_inset

 is the observation model, and 
\begin_inset Formula $v_{k}$
\end_inset

 is measurement noise sampled from a zero-mean, white-noise, Gaussian distributi
on with covariance 
\begin_inset Formula $R$
\end_inset

.
\end_layout

\begin_layout Standard
The state 
\begin_inset Formula $x$
\end_inset

 is a new Lie group generated from the Cartesian product of 
\begin_inset Formula $G$
\end_inset

 and 
\begin_inset Formula $E$
\end_inset

.
 The Lie algebra of 
\begin_inset Formula $G\times E$
\end_inset

 is simply 
\begin_inset Formula $\mathfrak{g}\times E$
\end_inset

 which is isomorphic to 
\begin_inset Formula $\mathbb{R}^{2n}$
\end_inset

 with 
\begin_inset Formula $n$
\end_inset

 being the dimension of 
\begin_inset Formula $G$
\end_inset

.
 We will denote this space as 
\begin_inset Formula $E^{*}$
\end_inset

.
 All of the operations previously defined are simply inherited.
 For example, let 
\begin_inset Formula $x\in G\times\mathfrak{g}$
\end_inset

 and 
\begin_inset Formula $v=\left(a,b\right)^{\vee}\in E^{*}$
\end_inset

, then 
\begin_inset Formula 
\begin{align*}
x\oplus v & =\left(g,u\right)\oplus v\\
 & =\left(g,u\right)\boxplus\left(a,b\right)\\
 & =\left(g\exp\left(a\right),u+b\right),
\end{align*}

\end_inset

where 
\begin_inset Formula $g\in G$
\end_inset

, 
\begin_inset Formula $a\in\mathfrak{g}$
\end_inset

, and 
\begin_inset Formula $u,b\in E$
\end_inset

.
\end_layout

\begin_layout Section
Lie Group Probability
\end_layout

\begin_layout Standard
In this section we define the prior distribution of the state 
\begin_inset Formula $x$
\end_inset

, the state transition distribution, the likelihood distribution of the
 measurement and other distributions in a Lie group framework necessary
 to develop the theory.
 We follow the convention, notation and terminology from 
\begin_inset CommandInset citation
LatexCommand cite
key "Reid2001,Reid2001a,Thrun2006"

\end_inset

 adapted for the Lie group setting.
 Others have defined these distributions similarly as in 
\begin_inset CommandInset citation
LatexCommand cite
key "Bourmaud2013a,Bourmaud2014"

\end_inset

; however, our derivation is suited for our system model.
 
\end_layout

\begin_layout Standard
We denote the state estimate at time 
\begin_inset Formula $m$
\end_inset

 as 
\begin_inset Formula $\hat{x}_{m}\in G\times E$
\end_inset

 and the actual state as 
\begin_inset Formula $x_{m}\in G\times E$
\end_inset

.
 Let 
\begin_inset Formula $\delta x_{m}\in E^{*}$
\end_inset

 denote a local perturbation around 
\begin_inset Formula $\hat{x}_{m}$
\end_inset

 that is a zero-mean, Gaussian, random variable with error covariance 
\begin_inset Formula $P_{m}$
\end_inset

 such that 
\begin_inset Formula 
\[
x_{m}=\hat{x}_{m}\oplus\delta x_{m}.
\]

\end_inset


\end_layout

\begin_layout Standard
We denote the prior distribution, or the belief distribution as 
\begin_inset Formula $p\left(x_{m}\right)$
\end_inset

 and define it as 
\begin_inset Formula 
\begin{align*}
p\left(x_{m}\right) & =\eta\exp\left(-\frac{1}{2}\left(x_{m}\ominus\hat{x}_{m}\right)^{\top}P_{m}^{-1}\left(x_{m}\ominus\hat{x}_{m}\right)\right)\\
 & =\eta\exp\left(-\frac{1}{2}\delta x_{m}^{\top}P_{m}^{-1}\delta x\right),
\end{align*}

\end_inset

where 
\begin_inset Formula $\eta$
\end_inset

 is a normalizing coefficient corresponding to the Gaussian distribution.
 We will use
\begin_inset Formula $\eta$
\end_inset

 to denote any normalizing coefficient.
 We denote the state transition probability as 
\begin_inset Formula $p\left(x_{m}\mid x_{m^{-}}\right)$
\end_inset

 and define it as 
\begin_inset Formula 
\[
p\left(x_{m}\mid x_{m^{-}}\right)=\eta\exp\left(-\frac{1}{2}\left(x_{m}\ominus f\right)^{\top}Q^{-1}\left(x_{m}\ominus f\right)\right),
\]

\end_inset

where 
\begin_inset Formula $x_{m}\ominus f=x_{m}\ominus f\left(x_{m^{-}},w_{k},\delta_{m}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
We can approximate 
\begin_inset Formula $p\left(x_{m}\mid x_{m^{-}}\right)$
\end_inset

 with a Gaussian distribution by using the first order Taylor series expansion
 of 
\begin_inset Formula $x_{m}\ominus f$
\end_inset

 and treating 
\begin_inset Formula $\delta x_{m^{-}}$
\end_inset

 and 
\begin_inset Formula $w_{m}$
\end_inset

 as perturbations; this is known as linearizing.
 Doing so, yields
\begin_inset Formula 
\[
p\left(x_{m}\mid x_{m^{-}}\right)\approx\eta\exp\left(-\frac{1}{2}\left(x_{m}\ominus\tilde{f}\right)^{\top}\bar{Q}^{-1}\left(x_{m}\ominus\tilde{f}\right)\right),
\]

\end_inset

where
\begin_inset Formula 
\[
x_{m}\ominus\tilde{f}=x_{m}\ominus f\left(\hat{x}_{m},0,\delta_{m}\right)+F_{m}\delta x_{m^{-}}+G_{m}w_{m},
\]

\end_inset

 
\begin_inset Formula 
\begin{align*}
F_{m} & =\left.\frac{\partial x_{m}\ominus f\left(x_{m^{-}},w_{k},\delta_{m}\right)}{\partial x_{m^{-}}}\right|_{\hat{x}_{m^{-}},\hat{w}_{m},\delta_{m}}\\
 & =\begin{bmatrix}\mathbf{Ad}_{\text{Exp}\left(\delta_{m}\hat{u}_{m^{-}}\right)^{-1}}\\
J_{r}\left(\delta_{m}\hat{u}_{m^{-}}\right)
\end{bmatrix},
\end{align*}

\end_inset


\begin_inset Formula 
\begin{align*}
G_{m} & =\left.\frac{\partial x_{m}\ominus f\left(x_{m^{-}},w_{k},\delta_{m}\right)}{\partial w_{m}}\right|_{\hat{x}_{m^{-}},\hat{w}_{m},\delta_{m}}\\
 & =\begin{bmatrix}J_{r}\left(\delta_{m}\hat{u}_{m^{-}}\right)\delta_{m} & J_{r}\left(\delta_{m}\hat{u}_{m^{-}}\right)\frac{\delta_{m}^{2}}{2}\\
I\delta_{m} & 0
\end{bmatrix},
\end{align*}

\end_inset

and 
\begin_inset Formula $\hat{w}$
\end_inset

 is the expected value of the process noise which is zero.
 
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\bar{p}\left(x_{m}\right)$
\end_inset

 denote the probability of 
\begin_inset Formula $x_{m}$
\end_inset

 after state propagation.
 It is calculated as 
\begin_inset Formula 
\[
\bar{p}\left(x_{m}\right)=\int p\left(x_{m}\mid x_{m^{-}}\right)p\left(x_{m^{-}}\right)dx_{m^{-}}.
\]

\end_inset

We approximate 
\begin_inset Formula $\bar{p}\left(x_{m}\right)$
\end_inset

 by linearizing 
\begin_inset Formula $p\left(x_{m}\mid x_{m}\right)$
\end_inset

 so that 
\begin_inset Formula $\bar{p}\left(x_{m}\right)$
\end_inset

 is a Gaussian distribution which is parametrized by the new state estimate
 
\begin_inset Formula $\hat{\bar{x}}_{m}$
\end_inset

 and error covariance 
\begin_inset Formula $\bar{P}_{m}$
\end_inset

.
 We will not include the tedious derivation, but refer the reader to 
\begin_inset CommandInset citation
LatexCommand cite
key "Thrun2006"

\end_inset

.
 The new state estimate and error covariance is calculated as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "eq:Kalman_propagation"

\end_inset

 
\begin_inset Formula 
\begin{align}
\hat{\bar{x}}_{m} & =f\left(\hat{x}_{m^{-}},\hat{w}_{m},\delta_{m}\right)\\
\bar{P}_{m} & =F_{m}P_{m^{-}}F_{m}^{\top}+G_{m}QG_{m}^{\top};
\end{align}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset

this calculation is called the propagation or the prediction step.
\end_layout

\begin_layout Standard
The probability of a measurement conditioned on the state is called the
 measurement probability or likelihood denoted as 
\begin_inset Formula $p\left(y_{m}\mid x_{m}\right)$
\end_inset

, and defined as 
\begin_inset Formula 
\[
p\left(y_{m}\mid x_{m}\right)=\eta\exp\left(-\frac{1}{2}e^{\top}R^{-1}e\right),
\]

\end_inset

where 
\begin_inset Formula 
\[
e=y_{m}\ominus h\left(x_{m},v_{m}\right).
\]

\end_inset

We can linearize the measurement probability to get 
\begin_inset Formula 
\[
p\left(y_{m}\mid x_{m}\right)\approx\eta\exp\left(-\frac{1}{2}\tilde{e}^{\top}R^{-1}\tilde{e}\right)
\]

\end_inset

where
\begin_inset Formula 
\[
\tilde{e}=y_{m}\ominus h\left(\hat{x}_{m},\hat{v}_{m}\right)+H_{m}\delta x_{m}+V_{m}v_{m},
\]

\end_inset

 
\begin_inset Formula 
\begin{align*}
H_{m} & =\left.\frac{\partial y_{m}\ominus h\left(x_{m},v_{m}\right)}{\partial x_{m}}\right|_{\hat{x}_{m},\hat{v}_{m}},\\
 & =\left.\frac{\partial\log\left(\hat{e}\right)}{\partial z}\frac{\partial z}{\partial h^{-1}\left(x_{m},v_{m}\right)}\frac{\partial h\left(x_{m},v_{m}\right)}{\partial x_{m}}\right|_{\hat{x}_{m},\hat{v}_{m}}\\
 & =J_{r}^{-1}\left(\hat{e}\right)\mathbf{Ad}_{y_{m}^{-1}}\left.\frac{\partial h\left(x_{m},v_{m}\right)}{\partial x_{m}}\right|_{\hat{x}_{m},\hat{v}_{m}}
\end{align*}

\end_inset


\begin_inset Formula 
\begin{align*}
V_{m} & =\left.\frac{\partial y_{m}\ominus h\left(x_{m},v_{m}\right)}{\partial v_{m}}\right|_{\hat{x}_{m},\hat{v}_{m}},\\
 & =J_{r}^{-1}\left(\hat{e}\right)\mathbf{Ad}_{y_{m}^{-1}}\left.\frac{\partial h\left(x_{m},v_{m}\right)}{\partial v_{m}}\right|_{\hat{x}_{m},\hat{v}_{m}}
\end{align*}

\end_inset

 
\begin_inset Formula $\hat{e}=y_{m}\ominus h\left(\hat{x}_{m},\hat{v}_{m}\right)$
\end_inset

 and 
\begin_inset Formula $\hat{v}_{m}$
\end_inset

 is the expected value of the measurement noise which is zero.
\end_layout

\begin_layout Standard
The probability of the state given a measurement is called the posterior
 denoted 
\begin_inset Formula $p\left(x\mid y\right)$
\end_inset

 and defined as 
\begin_inset Formula 
\[
p\left(x\mid y\right)=\frac{p\left(y\mid x\right)\bar{p}\left(x\right)}{p\left(y\right)}.
\]

\end_inset

We improve the state estimate 
\begin_inset Formula $\hat{x}_{m}$
\end_inset

 by maximizing the posterior distribution.
 This process is outlined in 
\begin_inset CommandInset citation
LatexCommand cite
key "Thrun2006"

\end_inset

 which gives us the standard Kalman filter update step:
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "eq:Kalman_update"

\end_inset


\begin_inset Formula 
\begin{alignat}{2}
\text{Innovation :} & \quad & \hat{e} & =y_{m}\ominus h\left(\hat{x}_{m},\hat{v}_{m}\right)\\
\text{Innovation cov. :} & \quad & S & =H_{m}\bar{P}_{m}H_{m}^{\top}+V_{m}RV_{m}^{\top}\\
\text{Kalman gain :} & \quad & K & =\bar{P}_{m}H_{m}^{\top}S^{-1}\\
\text{Observed error :} & \quad & \delta x_{m} & =K\hat{e}\\
\text{State update :} & \quad & \hat{x}_{m} & =\hat{\bar{x}}_{m}\oplus\delta x_{m}\\
\text{Cov. update :} & \quad & P_{m} & =P_{m}-KSK^{\top}.
\end{alignat}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset

Depending on the data associating filter used, the update step will be different
; however, the underlying basic idea is the same which will require computing
 the Jacobians 
\begin_inset Formula $F_{m}$
\end_inset

, 
\begin_inset Formula $G_{m}$
\end_inset

, 
\begin_inset Formula $H_{m}$
\end_inset

 and 
\begin_inset Formula $V_{m}$
\end_inset

.
\end_layout

\begin_layout Section
RANSAC
\end_layout

\begin_layout Standard
The objective of RANSAC is to estimate the parameters of a model given a
 set of measurements which contains both false and true measurements.
 We follow a scheme similar to the one presented in 
\begin_inset CommandInset citation
LatexCommand cite
key "Yang2017"

\end_inset

; that is, we perform RANSAC on every cluster seeding it with a measurement
 obtained from the current time.
 This process is described for a single cluster.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $Y$
\end_inset

 denote the set of measurements pertaining to a cluster, and let 
\begin_inset Formula $y_{0:k}$
\end_inset

 be a minimum subset of 
\begin_inset Formula $Y$
\end_inset

 that contains a measurement from the current time 
\begin_inset Formula $k$
\end_inset

 and other measurements randomly sampled from different times such that
 the system can be observed by the measurements in 
\begin_inset Formula $y_{0:k}$
\end_inset

.
 Using the measurements 
\begin_inset Formula $y_{0:k}$
\end_inset

, we create a model hypothesis by estimating a current hypothetical state
 
\begin_inset Formula $x_{k}$
\end_inset

 that fit the measurements according to they system model described in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:system-model"

\end_inset

.
 The hypothetical state 
\begin_inset Formula $x_{k}$
\end_inset

 is estimated using a log maximum likelihood estimate (LMLE) method described
 in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:LMLE"

\end_inset

.
 Once 
\begin_inset Formula $x_{k}$
\end_inset

 is estimated, we construct a consensus set for the model hypothesis.
 The consensus set contains all of the measurements that are inliers to
 the model hypothesis.
 An inlier is a measurement that is within some distance of the estimated
 measurement obtained from 
\begin_inset Formula $x_{k}$
\end_inset

.
 Let 
\begin_inset Formula $d_{I}:N\times N\to\mathbb{R}$
\end_inset

 be a metric on the measurement space 
\begin_inset Formula $N$
\end_inset

, as described in 
\begin_inset CommandInset citation
LatexCommand cite
key "Moon2000"

\end_inset

, and let 
\begin_inset Formula $\tau_{I}\in\mathbb{R}$
\end_inset

 be a threshold, then if 
\begin_inset Formula 
\[
d_{I}\left(y_{m}^{j},\hat{y}_{m}\right)<\tau_{I},
\]

\end_inset

where 
\begin_inset Formula $\hat{y}_{m}$
\end_inset

 is the estimated measurement at time 
\begin_inset Formula $m$
\end_inset

, and 
\begin_inset Formula $y_{m}^{j}$
\end_inset

 is the 
\begin_inset Formula $j^{th}$
\end_inset

 measurement obtained at time 
\begin_inset Formula $m$
\end_inset

, then the measurement 
\begin_inset Formula $y_{m}^{j}$
\end_inset

 is considered an inlier to the model hypothesis and is added to the consensus
 set.
 The estimated measurement 
\begin_inset Formula $\hat{y}_{m}$
\end_inset

 is calculated using model inversion described in subsection 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Model-Inversion"

\end_inset

.
 The metric that we use is defined as 
\begin_inset Formula 
\[
d_{I}\left(y_{m}^{j},\hat{y}_{m}\right)=\left(y_{m}^{i}\ominus\hat{y}_{m}\right)^{\top}\left(R_{k:m}^{j}\right)^{-1}\left(y_{m}^{i}\ominus\hat{y}_{m}\right),
\]

\end_inset

where 
\begin_inset Formula $R_{k:m}^{j}$
\end_inset

 is defined in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:meas_cov_time"

\end_inset

.
 For help choosing 
\begin_inset Formula $\tau_{I}$
\end_inset

, see section 
\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Validation-Region"

\end_inset

.
\end_layout

\begin_layout Standard
This process is repeated at most 
\begin_inset Formula $\ell$
\end_inset

 times so that we have at most 
\begin_inset Formula $\ell$
\end_inset

 model hypothesis from each cluster.
 The model hypothesis with the largest consensus set from each cluster is
 kept and used to create a model using a filtering method that incorporates
 all of the measurements in the consensus set to calculate a current state
 estimate and error covariance.
 The size of the consensus set is not necessarily the cardinality of the
 consensus set.
 We define the size of the consensus set as the number of measurements from
 different sources at each time step.
 For example, if a source provided ten measurements at time 
\begin_inset Formula $k$
\end_inset

 and four of them were added to the consensus set, all four of them would
 count as one.
 The purpose of this definition is to ensure that one source is not weighted
 more heavily than another.
 RANSAC will terminate early if the size of a consensus set is greater than
 or equal to the threshold 
\begin_inset Formula $\tau_{E}$
\end_inset

, and the measurements in a model hypothesis's consensus set are removed
 from the data tree if the model hypothesis become a model.
\end_layout

\begin_layout Standard
The filtering method that we employ uses the Kalman propagation step described
 in equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Kalman_propagation"

\end_inset

 and an update step using centralized measurement fusion described in section
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Centralized-Measurement-Fusion"

\end_inset

.
 The centralized measurement fusion allows multiple measurements from different
 sources to be fused together.
 
\end_layout

\begin_layout Section
Log Maximum Likelihood Estimate
\begin_inset CommandInset label
LatexCommand label
name "sec:LMLE"

\end_inset


\end_layout

\begin_layout Standard
We use LMLE to generate model hypotheses in RANSAC.
 A model hypotheses is created by taking a subset of measurements from a
 cluster 
\begin_inset Formula $y_{0:k}\subseteq Y$
\end_inset

 which contains one measurement from the current time and other measurements
 which are randomly sampled from different times with enough measurements
 in order to estimate the state, i.e.
 the 
\begin_inset Formula $\left|y_{0:k}\right|$
\end_inset

 is greater than or equal to the observability index of the system.
 Using the measurements 
\begin_inset Formula $y_{0:k}$
\end_inset

 we employ the LMLE method to calculate a hypothetical state estimate, i.e.
 a possible state estimate of an actual target.
 
\end_layout

\begin_layout Standard
LMLE estimates the joint probability of all the states in the time window,
 
\begin_inset Formula $x_{0:k}$
\end_inset

, conditioned on the measurements 
\begin_inset Formula $y_{0:k}$
\end_inset

 by maximizing the posterior probability.
 The posterior probability is 
\begin_inset Formula 
\[
p\left(x_{0:k}\mid y_{0:k}\right).
\]

\end_inset

Using Bayes rule we get
\begin_inset Formula 
\begin{align*}
p\left(x_{0:k}\mid y_{0:k}\right) & =\frac{p\left(y_{k}\mid x_{0:k},y_{0:k^{-}}\right)p\left(x_{0:k}\mid y_{0:k^{-}}\right)}{p\left(y_{k}\mid y_{0:k^{-}}\right)}.
\end{align*}

\end_inset

Since 
\begin_inset Formula $p\left(y_{k}\mid y_{0:k^{-}}\right)$
\end_inset

 does not depend on the parameters we are trying to estimate, we can replace
 it with a constant 
\begin_inset Formula $\frac{1}{\eta}$
\end_inset

 so that the posterior becomes
\begin_inset Formula 
\[
p\left(x_{0:k}\mid y_{0:k}\right)=\eta p\left(y_{k}\mid x_{0:k},y_{0:k^{-}}\right)p\left(x_{0:k}\mid y_{0:k^{-}}\right).
\]

\end_inset

Under the assumption that the system is a first order Markov process, we
 can simplify the posterior to
\begin_inset Formula 
\[
p\left(x_{0:k}\mid y_{0:k^{-}}\right)=\eta p\left(y_{k}\mid x_{k}\right)p\left(x_{k}\mid x_{k^{-}}\right)p\left(x_{0:k^{-}}\mid y_{0:k^{-}}\right).
\]

\end_inset

Repeating the process recursively, we get 
\begin_inset Formula 
\begin{multline*}
p\left(x_{0:k}\mid y_{0:k}\right)=\\
\eta p\left(x_{0}\right)\prod_{m=1}^{k}\left[p\left(x_{m}\mid x_{m^{-}}\right)\right]\prod_{m=0}^{k}\prod_{j=1}^{\ell\left(m\right)}\left[p\left(y_{m}^{j}\mid x_{m}\right)\right],
\end{multline*}

\end_inset

where 
\begin_inset Formula $\ell\left(m\right)$
\end_inset

 is the number of measurements in 
\begin_inset Formula $y_{0:k}$
\end_inset

 that were received at time 
\begin_inset Formula $m$
\end_inset

.
\end_layout

\begin_layout Standard
Maximizing the posterior is equivalent to minimizing the negative log posterior.
 The negative log posterior is 
\begin_inset Formula 
\begin{multline*}
\log\left(-p\left(x_{0:k}\mid y_{1:k}\right)\right)=\log\left(-\eta\right)+\log\left(-p\left(x_{0}\right)\right)\\
+\sum_{m=1}^{k}\log\left(-p\left(x_{m}\mid x_{m^{-}}\right)\right)+\sum_{m=0}^{k}\sum_{j=1}^{\ell\left(m\right)}\log\left(-p\left(y_{m}^{j}\mid x_{m}\right)\right).
\end{multline*}

\end_inset

We can drop the term 
\begin_inset Formula $\log\left(-\eta\right)$
\end_inset

 since it will have no impact on the optimization problem.
 The term 
\begin_inset Formula $\log\left(-p\left(x_{0}\right)\right)$
\end_inset

 is negligible compared to the rest of the optimization problem since its
 covariance is big indicating that we do not know the initial state 
\begin_inset Formula $x_{0}$
\end_inset

.
 We thus simplify the negative log posterior to 
\begin_inset Formula 
\[
\sum_{m=1}^{k}\log\left(-p\left(x_{m}\mid x_{m^{-}}\right)\right)+\sum_{m=0}^{k}\sum_{j=1}^{\ell\left(m\right)}\log\left(-p\left(y_{m}^{j}\mid x_{m}\right)\right).
\]

\end_inset


\end_layout

\begin_layout Standard
Since we are only interested in estimating the current state 
\begin_inset Formula $x_{k}$
\end_inset

 and because there is no input to the system, we simplify the negative log
 posterior to
\begin_inset Formula 
\[
\sum_{m=0}^{k}\sum_{j=1}^{\ell\left(m\right)}\log\left(-p\left(y_{m}^{j}\mid x_{k}\right)\right).
\]

\end_inset


\end_layout

\begin_layout Standard
Using these simplifications, the minimization problem is defined as 
\begin_inset Formula 
\[
\arg\min_{x_{k}}\left(\sum_{m=0}^{k}\sum_{j=1}^{\ell\left(m\right)}\log\left(-p\left(y_{m}^{j}\mid x_{k}\right)\right)\right).
\]

\end_inset

This requires constructing a map from the current state 
\begin_inset Formula $x_{k}$
\end_inset

 to a previous state 
\begin_inset Formula $x_{m}$
\end_inset

 which is done by inverting the model.
\end_layout

\begin_layout Subsection
Model Inversion
\begin_inset CommandInset label
LatexCommand label
name "sub:Model-Inversion"

\end_inset


\end_layout

\begin_layout Standard
Given the current state 
\begin_inset Formula $x_{k}$
\end_inset

 we are interested in calculating the state and output at time 
\begin_inset Formula $m<n$
\end_inset

.
 We can easily invert the system model defined in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:system-model"

\end_inset

.
 Ignoring the noise terms, we can propagate the pose of the system 
\begin_inset Formula $g_{m}$
\end_inset

 to 
\begin_inset Formula $g_{k}$
\end_inset

 by 
\begin_inset Formula 
\[
g_{k}=g_{m}\exp\left(\delta_{m:k}u\right).
\]

\end_inset

Solving for 
\begin_inset Formula $g_{m}$
\end_inset

 yields 
\begin_inset Formula 
\begin{align*}
g_{m} & =\exp^{-1}\left(\delta_{m:k}u\right)g_{k}\\
 & =\exp\left(-\delta_{m:k}u\right)g_{k}\\
 & =\exp\left(\delta_{k:m}u\right)g_{k}.
\end{align*}

\end_inset

Thus, the inverse of the system model 
\begin_inset Formula $f^{-1}\left(x_{k},w_{k},\delta_{k:m}\right)$
\end_inset

 is defined as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sub:model_inverse"

\end_inset

 
\begin_inset Formula 
\begin{align}
g_{m} & =g_{k}\oplus\left(\delta_{k:m}u_{k}+\delta_{k:m}w_{k}^{g}+\frac{\delta_{k:m}^{2}}{2}w_{k}^{u}\right)\\
u_{m} & =u_{k}+\delta_{k:m}w_{k}^{u}.
\end{align}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset

 and the output at time 
\begin_inset Formula $m$
\end_inset

 is 
\begin_inset Formula 
\[
y_{m}=h\left(f^{-1},v_{m}\right),
\]

\end_inset

where 
\begin_inset Formula 
\[
f^{-1}=f^{-1}\left(x_{k},w_{k},\delta_{k:m}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
We are interested in the linearized likelihood 
\begin_inset Formula $p\left(y_{m}^{j}\mid x_{k}\right)$
\end_inset

.
 Since the likelihood is conditioned on the state, the state is not a random
 variable.
 This simplifies the Taylor series of 
\begin_inset Formula 
\[
y_{m}^{j}\ominus h\left(f^{-1}\left(x_{k},w_{k},\delta_{k:m}\right),v_{m}\right),
\]

\end_inset

which is 
\begin_inset Formula 
\[
y_{m}^{j}\ominus h\left(f^{-1},\hat{v}_{m}\right)+G_{k:m}^{j}w_{k}+Vv_{m},
\]

\end_inset

where 
\begin_inset Formula 
\begin{align*}
G_{k:m}^{j} & =\left.\frac{\partial y_{m}\ominus h\left(f^{-1},v_{m}\right)}{\partial w_{k}}\right|_{x_{k},\hat{w}_{k},\hat{v}_{m}}=\\
 & =\left.J_{r}^{-1}\left(\hat{e}_{k:m}\right)\mathbf{Ad}_{y_{m}^{j-1}}\frac{\partial h\left(f^{-1},v_{m}\right)}{\partial w_{k}}\right|_{x_{k},\hat{w}_{k},\hat{v}_{m}},
\end{align*}

\end_inset

and 
\begin_inset Formula 
\[
\hat{e}_{k:m}^{j}=y_{m}^{j}\ominus h\left(f^{-1}\left(x_{k},\hat{w}_{k},\delta_{k:m}\right),\hat{v}_{m}\right)
\]

\end_inset

which is the expected value of 
\begin_inset Formula $p\left(y_{m}^{j}\mid x_{k}\right)$
\end_inset

.
 The covariance of 
\begin_inset Formula $p\left(y_{m}^{j}\mid x_{k}\right)$
\end_inset

 is 
\begin_inset Formula 
\begin{equation}
R_{k:m}^{j}=G_{k:m}^{j}Q\left(G_{k:m}^{j}\right)^{\top}+V_{m}RV_{m}^{\top};\label{eq:meas_cov_time}
\end{equation}

\end_inset

therefore, the linearized probability of 
\begin_inset Formula $p\left(y_{m}\mid x_{k}\right)$
\end_inset

 is 
\begin_inset Formula 
\begin{equation}
\eta\exp\left(-\frac{1}{2}\left(\hat{e}_{k:m}^{j}\right)^{\top}\left(R_{k:m}^{j}\right)^{-1}\hat{e}_{k:m}^{j}\right).\label{eq:likelihood_inverse}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Using the linearized probability, we can write the minimization problem
 as 
\begin_inset Formula 
\begin{equation}
\arg\min_{x_{k}}\left(\sum_{m=0}^{k}\sum_{j=1}^{\ell\left(m\right)}\left(\hat{e}_{k:m}^{j}\right)^{\top}\left(R_{k:m}^{j}\right)^{-1}\hat{e}_{k:m}^{j}\right).\label{eq:MLE_inverse}
\end{equation}

\end_inset

There are many methods that can be used to solve the optimization problem.
 If the system is linear, the optimization problem reduces to the one described
 in 
\begin_inset CommandInset citation
LatexCommand cite
key "Niedfeldt2014a"

\end_inset

.
 If the system is non-linear, the optimization problem can be solved using
 the Gauss-newton method or some other optimization method.
 Depending on the method used, you may need compute the derivative of 
\begin_inset Formula $y_{m}^{j}\ominus h\left(f^{-1}\left(x_{k},w_{k},\delta_{k:m}\right),v_{m}\right)$
\end_inset

 with respect to the state.
 We denote this derivative as 
\begin_inset Formula $H_{k:m}$
\end_inset

 which is defined as 
\begin_inset Formula 
\begin{align*}
H_{k:m} & =\left.\frac{\partial y_{m}\ominus h\left(f^{-1},v_{m}\right)}{\partial x_{k}}\right|_{\hat{x}_{k},\hat{w}_{k},\hat{v}_{m}}\\
 & =\left.J_{r}^{-1}\left(\hat{e}_{k:m}\right)\mathbf{Ad}_{y_{m}^{-1}}\frac{\partial h\left(f^{-1},v_{m}\right)}{\partial x_{k}}\right|_{\hat{x}_{k},\hat{w}_{k},\hat{v}_{m}}.
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
If the optimization is non-linear, a scheme to seed the optimization will
 drastically help.
 In the examples that we will present later, we will show same possible
 seeding methods.
 
\end_layout

\begin_layout Standard
Some of these calculations can be very costly.
 It may be worth increasing computation at a cost of quality by letting
 
\begin_inset Formula $R_{k:m}=R$
\end_inset

.
\end_layout

\begin_layout Section
Validation Region
\begin_inset CommandInset label
LatexCommand label
name "sec:Validation-Region"

\end_inset


\end_layout

\begin_layout Standard
When new measurements are received, they are tested to see if they are inside
 a model's validation region.
 The validation region is a volume around an estimated state used for data
 association.
 Measurements that fall within the validation region are associated to the
 model and are used to update the model.
 We will use the validation region described in 
\begin_inset CommandInset citation
LatexCommand cite
key "Bar-Shalom2011"

\end_inset

.
 We assume that the probability of the 
\begin_inset Formula $j^{th}$
\end_inset

 measurement of dimension 
\begin_inset Formula $n$
\end_inset

 conditioned on the previous state, 
\begin_inset Formula $p\left(y_{k}^{j}\mid x_{k^{-}}\right)$
\end_inset

, is Normally distributed with mean 
\begin_inset Formula $\hat{y}_{k}=h\left(f\left(\hat{x}_{k^{-}},\delta_{k}\right)\right)$
\end_inset

 and covariance 
\begin_inset Formula $S$
\end_inset

 where 
\begin_inset Formula $S$
\end_inset

 is the innovation covariance described in equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Kalman_update"

\end_inset

.
 Let 
\begin_inset Formula $z_{k}^{j}$
\end_inset

 be the random variable defined as 
\begin_inset Formula 
\[
z_{k}^{j}=S^{-\frac{1}{2}}y_{k}^{j}\ominus\hat{y}_{k},
\]

\end_inset

then 
\begin_inset Formula $z_{k}^{j}$
\end_inset

 is a standard multivariate Gaussian distribution.
 For clarity, we will drop the subscripts and superscripts.
 Let 
\begin_inset Formula $d_{v}:N\times N\to\mathbb{R}$
\end_inset

 be the metric defined as 
\begin_inset Formula 
\begin{align*}
d_{v}\left(y,\hat{y}\right) & =z^{\top}z\\
 & =\left(y\ominus\hat{y}\right)^{\top}S^{-1}\left(y\ominus\hat{y}\right).
\end{align*}

\end_inset

Note that the metric 
\begin_inset Formula $d_{v}$
\end_inset

 is simply the sum of the square of 
\begin_inset Formula $n$
\end_inset

 Gaussian distributions.
 Thus, the values of the metric 
\begin_inset Formula $d_{v}$
\end_inset

 form a chi-square distribution with probability density function (PDF)
\begin_inset Formula 
\[
p\left(d\left(y,\hat{y}\right)\right)=\frac{d\left(y,\hat{y}\right)^{n/2-1}\exp^{-n/2}}{2^{n/2}\Gamma\left(n/2\right)},
\]

\end_inset

where 
\begin_inset Formula $\Gamma\left(n/2\right)$
\end_inset

 is the gamma function.
\end_layout

\begin_layout Standard
The validation region is defined as 
\begin_inset Formula 
\[
\nu\left(\hat{y},\gamma\right)=\left\{ y\in N\,:\,d\left(y,\hat{y}\right)\leq\gamma\right\} ,
\]

\end_inset

where parameter 
\begin_inset Formula $\gamma$
\end_inset

 is called the gate threshold.
 The gate probability 
\begin_inset Formula $P_{G}$
\end_inset

 is the probability that a measurement produced by a target is within the
 validation region.
 This probability is defined as 
\begin_inset Formula $p\left(d\left(y,\hat{y}\right)\leq\gamma\right)$
\end_inset

, thus 
\begin_inset Formula $P_{G}$
\end_inset

 is the value of the cumulative distribution function (CDF) of the chi-square
 distribution with parameter 
\begin_inset Formula $\gamma$
\end_inset

.
 New measurements that fall within the validation region of a model are
 used to update the corresponding model using centralized measurement fusion
 described in section 
\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Centralized-Measurement-Fusion"

\end_inset

.
\end_layout

\begin_layout Standard
Some data association techniques require knowing the volume of the validation
 region 
\begin_inset Formula $V_{vol}$
\end_inset

.
 The volume is defined as 
\begin_inset Formula 
\begin{equation}
V_{vol}=c_{n}\gamma^{n/2}\left|S\right|^{1/2},\label{eq:volume_validation_region}
\end{equation}

\end_inset

where 
\begin_inset Formula $c_{n}$
\end_inset

 is the volume of the unit hypersphere of dimension 
\begin_inset Formula $n$
\end_inset

 (dimension of the measurement space) calculated as 
\begin_inset Formula 
\[
c_{n}=\frac{\pi^{n/2}}{\Gamma\left(n/2+1\right)}.
\]

\end_inset


\end_layout

\begin_layout Section
Centralized Measurement Fusion 
\begin_inset CommandInset label
LatexCommand label
name "sec:Centralized-Measurement-Fusion"

\end_inset


\end_layout

\begin_layout Standard
Validated measurements, or measurements associated to a model, can come
 from multiple different measurement sources at different times.
 In order to update the state estimate, we use the centralized measurement
 fusion method, as discussed in 
\begin_inset CommandInset citation
LatexCommand cite
key "Bar-Shalom1988"

\end_inset

 and 
\begin_inset CommandInset citation
LatexCommand cite
key "Millard2017"

\end_inset

, which assumes that measurements are statistically independent.
 We briefly review this method here only to adapt it to the Lie group setting.
 Let 
\begin_inset Formula $N_{s}$
\end_inset

 denote the number of measurement sources, 
\begin_inset Formula $\theta_{m}^{i}=\left\{ y_{m}^{1},y_{m}^{2},\cdots,y_{m}^{n}\right\} $
\end_inset

 denote the set of measurements associated with the model that were received
 at time 
\begin_inset Formula $m$
\end_inset

 from the 
\begin_inset Formula $i^{th}$
\end_inset

 measurement source, 
\begin_inset Formula $\beta_{m}^{j}$
\end_inset

 be the weight associated with measurement 
\begin_inset Formula $y_{m}^{j}\in\theta_{m}^{i}$
\end_inset

, 
\begin_inset Formula $Z^{i}$
\end_inset

 be defined as 
\begin_inset Formula 
\[
Z^{i}=\begin{cases}
\sum_{j=1}^{n}\beta^{j}H_{m}^{\top}\left(R^{i}\right)^{-1}y_{m}^{j}\ominus h\left(x_{m}\right) & \text{if }\left|\theta_{m}^{i}\right|>0\\
0 & \text{else}
\end{cases},
\]

\end_inset

and 
\begin_inset Formula $P_{m}^{i}$
\end_inset

 be the updated measurement covariance after incorporating only the measurements
 from the 
\begin_inset Formula $i^{th}$
\end_inset

 source, then the covariance update is 
\begin_inset Formula 
\[
P_{m}^{-1}=\bar{P}_{m}^{-1}+\sum_{i=1}^{N_{s}}\left(\left(P_{m}^{i}\right)^{-1}-\bar{P}_{m}^{-1}\right),
\]

\end_inset

and the state update is 
\begin_inset Formula 
\[
\hat{x}_{m}=\hat{\bar{x}}_{m}\oplus\left(P_{m}\sum_{i=1}^{N_{s}}Z^{i}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
Recall that 
\begin_inset Formula $H_{m}$
\end_inset

 is the Jacobian of the measurement mode, 
\begin_inset Formula $R^{i}$
\end_inset

 the measurement covariance of the 
\begin_inset Formula $i^{th}$
\end_inset

 measurement source, and 
\begin_inset Formula $\bar{P}_{m}$
\end_inset

 the error covariance after propagation but before any measurement updates.
 The weights 
\begin_inset Formula $\beta_{m}^{j}$
\end_inset

 are calculated from the data association filter used such as a PDAF.
 
\end_layout

\begin_layout Section
Track to Track Fusion
\end_layout

\begin_layout Standard
In the case where R-RANSAC initializes two different tracks and later decides
 that the two tracks represent the same target, the tracks need to be fused
 (merged) together.
 Calculating the cross covariance needed to optimally fuse the two tracks
 can be computationally complex and time expensive, or in our case unknown.
 Fortunately, the covariance intersection (CI) method can be used to fuse
 two tracks together without calculating the cross covariance.
 A good introduction to the CI method is presented in 
\begin_inset CommandInset citation
LatexCommand cite
key "Deng2012"

\end_inset

.
 Bar-Shalom, in 
\begin_inset CommandInset citation
LatexCommand cite
key "Bar-Shalom2011"

\end_inset

, pointed out that the original CI method is so conservative in its estimation
 that it can indicate degradation of the state estimate due to fusion.
 An improved version of the CI method was presented in 
\begin_inset CommandInset citation
LatexCommand cite
key "Tian2010"

\end_inset

 called the sampled covariance intersection (SCI) method.
 This is the method we will follow.
 In order to see if two tracks need to be fused together, we use a track
 association method prescribed in 
\begin_inset CommandInset citation
LatexCommand cite
key "Bar-Shalom2011"

\end_inset

.
 In this section we will briefly present the track association and fusion
 methods adapted for the Lie group setting.
 
\end_layout

\begin_layout Subsection
Track Association
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\hat{x}^{i}$
\end_inset

 denote the state estimate of the 
\begin_inset Formula $i^{th}$
\end_inset

 track and 
\begin_inset Formula $P^{i}$
\end_inset

 be the corresponding error covariance.
 The estimation error between two tracks is denoted 
\begin_inset Formula $\Delta^{ij}$
\end_inset

 and defined as 
\begin_inset Formula 
\[
\Delta^{ij}=\hat{x}^{i}\ominus\hat{x}^{j}.
\]

\end_inset

Assuming that the two tracks are independent, the covariance of the estimation
 error is 
\begin_inset Formula 
\[
T^{ij}=P^{i}+P^{j}.
\]

\end_inset

We next define a metric 
\begin_inset Formula $d_{T}:\left(G\times\mathfrak{g}\right)\times\left(G\times\mathfrak{g}\right)\to\mathbb{R}$
\end_inset

 to be
\begin_inset Formula 
\[
d_{T}\left(\hat{x}^{i},\hat{x}^{j}\right)=\left(\Delta^{ij}\right)^{\top}\left(T^{ij}\right)^{-1}\Delta^{ij}.
\]

\end_inset

If 
\begin_inset Formula $d_{T}\left(\cdot,\cdot\right)<\tau_{S}$
\end_inset

 where 
\begin_inset Formula $\tau_{S}\in\mathbb{R}$
\end_inset

, then the two tracks are deemed to be the same and should be merged.
\end_layout

\begin_layout Subsection
Track Fusion
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\hat{x}^{1},\hat{x}^{2},\cdots,\hat{x}^{n}$
\end_inset

 denote the state estimates of the tracks that need to be fused together
 and 
\begin_inset Formula $P^{i}$
\end_inset

 be their corresponding error covariance.
 The fused estimate in SCI is calculated as if the tracks to be fused are
 independent; therefore,
\begin_inset Formula 
\begin{align*}
P^{-1} & =\sum_{i=1}^{n}\left(P^{i}\right)^{-1}\\
\hat{x}_{SCI} & =P\left(\sum_{i=1}^{n}\left(P^{i}\right)^{-1}\hat{x}^{i}\right).
\end{align*}

\end_inset

The error covariance 
\begin_inset Formula $P^{-1}$
\end_inset

 is overly optimistic, so we must adjust the size as follows:
\end_layout

\begin_layout Itemize
Generate 
\begin_inset Formula $N$
\end_inset

 (about 100 for a good distribution) random samples 
\begin_inset Formula $x^{j}$
\end_inset

, 
\begin_inset Formula $j=1,2,\ldots,N$
\end_inset

 from 
\begin_inset Formula $x\sim\mathcal{N}\left(0,P\right)$
\end_inset


\end_layout

\begin_layout Itemize
Find
\begin_inset Formula 
\[
r_{\text{max}}=\max_{j=1,\ldots,N}\frac{\left(x^{j}\right)^{\top}P^{-1}x^{j}}{\underset{j=1,\ldots,N}{\max}\left\{ \left(x^{j}\right)^{\top}P^{-1}x^{j}\right\} }
\]

\end_inset

and
\begin_inset Formula 
\[
r_{\text{min}}=\min_{j=1,\ldots,N}\frac{\left(x^{j}\right)^{\top}P^{-1}x^{j}}{\underset{j=1,\ldots,N}{\max}\left\{ \left(x^{j}\right)^{\top}P^{-1}x^{j}\right\} }
\]

\end_inset


\end_layout

\begin_layout Itemize
Then set
\begin_inset Formula 
\[
P_{SCI}=\frac{P}{ur_{\text{min}}+\left(1-u\right)r_{\text{max}}}
\]

\end_inset

where 
\begin_inset Formula $u\in\left[0,1\right]$
\end_inset

 is used to adjust the performance of the SCI algorithm.
 When 
\begin_inset Formula $u=1$
\end_inset

, the fused covariance is conservative and when 
\begin_inset Formula $u=0$
\end_inset

, the fused covariance is optimistic.
 The authors of 
\begin_inset CommandInset citation
LatexCommand cite
key "Tian2010"

\end_inset

 received good results by setting 
\begin_inset Formula $u=0.5$
\end_inset

.
\end_layout

\begin_layout Standard
The fused track will have the state estimate 
\begin_inset Formula $\hat{x}_{SCI}$
\end_inset

 with error covariance 
\begin_inset Formula $P_{SCI}$
\end_inset

.
\end_layout

\begin_layout Section
Model Likelihood
\end_layout

\begin_layout Standard
R-RANSAC stores up to 
\begin_inset Formula $\mathcal{M}$
\end_inset

 models.
 Some of the models might not represent actual targets and could have been
 initialized from clustered false measurements.
 To account for this, we need a way to measure how likely a model represents
 an actual target.
 We will refer to this measure or probability as the model's likelihood.
 In the previous versions of R-RANSAC, the inlier ratio and the model's
 lifetime were used to indicate the model's likelihood.
 In this section, we present a different approach using a binary Bayes filter
 with static states.
 
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $P_{D}^{i}$
\end_inset

 denote the probability that the 
\begin_inset Formula $i^{th}$
\end_inset

 measurement source produced a true measurement of the target during the
 sensor scan, let 
\begin_inset Formula $P_{G}^{i}$
\end_inset

 denote the probability that the true measurement was validated, i.e.
 associated with the target during the data association process, then the
 probability that a true measurement was received and validated is 
\begin_inset Formula $P_{D}^{i}P_{G}^{i}$
\end_inset

.
 Let 
\begin_inset Formula $\lambda^{i}$
\end_inset

 denote the spatial density of the expected number of false measurements
 from the 
\begin_inset Formula $i^{th}$
\end_inset

 measurement source during a sensor scan.
 For example, let 
\begin_inset Formula $V_{s}^{i}$
\end_inset

 denote the volume of a surveillance region and 
\begin_inset Formula $\Lambda^{i}$
\end_inset

 denote the expected number of false measurements per sensor scan from the
 
\begin_inset Formula $i^{th}$
\end_inset

 measurement source, then 
\begin_inset Formula $\lambda^{i}=\frac{\Lambda^{i}}{V_{s}^{i}}$
\end_inset

.
 The expected number of false measurements within a validation region is
 
\begin_inset Formula $\lambda^{i}V_{vol}$
\end_inset

 where 
\begin_inset Formula $V_{vol}$
\end_inset

 is the volume of the validation region defined in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:volume_validation_region"

\end_inset

 and is depending on the measurement source and state estimate.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\theta_{m}^{i}$
\end_inset

 denote the number of validated measurements from the 
\begin_inset Formula $i^{th}$
\end_inset

 measurement source at time 
\begin_inset Formula $m$
\end_inset

, 
\begin_inset Formula $\theta_{m:k}^{i}$
\end_inset

 denote the number of validated measurements from the 
\begin_inset Formula $i^{th}$
\end_inset

 measurement source from time 
\begin_inset Formula $m$
\end_inset

 to time 
\begin_inset Formula $k$
\end_inset

 where 
\begin_inset Formula $m<k$
\end_inset

, and 
\begin_inset Formula $\theta_{m:k}$
\end_inset

 the number of all validated measurements from all the measurement sources
 from time 
\begin_inset Formula $m$
\end_inset

 to time 
\begin_inset Formula $k$
\end_inset

.
 Let 
\begin_inset Formula $z$
\end_inset

 be a Bernoulli random variable with 
\begin_inset Formula $z=1$
\end_inset

 meaning that the model represents an actual target and 
\begin_inset Formula $z=0$
\end_inset

 meaning that the model doesn't represent a target.
 For notation purposes, we will denote 
\begin_inset Formula $p\left(z=1\right)$
\end_inset

 as 
\begin_inset Formula $p\left(z\right)$
\end_inset

 and 
\begin_inset Formula $p\left(z=0\right)$
\end_inset

 as 
\begin_inset Formula $p\left(\neg z\right)$
\end_inset

.
 
\end_layout

\begin_layout Standard
We are interested in calculating the probability that the model represents
 an actual target conditioned on the validated measurements.
 We denote this probability as 
\begin_inset Formula $p\left(z\mid\theta_{m:k}\right)$
\end_inset

.
 Using Bayes rule we get 
\begin_inset Formula 
\begin{align*}
p\left(z\mid\theta_{m:k}\right) & =\frac{p\left(\theta_{k}\mid z,\theta_{m:k^{-}}\right)p\left(z\mid\theta_{m:k^{-}}\right)}{p\left(\theta_{k}\mid\theta_{m:k^{-}}\right)}\\
 & =\frac{p\left(\theta_{k}\mid z\right)p\left(z\mid\theta_{m:k^{-}}\right)}{p\left(\theta_{k}\mid\theta_{m:k^{-}}\right)}.
\end{align*}

\end_inset

The probability 
\begin_inset Formula $p\left(\theta_{k}\mid\theta_{m:k^{-}}\right)$
\end_inset

 can be difficult to calculate; however, we can work around needing to know
 this probability by using a log odds ratio.
 For this method, we need 
\begin_inset Formula $p\left(\neg z\mid\theta_{m:k}\right)$
\end_inset

 which is 
\begin_inset Formula 
\[
p\left(\neg z\mid\theta_{m:k}\right)=\frac{p\left(\theta_{k}\mid\neg z\right)p\left(\neg z\mid\theta_{m:k^{-}}\right)}{p\left(\theta_{k}\mid\theta_{m:k^{-}}\right)}.
\]

\end_inset

Taking the log (base 10) ratio of the probabilities 
\begin_inset Formula $p\left(z\mid\theta_{m:k}\right)$
\end_inset

 and 
\begin_inset Formula $p\left(\neg z\mid\theta_{m:k}\right)$
\end_inset

, we get 
\begin_inset Formula 
\begin{align*}
\log\left(\frac{p\left(z\mid\theta_{m:k}\right)}{p\left(\neg z\mid\theta_{m:k}\right)}\right) & =\log\left(\frac{p\left(\theta_{k}\mid z\right)p\left(z\mid\theta_{m:k^{-}}\right)}{p\left(\theta_{k}\mid\neg z\right)p\left(\neg z\mid\theta_{m:k^{-}}\right)}\right)\\
 & =\log\left(\frac{p\left(\theta_{k}\mid z\right)}{p\left(\theta_{k}\mid\neg z\right)}\right)+\sum_{n=m}^{k^{-}}\log\left(\frac{p\left(\theta_{n}\mid z\right)}{p\left(\theta_{n}\mid\neg z\right)}\right).
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Whenever new validated measurements are received, we calculate the term
 
\begin_inset Formula 
\[
l_{k}=\log\left(\frac{p\left(\theta_{k}\mid z\right)}{p\left(\theta_{k}\mid\neg z\right)}\right)
\]

\end_inset

and add it to the previous log odds ratio 
\begin_inset Formula 
\begin{align*}
l_{k^{-}=} & \log\left(\frac{p\left(z\mid\theta_{m:k^{-}}\right)}{p\left(\neg z\mid\theta_{m:k^{-}}\right)}\right)\\
 & =\sum_{n=m}^{k^{-}}\log\left(\frac{p\left(\theta_{n}\mid z\right)}{p\left(\theta_{n}\mid\neg z\right)}\right).
\end{align*}

\end_inset

The term 
\begin_inset Formula $l_{k}$
\end_inset

 can be written as
\begin_inset Formula 
\[
\log\left(\frac{p\left(\theta_{k}\mid z\right)}{p\left(\theta_{k}\mid\neg z\right)}\right)=\sum_{i\in1}^{s}\log\left(\frac{p\left(\theta_{k}^{i}\mid z\right)}{p\left(\theta_{k}^{i}\mid\neg z\right)}\right),
\]

\end_inset

where 
\begin_inset Formula $s$
\end_inset

 is the number of measurement sources.
 Thus we are left with calculating 
\begin_inset Formula $p\left(\theta_{k}^{i}\mid z\right)$
\end_inset

 and 
\begin_inset Formula $p\left(\theta_{k}^{i}\mid\neg z\right)$
\end_inset

 for each measurement source.
 We assume that a measurement source can only produce at most one true measureme
nt during a sensor scan.
 Therefore, we have the two possibilities for 
\begin_inset Formula $p\left(\theta_{k}^{i}\mid z\right)$
\end_inset

, that all 
\begin_inset Formula $\theta_{k}^{i}$
\end_inset

 measurements are false or all but one are false.
 Thus 
\begin_inset Formula 
\begin{multline*}
p\left(\theta_{k}^{i}\mid z\right)=P_{G}^{i}P_{D}^{i}\exp\left(\lambda^{i}V_{vol}\right)\frac{\left(\lambda^{i}V_{vol}\right)^{\theta_{k}^{i}-1}}{\left(\theta_{k}^{i}-1\right)!}\\
+\left(1-P_{G}^{i}P_{D}^{i}\right)\exp\left(\lambda^{i}V_{vol}\right)\frac{\left(\lambda^{i}V_{vol}\right)^{\theta_{k}^{i}}}{\left(\theta_{k}^{i}\right)!}.
\end{multline*}

\end_inset

There is only one possibility for 
\begin_inset Formula $p\left(\theta_{k}^{i}\mid\neg z\right)$
\end_inset

, that is the probability of all of the measurements being false 
\begin_inset Formula 
\[
p\left(\theta_{k}^{i}\mid\neg z\right)=\exp\left(\lambda^{i}V_{vol}\right)\frac{\left(\lambda^{i}V_{vol}\right)^{\theta_{k}^{i}}}{\left(\theta_{k}^{i}\right)!}.
\]

\end_inset

Taking the ratio of the two, we get 
\begin_inset Formula 
\[
\frac{p\left(\theta_{k}^{i}\mid z\right)}{p\left(\theta_{k}^{i}\mid\neg z\right)}=1+P_{G}^{i}P_{D}^{i}\left(\frac{\theta_{k}^{i}}{\lambda^{i}V_{vol}}-1\right).
\]

\end_inset


\end_layout

\begin_layout Standard
The model likelihood, 
\begin_inset Formula $p\left(z\mid\theta_{m:k}\right)$
\end_inset

, can be recovered from the log odds ratio by 
\begin_inset Formula 
\[
p\left(z\mid\theta_{m:k}\right)=1-\frac{1}{1+10^{l_{k}}}.
\]

\end_inset


\end_layout

\begin_layout Standard
Note that if a model is outside the surveillance region of the measurement
 source, then 
\begin_inset Formula $P_{D}$
\end_inset

 should be zero and 
\begin_inset Formula $p\left(z\mid\theta_{m:k}\right)$
\end_inset

 will not be affected since there won't be any measurements and the update
 to the log odds ratio is 
\begin_inset Formula $0$
\end_inset

.
 In the case that the target leaves the global surveillance region, we need
 a way to kill the model in order to make room for other models to be initialize
d.
 Thus, we assume that a model that has not received a measurement within
 
\begin_inset Formula $\tau_{\alpha}$
\end_inset

 seconds is no longer the the GSR and will be removed.
 A model is considered a good model if the 
\begin_inset Formula $p\left(z\mid\theta_{m:k}\right)>\tau_{\rho}$
\end_inset

; otherwise, it is considered a poor model.
 The parameters 
\begin_inset Formula $\lambda^{i}$
\end_inset

 and 
\begin_inset Formula $P_{D}^{i}$
\end_inset

 can be easily estimated and 
\begin_inset Formula $P_{G}^{i}$
\end_inset

 is defined by the user.
\end_layout

\begin_layout Section
LMLE Simplification 
\begin_inset CommandInset label
LatexCommand label
name "sec:LMLE-Simplification"

\end_inset


\end_layout

\begin_layout Standard
Recall that the purpose of the LMLE is to generate a current state estimate
 
\begin_inset Formula $x_{k}$
\end_inset

 of a model hypothesis.
 Using state estimates we build the consensus set which is later used to
 refine the estimate using a filtering technique.
 So the estimate of LMLE doesn't have to be super refined, and we can simplify
 the optimization process in different ways.
 
\end_layout

\begin_layout Standard
Let's assume that the pose of the system is measurable.
 In other words, your observation model 
\begin_inset Formula $h_{k}$
\end_inset

 is defined as 
\begin_inset Formula 
\[
h_{k}\left(x_{k},v_{k}\right)=g_{k}\exp\left(v_{k}\right),
\]

\end_inset

thus
\begin_inset Formula 
\[
y_{k}=g_{k}\exp\left(v_{k}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
When generating a model hypothesis, we always use a measurement from the
 current time.
 This allows us to use a measurement from the current time as our estimated
 pose 
\begin_inset Formula $g_{k}$
\end_inset

.
 All that remains is estimating the velocity term 
\begin_inset Formula $u_{k}$
\end_inset

 using one other measurement 
\begin_inset Formula $y_{m}$
\end_inset

.
 Under the assumption that 
\begin_inset Formula $g_{k}$
\end_inset

 is the true current state, the measurement 
\begin_inset Formula $y_{m}$
\end_inset

 is 
\begin_inset Formula 
\[
y_{m}=g_{k}\exp\left(\delta_{k:m}u_{k}+\delta_{k:m}w_{k}^{g}+\frac{\delta_{k:m}^{2}}{2}w_{k}^{u}\right)\exp\left(v_{m}\right),
\]

\end_inset

which can be approximated as 
\begin_inset Formula 
\[
y_{m}\approx g_{k}\exp\left(\delta_{k:m}u_{k}+\delta_{k:m}w_{k}^{g}+\frac{\delta_{k:m}^{2}}{2}w_{k}^{u}+v_{m}\right)
\]

\end_inset

By calculating the error between the measurement and the current state we
 get 
\begin_inset Formula 
\begin{align*}
y_{m}\ominus g_{k} & =\log\left(g_{k}^{-1}y_{m}\right)\\
e_{k:m} & \approx\delta_{k:m}u_{k}+\delta_{k:m}w_{k}^{g}+\frac{\delta_{k:m}^{2}}{2}w_{k}^{u}+v_{m}.
\end{align*}

\end_inset

The expected value of 
\begin_inset Formula $e_{k:m}$
\end_inset

 is 
\begin_inset Formula 
\[
\text{E}\left[e_{k:m}\right]=\delta_{k:m}u_{k},
\]

\end_inset

and the covariance is 
\begin_inset Formula 
\begin{align*}
\text{cov}\left[e_{k:m}\right] & \approx\delta_{k:m}^{2}Q^{g}+\frac{\delta_{k:m}^{2}}{2}Q^{u}+R\\
 & =R_{k:m}
\end{align*}

\end_inset

where 
\begin_inset Formula 
\[
Q=\begin{bmatrix}Q^{g} & 0\\
0 & Q^{u}
\end{bmatrix}.
\]

\end_inset

We can simply estimate 
\begin_inset Formula $u_{k}$
\end_inset

 by letting 
\begin_inset Formula $u_{k}=e_{k:m}/\delta_{k:m}$
\end_inset

.
 We can improve the estimate using multiple measurements.
 Let 
\begin_inset Formula $\Lambda$
\end_inset

 be and index such that 
\begin_inset Formula $\cup_{m\in\Lambda}\left\{ y_{m}\right\} $
\end_inset

 is the set of measurements we will use to estimate 
\begin_inset Formula $u_{k}$
\end_inset

 and the subscript denotes the time the measurement was taken, then 
\begin_inset Formula 
\[
u_{k}=\left(\sum_{j\in\Lambda}\delta_{k:j}R_{k:j}^{-1}\right)^{-1}\left(\sum_{j\in\Lambda}R_{k:j}^{-1}e_{k:j}\right).
\]

\end_inset

We can simplify the estimation further by letting 
\begin_inset Formula 
\[
u_{k}=\frac{1}{\left|\Lambda\right|}\sum_{j\in\Lambda}e_{k:j}.
\]

\end_inset


\end_layout

\begin_layout Standard
Another possible simplification for any approach is by setting 
\begin_inset Formula $R_{k:m}^{i}$
\end_inset

,defined in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:meas_cov_time"

\end_inset

, to identity element to get the simplified optimization problem
\begin_inset Formula 
\[
\arg\min_{x_{k}}\left(\sum_{m=0}^{k}\sum_{j=1}^{\ell\left(m\right)}\left(\hat{e}_{k:m}^{j}\right)^{\top}\hat{e}_{k:m}^{j}\right).
\]

\end_inset

 We propose this simplification because computing the covariance 
\begin_inset Formula $R_{k:m}^{j}$
\end_inset

 can be CPU costly when it has to be done thousands of times whenever RANSAC
 is performed.
 
\end_layout

\begin_layout Standard
If you want the estimation to be as accurate as possible using the original
 optimization problem to solve the LMLE defined in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:likelihood_inverse"

\end_inset

, we suggest you use the simplified approaches to seed the original optimization
 problem, unless the system is linear since the optimization problem is
 already simple.
 
\end_layout

\begin_layout Section
Examples
\end_layout

\begin_layout Standard
In this section we provide three examples of increasing complexity.
 The first example is to show how LG-R-RANSAC applies to Euclidean space
 of 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

 with 
\begin_inset Formula $n\in\mathbb{N}$
\end_inset

.
 The second example applies LG-R-RANSAC to tracking targets on an image
 plane using 
\begin_inset Formula $SE\left(2\right)$
\end_inset

, and the third example applies LG-R-RANSAC to tracking UAVs moving on the
 configuration manifold 
\begin_inset Formula $SE\left(3\right)$
\end_inset

 using radar sensors.
 
\end_layout

\begin_layout Subsection
Euclidean Space 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset


\end_layout

\begin_layout Standard
This is a brief section to show how the Lie group theory applies to Euclidean
 spaces of 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

, where 
\begin_inset Formula $n\in\mathbb{N}$
\end_inset

, equipped with the standard topology and the group operation of addition.
 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

 equipped with addition is an abelian group; thus the adjoint map is the
 identity map.
 Its corresponding Lie algebra is 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

.
 Therefore, the exponential map and its inverse is simply the identity map.
 This implies that the left and right Jacobians of the exponential map is
 also the identity map.
 The box plus/minus and o plus/minus mapping are trivially derived; for
 example
\begin_inset Formula 
\begin{align*}
g\oplus u & =g+u\\
g_{1}\ominus g_{2} & =g_{1}-g_{2}
\end{align*}

\end_inset

where 
\begin_inset Formula $g,g_{1},g_{2}\in G=\mathbb{R}^{2}$
\end_inset

 and 
\begin_inset Formula $u\in\mathfrak{g}=\mathbb{R}^{2}$
\end_inset

.
\end_layout

\begin_layout Standard
We can write the system model as 
\begin_inset Formula 
\begin{align*}
g_{k} & =g_{k^{-}}+\delta_{k}\left(u_{k^{-}}+w_{k}^{g}\right)+\frac{\delta_{k}^{2}}{2}w_{k}^{u}\\
u_{k} & =u_{k^{-}}+\delta_{k}w_{k}^{u}\\
y_{k} & =g_{k}+v_{k},
\end{align*}

\end_inset

We can write this in the familiar matrix notation as 
\begin_inset Formula 
\begin{align*}
x_{k} & =A_{k}x_{k^{-}}+B_{k}w_{k}\\
y_{k} & =Cx_{k}+v_{k}
\end{align*}

\end_inset

where 
\begin_inset Formula $x_{k}=\left[g_{k}^{\top},u_{k}^{\top}\right]^{\top}$
\end_inset

,
\begin_inset Formula 
\begin{align*}
A_{k}=\begin{bmatrix}I_{2\times2} & \delta_{k}I\\
0 & I_{2\times2}
\end{bmatrix}, & \thinspace & B_{k}=\begin{bmatrix}\delta_{k}I & \frac{\delta_{k}^{2}}{2}I\\
0 & \delta_{k}I
\end{bmatrix},
\end{align*}

\end_inset

and 
\begin_inset Formula 
\[
C=\begin{bmatrix}I_{2\times2} & 0_{2\times2}\end{bmatrix}.
\]

\end_inset

In this form, we can easily recognize it as an linear time-invariant system
 with near constant velocity.
\end_layout

\begin_layout Standard
The Jacobians are easily computed and are 
\begin_inset Formula $F_{k}=A_{k}$
\end_inset

, 
\begin_inset Formula $G_{k}=B_{k}$
\end_inset

 , 
\begin_inset Formula $H_{k}=C$
\end_inset

, 
\begin_inset Formula $F_{k:m}=CA_{k:m}$
\end_inset

, and 
\begin_inset Formula $G_{k:m}=CB_{k:m}$
\end_inset

.
 The LMLE simplifies to a least squares problem.
 This type of system used with R-RANSAC is thoroughly discussed in 
\begin_inset CommandInset citation
LatexCommand cite
key "Niedfeldt2014a"

\end_inset

.
\end_layout

\begin_layout Subsection
Constrained Problem for 
\begin_inset Formula $SE\left(2\right)$
\end_inset

: Tracking in the Image Plane 
\begin_inset CommandInset label
LatexCommand label
name "sub:tracking_image_plane"

\end_inset


\end_layout

\begin_layout Standard
Camera's are widely used as a sensor for target tracking.
 A popular application is to mount a camera on a UAV and track a moving
 target in the normalized image plane.
 For this example, we assume that the normalized image plane is the GSR,
 the global frame is coincident with the camera frame, and that measurements
 are point measurements, i.e.
 position only measurements.
 Since the global frame is coincident with the camera frame, a transformation
 must be provided to LG-R-RANSAC to transform all the measurements and models
 to the current global frame.
 We will use the Homography for this transformation.
\end_layout

\begin_layout Standard
The Lie group configuration of a target moving in the normalized image plane
 is 
\begin_inset Formula $SE\left(2\right)$
\end_inset

, see appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:SE2"

\end_inset

 for the system function and important Jacobians.
 Let 
\begin_inset Formula $g_{k}\in SE\left(2\right)$
\end_inset

 and 
\begin_inset Formula $u_{k}\in\mathfrak{se}\left(2\right)$
\end_inset

.
 They can be written as 
\begin_inset Formula 
\begin{align*}
g_{k} & =\begin{bmatrix}R_{k} & t_{k}\\
0_{1\times2} & 1
\end{bmatrix}\\
u_{k} & =\begin{bmatrix}\omega_{k} & \rho_{k}\\
0_{1\times2} & 1
\end{bmatrix},
\end{align*}

\end_inset

where 
\begin_inset Formula $R_{k}\in SO\left(2\right)$
\end_inset

, 
\begin_inset Formula $\omega_{k}\in\mathfrak{se}\left(2\right)$
\end_inset

, and 
\begin_inset Formula $t_{k},\rho_{k}\in\mathbb{R}^{2}$
\end_inset

.
 The observation model is 
\begin_inset Formula 
\begin{align*}
y_{k} & =h\left(x_{k},v_{k}\right)\\
 & =t_{k}+v_{k},
\end{align*}

\end_inset

where 
\begin_inset Formula $y_{k}\in\mathbb{R}^{2}$
\end_inset

.
 The inverse observation model is 
\begin_inset Formula 
\begin{align*}
y_{m} & =h\left(f^{-1}\left(x_{k},\delta_{k:m},w_{k}\right),v_{k}\right)\\
 & =R_{k}V\left(\delta_{k:m}\left(\omega_{k}+w_{k}^{R}\right)+\frac{\delta_{k:m}^{2}w_{k}^{\omega}}{2}\right)\left(\delta_{k:m}\rho_{k}+\delta_{k:m}w_{k}^{\rho}\right)+t_{k}+w_{k}^{t}+v_{m},
\end{align*}

\end_inset

where 
\begin_inset Formula $w_{k}=\left[\left(w_{k}^{t}\right)^{\top},\left(w_{k}^{R}\right)^{\top},\left(w_{k}^{\rho}\right)^{\top},\left(w_{k}^{u}\right)^{\top}\right]^{\top}$
\end_inset

 and 
\begin_inset Formula $V$
\end_inset

 is defined in equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:se2_v"

\end_inset

.
 Based on the observation model, we have three Jacobians to compute: 
\begin_inset Formula $G_{k:m}$
\end_inset

, 
\begin_inset Formula $H_{k:m}$
\end_inset

 and 
\begin_inset Formula $V_{m}$
\end_inset

.
 
\begin_inset Formula 
\begin{align*}
H_{k:m}=\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial x} & =\begin{bmatrix}H_{k:m}^{t} & H_{k:m}^{R} & H_{k:m}^{\rho} & H_{k:m}^{\omega}\end{bmatrix},
\end{align*}

\end_inset

where
\begin_inset Formula 
\begin{align*}
H_{k:m}^{t}=\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial t_{k}} & =I\\
H_{k:m}^{R}=\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial R} & =\delta_{k:m}R_{k}\left[1\right]_{\times}V\left(\delta_{k:m}\omega\right)\rho\\
H_{k:m}^{\rho}=\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial\rho} & =\delta_{k:m}^{2}R_{k}V\left(\delta_{k:m}\omega\right)\\
H_{k:m}^{\omega}=\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial\omega} & =\delta_{k:m}^{2}R_{k}V^{'}\left(\delta_{k:m}\omega\right)\rho
\end{align*}

\end_inset

and 
\begin_inset Formula 
\[
V^{'}\left(\omega\right)=\frac{\cos\left(\theta\right)\theta-\sin\left(\theta\right)}{\theta^{2}}I+\frac{\sin\left(\theta\right)\theta-\left(1-\cos\left(\theta\right)\right)}{\theta^{2}}\left[1\right]_{\times}.
\]

\end_inset

We quickly note that 
\begin_inset Formula 
\[
H_{k}=H_{k:k}=\begin{bmatrix}I & 0_{2\times4}\end{bmatrix}.
\]

\end_inset


\begin_inset Formula 
\[
G_{k:m}=\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial w_{k}}=\begin{bmatrix}G_{k:m}^{t} & G_{k:m}^{R} & G_{k:m}^{\rho} & G_{k:m}^{\omega}\end{bmatrix},
\]

\end_inset

where 
\begin_inset Formula 
\begin{align*}
G_{k:m}^{t} & =\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial w_{k}^{t}}=I\\
G_{k:m}^{R} & =\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial w_{k}^{R}}=\delta_{k:m}^{2}R_{k}V^{'}\left(\delta_{k:m}\omega\right)\rho\\
G_{k:m}^{\rho} & =\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial w_{k}^{\rho}}=\delta_{k:m}^{2}R_{k}V\left(\delta_{k:m}\omega\right)\\
G_{k:m}^{\omega} & =\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial w_{k}^{\omega}}=\frac{\delta_{k:m}^{3}}{2}R_{k}V^{'}\left(\delta_{k:m}\omega\right)\rho.
\end{align*}

\end_inset

Lastly 
\begin_inset Formula $V_{m}=I$
\end_inset

.
\end_layout

\begin_layout Standard
Now that we have the Jacobians computed, we need to ensure that the system
 is observable.
 Since the system is nonlinear, the best we can do is ensure local observability.
 Given measurements from three different time steps, the observability matrix
 is 
\begin_inset Formula 
\[
\mathcal{O}=\begin{bmatrix}H_{k:m_{1}}\\
H_{k:m_{2}}\\
H_{k:m_{3}}
\end{bmatrix}.
\]

\end_inset

The observability matrix is not full rank.
 However, if the target has a circular trajectory and the target's heading
 is oriented along the body frame velocity, we can make the assumptions
 that 
\begin_inset Formula $\rho=\left[\rho_{x},0\right]^{\top}$
\end_inset

 and 
\begin_inset Formula $\rho_{x},\omega\neq0$
\end_inset

.
 Using these assumptions, the system is observable.
 In addition, if the target is moving in a straight line, then we can make
 the assumptions that 
\begin_inset Formula $\rho=\left[\rho_{x},0\right]^{\top}$
\end_inset

, 
\begin_inset Formula $\rho_{x}\neq0$
\end_inset

 and 
\begin_inset Formula $\omega=0$
\end_inset

.
 Under these assumptions and constraints, the system is observable.
 We can identify which constrained measurement we are trying to track by
 looking at three different measurements from different times.
 If the three measurement do not form a line, then the system has first
 constrains; otherwise, the latter.
\end_layout

\begin_layout Standard
Regardless of the constrained system we use, the rotation matrix can be
 off by a rotation of 
\begin_inset Formula $\pi$
\end_inset

 since the matrix exponential is surjective.
 In order to avoid calculating the wrong rotation matrix, we can seed the
 LMLE with approximate values.
 Let 
\begin_inset Formula $\theta=\text{Log}\left(R\right)$
\end_inset

 and 
\begin_inset Formula $\dot{t}$
\end_inset

 be the derivative of 
\begin_inset Formula $t$
\end_inset

, then 
\begin_inset Formula 
\begin{align*}
\dot{t}=\begin{bmatrix}\dot{t}_{x}\\
\dot{t}_{y}
\end{bmatrix} & =\text{Exp}\left(\theta\right)\rho\\
 & =\begin{bmatrix}\cos\left(\theta\right) & -\sin\left(\theta\right)\\
\sin\left(\theta\right) & \cos\left(\theta\right)
\end{bmatrix}\begin{bmatrix}\rho_{x}\\
0
\end{bmatrix}\\
 & =\begin{bmatrix}\rho_{x}\cos\left(\theta\right)\\
\rho_{x}\sin\left(\theta\right)
\end{bmatrix},
\end{align*}

\end_inset

dividing the two gives us 
\begin_inset Formula 
\[
\theta=\arctan\left(\dot{t}_{y}/\dot{t}_{x}\right).
\]

\end_inset

The value of 
\begin_inset Formula $\dot{t}$
\end_inset

 can be numerically approximated, and the estimation for 
\begin_inset Formula $\theta$
\end_inset

 can be enhanced by using multiple measurements.
 Once 
\begin_inset Formula $\theta$
\end_inset

 is estimated, you can use a method described in section 
\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:LMLE-Simplification"

\end_inset

 to estimate 
\begin_inset Formula $\omega$
\end_inset

 and 
\begin_inset Formula $\rho$
\end_inset

.
 These estimates are used to see the LMLE during the RANSAC step of the
 algorithm.
\end_layout

\begin_layout Standard

\series bold
Hardware Results
\end_layout

\begin_layout Subsection
Constrained Problem for SE
\begin_inset Formula $\left(3\right)$
\end_inset

: Tracking UAVs with Radar
\end_layout

\begin_layout Standard
In this example, there are multiple fixed radar sensors with overlapping
 LSR.
 Their measurements are point measurements and are converted to the fixed
 global frame before being given to R-RANSAC.
 We also assume that the measurement covariance can vary.
 The objective is to track multiple fixed wing aircrafts (FWAs) that are
 in the GSR.
 This is a similar example as the one in subsection 
\begin_inset CommandInset ref
LatexCommand eqref
reference "sub:tracking_image_plane"

\end_inset

, except that the FWAs' configuration manifold is 
\begin_inset Formula $SE\left(3\right)$
\end_inset

 instead of 
\begin_inset Formula $SE\left(2\right)$
\end_inset

, making the problem a little more difficult; see appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:SE3"

\end_inset

 for the system function and important Jacobians.
 
\end_layout

\begin_layout Standard
With only point measurements, the system is not observable unless constraints
 are made.
 
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $g_{k}\in SE\left(3\right)$
\end_inset

 and 
\begin_inset Formula $u_{k}\in\mathfrak{se}\left(3\right)$
\end_inset

.
 These elements can be written as 
\begin_inset Formula 
\begin{align*}
g_{k} & =\begin{bmatrix}R_{k} & t_{k}\\
0_{1\times2} & 1
\end{bmatrix}\\
u_{k} & =\begin{bmatrix}\omega_{k} & \rho_{k}\\
0_{1\times2} & 1
\end{bmatrix},
\end{align*}

\end_inset

where 
\begin_inset Formula $R_{k}\in SO\left(3\right)$
\end_inset

, 
\begin_inset Formula $\omega_{k}\in\mathfrak{so}\left(3\right)$
\end_inset

, and 
\begin_inset Formula $t_{k},\rho_{k}\in\mathbb{R}^{3}$
\end_inset

.
 The observation model is 
\begin_inset Formula 
\begin{align*}
y_{k} & =h\left(x_{k},v_{k}\right)\\
 & =t_{k}+v_{k},
\end{align*}

\end_inset

where 
\begin_inset Formula $y_{k}\in\mathbb{R}^{3}$
\end_inset

.
 The inverse observation model is 
\begin_inset Formula 
\begin{align*}
y_{m} & =h\left(f^{-1}\left(x_{k},\delta_{k:m},w_{k}\right),v_{k}\right)\\
 & =R_{k}V\left(\delta_{k:m}\left(\omega_{k}+w_{k}^{R}\right)+\frac{\delta_{k:m}^{2}w_{k}^{\omega}}{2}\right)\left(\delta_{k:m}\rho_{k}+\delta_{k:m}w_{k}^{\rho}\right)+t_{k}+w_{k}^{t}+v_{m},
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $w_{k}=\left[\left(w_{k}^{t}\right)^{\top},\left(w_{k}^{R}\right)^{\top},\left(w_{k}^{\rho}\right)^{\top},\left(w_{k}^{u}\right)^{\top}\right]^{\top}$
\end_inset

 and 
\begin_inset Formula $V$
\end_inset

 is defined in equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:V_se3"

\end_inset

.
 Based on the observation model, we have three Jacobians to compute: 
\begin_inset Formula $G_{k:m}$
\end_inset

, 
\begin_inset Formula $H_{k:m}$
\end_inset

 and 
\begin_inset Formula $V_{m}$
\end_inset

.
 
\begin_inset Formula 
\begin{align*}
H_{k:m}=\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial x} & =\begin{bmatrix}H_{k:m}^{t} & H_{k:m}^{R} & H_{k:m}^{\rho} & H_{k:m}^{\omega}\end{bmatrix},
\end{align*}

\end_inset

where
\begin_inset Formula 
\begin{align*}
H_{k:m}^{t}=\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial t_{k}} & =I\\
H_{k:m}^{R}=\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial R} & =\delta_{k:m}R_{k}\left[-V\left(\delta_{k:m}\omega\right)\rho\right]_{\times}\\
H_{k:m}^{\rho}=\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial\rho} & =\delta_{k:m}^{2}R_{k}V\left(\delta_{k:m}\omega\right)\\
H_{k:m}^{\omega}=\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial\omega} & =\delta_{k:m}^{2}R_{k}\partial V_{\delta_{k:m}\omega}\left(\delta_{k:m}\rho\right),
\end{align*}

\end_inset

and
\begin_inset Formula $\partial V_{\delta_{k:m}\omega}\left(\rho\right)$
\end_inset

 is defined in Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:dJl"

\end_inset

.
 We quickly note that 
\begin_inset Formula 
\[
H_{k}=H_{k:k}=\begin{bmatrix}I & 0_{2\times9}\end{bmatrix}.
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
G_{k:m}=\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial w_{k}}=\begin{bmatrix}G_{k:m}^{t} & G_{k:m}^{R} & G_{k:m}^{\rho} & G_{k:m}^{\omega}\end{bmatrix},
\]

\end_inset

where 
\begin_inset Formula 
\begin{align*}
G_{k:m}^{t} & =\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial w_{k}^{t}}=I\\
G_{k:m}^{R} & =\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial w_{k}^{R}}=\delta_{k:m}^{2}R_{k}\partial V_{\delta_{k:m}\omega}\left(\delta_{k:m}\rho\right)\\
G_{k:m}^{\rho} & =\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial w_{k}^{\rho}}=\delta_{k:m}^{2}R_{k}V\left(\delta_{k:m}\omega\right)\\
G_{k:m}^{\omega} & =\frac{\partial h\left(f^{-1},v_{k}\right)}{\partial w_{k}^{\omega}}=\frac{\delta_{k:m}^{3}}{2}R_{k}\partial V_{\delta_{k:m}\omega}\left(\delta_{k:m}\rho\right).
\end{align*}

\end_inset

Lastly 
\begin_inset Formula $V_{m}=I$
\end_inset

.
\end_layout

\begin_layout Standard
Now that we have the Jacobians computed, we need to ensure that the system
 is observable.
 Since the system is nonlinear, the best we can do is ensure local observability.
 Given measurements from four different time steps, the observability matrix
 is 
\begin_inset Formula 
\[
\mathcal{O}=\begin{bmatrix}H_{k:m_{1}}\\
H_{k:m_{2}}\\
H_{k:m_{3}}\\
H_{k:m_{4}}
\end{bmatrix}.
\]

\end_inset

The observability matrix is not full rank.
 However, certain constraints, the system is observable.
 We described these constraints using two configuration.
 In the first configuration the FWA is making a coordinated turn or a spiral
 trajectory and we assume that that 
\begin_inset Formula $\rho=\left[\rho_{x},0,0\right]$
\end_inset

 and 
\begin_inset Formula $\omega\neq0$
\end_inset

.
 In the second configuration, the FWA is moving in a straight line and we
 assume that 
\begin_inset Formula $\rho=\left[\rho_{x},0,0\right]$
\end_inset

, 
\begin_inset Formula $\omega=0$
\end_inset

, and the roll in attitude (using roll, pitch, yaw) is zero.
 To determine which configuration to use, we can look at four measurements,
 and see if they form a line.
 If they don't, then we use the first configuration; otherwise, the second.
 
\end_layout

\begin_layout Standard
Since the system is nonlinear, the LMLE can take a while to converge, and
 can converge to an undesirable state.
 To minimize these issues we can seed the optimization method.
 To do this, we will use the Euler angles (roll 
\begin_inset Formula $\phi$
\end_inset

, pitch 
\begin_inset Formula $\theta$
\end_inset

, yaw 
\begin_inset Formula $\psi$
\end_inset

) as local coordinates instead of 
\begin_inset Formula $\mathfrak{so}\left(3\right)$
\end_inset

.
 The map from Euler angles to 
\begin_inset Formula $SO\left(3\right)$
\end_inset

 is defined as 
\begin_inset Formula 
\[
\mathcal{R}\left(\phi,\theta,\psi\right)=\begin{bmatrix}c_{\theta}c_{\psi} & s_{\phi}s_{\theta}c_{\psi}-c_{\phi}s_{\psi} & c_{\phi}s_{\theta}c_{\psi}+s_{\phi}s_{\psi}\\
c_{\theta}s_{\psi} & s_{\phi}s_{\theta}s_{\psi}+c_{\phi}c_{\psi} & c_{\phi}s_{\theta}s_{\psi}-s_{\phi}c_{\psi}\\
-s_{\theta} & s_{\phi}c_{\theta} & c_{\phi}c_{\theta}
\end{bmatrix}.
\]

\end_inset

The derivative of the position vector 
\begin_inset Formula $t$
\end_inset

 is related to 
\begin_inset Formula $\rho$
\end_inset

 through the rotation matrix 
\begin_inset Formula $R$
\end_inset

.
 This allows us to write the constraints
\begin_inset Formula 
\begin{align*}
\dot{t} & =R\rho\\
 & =\mathcal{R}\left(\phi,\theta,\psi\right)\rho.
\end{align*}

\end_inset

Letting 
\begin_inset Formula $\dot{t}=\left[\dot{t}_{x},\dot{t}_{y},\dot{t}_{z}\right]^{\top}$
\end_inset

, we get 
\begin_inset Formula 
\[
\begin{bmatrix}\dot{t}_{x}\\
\dot{t}_{y}\\
\dot{t}_{z}
\end{bmatrix}=\underbrace{\begin{bmatrix}c_{\theta}c_{\psi}\\
c_{\theta}s_{\psi}\\
-s_{\theta}
\end{bmatrix}}_{\mathcal{R}_{x}}\rho_{x}.
\]

\end_inset

Since we receive position measurements, we can numerically estimate 
\begin_inset Formula $\dot{t}$
\end_inset

 from two measurements and solve for 
\begin_inset Formula $\theta$
\end_inset

, 
\begin_inset Formula $\psi$
\end_inset

, and 
\begin_inset Formula $\rho_{x}$
\end_inset

 using the equations 
\begin_inset Formula 
\begin{align*}
\psi & =\arctan\left(\frac{\dot{t}_{y}}{\dot{t}_{x}}\right)\\
\theta & =\arcsin\left(-\dot{t}_{z}\right)\\
\rho_{x} & =\frac{\mathcal{R}_{x}^{\top}\dot{t}}{\mathcal{R}_{x}^{\top}\mathcal{R}_{x}}.
\end{align*}

\end_inset

If the system is in configuration 2, then we are done; otherwise, we assume
 the FWA is making a coordinated turn as described in 
\begin_inset CommandInset citation
LatexCommand cite
key "Beard2008"

\end_inset

.
 In the absence of sideslip, a coordinated turn has the constraint
\begin_inset Formula 
\[
\dot{\psi}=\frac{g}{\left\Vert \dot{t}\right\Vert }\tan\left(\phi\right),
\]

\end_inset

where 
\begin_inset Formula $g$
\end_inset

 is the gravitational constant.
 Since we can estimate 
\begin_inset Formula $\psi$
\end_inset

 at two different time periods, we can numerically estimate its derivative
 
\begin_inset Formula $\dot{\psi}$
\end_inset

.
 Solving for 
\begin_inset Formula $\phi$
\end_inset

 we get 
\begin_inset Formula 
\[
\phi=\arctan\left(\frac{\dot{\psi}\left\Vert \dot{t}\right\Vert }{g}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
The choice of 
\begin_inset Formula $\phi$
\end_inset

 doesn't really matter if we are only interested is reconstructing the position,
 in which case we could set 
\begin_inset Formula $\phi=0$
\end_inset

.
\end_layout

\begin_layout Standard
Since we can calculate estimate 
\begin_inset Formula $R$
\end_inset

, we can estimate 
\begin_inset Formula $\dot{R}$
\end_inset

.
 Using the identity 
\begin_inset Formula $\dot{R}=R\omega$
\end_inset

, we can estimate 
\begin_inset Formula $\omega$
\end_inset

 as 
\begin_inset Formula 
\[
\omega=R\dot{R}.
\]

\end_inset


\end_layout

\begin_layout Standard
The numerical accuracies are dependent on measurement and system process
 noise and the time interval between measurements.
 But that is fine since these estimates are being used to seed the LMLE
 optimization process.
 
\end_layout

\begin_layout Appendices

\end_layout

\begin_layout Section
SE
\begin_inset Formula $\left(2\right)$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:SE2"

\end_inset


\end_layout

\begin_layout Standard
The special Euclidean group of two dimensions is a matrix Lie group and
 is the set 
\begin_inset Formula 
\[
SE\left(2\right)=\left\{ \left.\begin{bmatrix}R & t\\
0_{1\times2} & 1_{1\times1}
\end{bmatrix}\,\right|\,R\in SO\left(2\right)\text{ and }t\in\mathbb{R}^{2}\right\} 
\]

\end_inset

equipped with matrix multiplication.
 The Lie algebra is 
\begin_inset Formula 
\[
\mathfrak{se}\left(2\right)=\left\{ \left.\begin{bmatrix}\omega & \rho\\
0 & 0
\end{bmatrix}\,\right|\,\omega\in\mathfrak{s0}\left(2\right)\text{ and }\rho\in\mathbb{R}^{2}\right\} ,
\]

\end_inset

where 
\begin_inset Formula $\theta\in\mathbb{R},$
\end_inset


\begin_inset Formula $\omega=\left[\theta\right]_{\times}$
\end_inset

, and 
\begin_inset Formula $\left[\cdot\right]_{\times}$
\end_inset

 is the skew symmetric operator defined as 
\begin_inset Formula 
\[
\left[\theta\right]_{\times}=\begin{bmatrix}0 & -\theta\\
\theta & 0
\end{bmatrix},
\]

\end_inset

and 
\begin_inset Formula 
\[
\begin{bmatrix}\rho\\
\theta
\end{bmatrix}\in\mathbb{R}^{3}
\]

\end_inset

which is the Cartesian vector space.
 
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $g\in SE\left(2\right)$
\end_inset

 and 
\begin_inset Formula $u\in\mathfrak{se}\left(2\right)$
\end_inset

.
 Using an element of the Lie algebra, we can define the infinitesimal generator
 
\begin_inset Formula $\xi_{u}:G\to TG$
\end_inset

 as 
\begin_inset Formula 
\begin{align*}
\xi_{u}\left(g\right) & =gu\\
 & =\dot{g}.
\end{align*}

\end_inset

The discretized system function 
\begin_inset Formula $f:SE\left(2\right)\times\mathbb{R}^{2}\to SE\left(2\right)\times\mathbb{R}^{2}$
\end_inset

 is 
\begin_inset Formula 
\begin{align*}
g_{k} & =\text{\exp}\left(\delta_{k}\left(u_{k^{-}}+w_{k}^{g}\right)+\frac{\delta_{k}^{2}}{2}w_{k}^{u}\right)\\
u_{k} & =u_{k^{-}}+\delta_{k}w_{k}^{u}
\end{align*}

\end_inset


\end_layout

\begin_layout Subsection
Group Operations
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $g_{1},g_{2}\in SE\left(2\right)$
\end_inset

.
 The inversion and group multiplication is matrix inversion and matrix multiplic
ation as follows
\begin_inset Formula 
\begin{align*}
g_{1}^{-1} & =\begin{bmatrix}R_{1}^{\top} & -R_{1}^{\top}t_{1}\\
0 & 1
\end{bmatrix}\\
g_{1}g_{2} & =\begin{bmatrix}R_{1}R_{2} & R_{1}t_{2}+t_{1}\\
0 & 1
\end{bmatrix}.
\end{align*}

\end_inset

 
\end_layout

\begin_layout Subsection
Exponential Map
\end_layout

\begin_layout Standard
The exponential map is the matrix exponential and it's inverse is the matrix
 logarithm.
 The matrix exponential is a surjective function; however, by restricting
 the domain to 
\begin_inset Formula 
\[
U=\left\{ u\in\mathfrak{se}\left(2\right)\,\mid\,\left\Vert u\right\Vert <\pi\right\} ,
\]

\end_inset

it becomes a bijection.
 In this case, the exponential map and its inverse have a simplified form
 
\begin_inset Formula 
\begin{align*}
\text{\exp}\left(u\right) & =\begin{bmatrix}\exp\left(\omega\right) & V\left(\omega\right)\rho\\
0_{1\times2} & 1
\end{bmatrix}\\
\text{\log}\left(g\right) & =\begin{bmatrix}\log\left(R\right) & V^{-1}\left(\omega\right)t\\
0_{1\times2} & 0
\end{bmatrix}
\end{align*}

\end_inset

with
\begin_inset Formula 
\begin{align}
\exp\left(\omega\right) & =\begin{bmatrix}\cos\left(\theta\right) & -\sin\left(\theta\right)\\
\sin\left(\theta\right) & \cos\left(\theta\right)
\end{bmatrix}\\
\log\left(R\right) & =\arctan\left(R_{21},R_{11}\right)\\
\omega & =\log\left(R\right)\\
V\left(\omega\right) & =\begin{cases}
I & \text{if }\theta=0\\
\frac{\sin\left(\theta\right)}{\theta}I+\frac{1-\cos\left(\theta\right)}{\theta}\left[1\right]_{\times} & \text{else}
\end{cases}\label{eq:se2_v}\\
V^{-1}\left(\omega\right) & =\begin{cases}
I & \text{if }\theta=0\\
\frac{\theta\sin\left(\theta\right)}{2\left(1-\cos\left(\theta\right)\right)}I-\frac{\theta}{2}\left[1\right]_{\times} & \text{else}
\end{cases}.
\end{align}

\end_inset


\end_layout

\begin_layout Subsection
Jacobians
\end_layout

\begin_layout Subsubsection
Adjoint
\end_layout

\begin_layout Standard
The group adjoint representation is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{Ad}_{g}=\begin{bmatrix}R & -\left[1\right]_{\times}t\\
0_{1\times2} & 1
\end{bmatrix}
\]

\end_inset

with inverse 
\begin_inset Formula 
\[
\mathbf{Ad}_{g}^{-1}=\begin{bmatrix}R^{\top} & R^{\top}\left[1\right]_{\times}t\\
0_{1\times2} & 1
\end{bmatrix}.
\]

\end_inset

The Lie algebra adjoint representation is 
\begin_inset Formula 
\[
\mathbf{ad}_{u}=\begin{bmatrix}\left[\omega\right]_{\times} & -\left[1\right]_{\times}\rho\\
0_{1\times2} & 0
\end{bmatrix}.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
Left and Right Jacobians
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula 
\begin{align*}
W_{r}\left(\theta\right) & =\frac{\cos\left(\theta\right)-1}{\theta}\left[1\right]_{\times}+\frac{\sin\left(\theta\right)}{\theta}I\\
D_{r}\left(\theta\right) & =\frac{1-\cos\left(\theta\right)}{\theta^{2}}\left[1\right]_{\times}+\frac{\theta-\sin\left(\theta\right)}{\theta^{2}}I\\
W_{l}\left(\theta\right) & =\frac{1-\cos\left(\theta\right)}{\theta}\left[1\right]_{\times}+\frac{\sin\left(\theta\right)}{\theta}I\\
D_{l}\left(\theta\right) & =\frac{\cos\left(\theta\right)-1}{\theta^{2}}\left[1\right]_{\times}+\frac{\theta-\sin\left(\theta\right)}{\theta^{2}}I,
\end{align*}

\end_inset

then 
\begin_inset Formula 
\begin{align*}
J_{r}\left(u\right) & =\begin{bmatrix}W_{r}\left(\theta\right) & D_{r}\left(\theta\right)\rho\\
0 & 1
\end{bmatrix},\\
J_{l}\left(u\right) & =\begin{bmatrix}W_{l}\left(\theta\right) & D_{l}\left(\theta\right)\rho\\
0 & 1
\end{bmatrix}\\
J_{r}^{-1}\left(u\right) & =\begin{bmatrix}W_{r}^{-1}\left(\theta\right) & -W_{r}^{-1}\left(\theta\right)D_{r}\left(\theta\right)\rho\\
0 & 1
\end{bmatrix}\\
J_{l}^{-1}\left(u\right) & =\begin{bmatrix}W_{l}^{-1}\left(\theta\right) & -W_{l}^{-1}\left(\theta\right)D_{l}\left(\theta\right)\rho\\
0 & 1
\end{bmatrix}.
\end{align*}

\end_inset

If 
\begin_inset Formula $\theta=0$
\end_inset

, then the Jacobians and their inverses are 
\begin_inset Formula 
\[
J_{r}\left(u\right)=J_{l}\left(u\right)=J_{r}^{-1}\left(u\right)=J_{l}^{-1}\left(u\right)=I.
\]

\end_inset


\end_layout

\begin_layout Section
SE
\begin_inset Formula $\left(3\right)$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sec:SE3"

\end_inset


\end_layout

\begin_layout Standard
The special Euclidean group of three dimensions is a matrix Lie group and
 is the set 
\begin_inset Formula 
\[
SE\left(3\right)=\left\{ \left.\begin{bmatrix}R & t\\
0_{1\times2} & 1_{1\times1}
\end{bmatrix}\,\right|\,R\in SO\left(3\right)\text{ and }t\in\mathbb{R}^{3}\right\} 
\]

\end_inset

equipped with matrix multiplication.
 The Lie algebra is 
\begin_inset Formula 
\[
\mathfrak{se}\left(3\right)=\left\{ \left.\begin{bmatrix}\omega & \rho\\
0 & 0
\end{bmatrix}\,\right|\,\omega\in\mathfrak{s0}\left(3\right)\text{ and }\rho\in\mathbb{R}^{3}\right\} ,
\]

\end_inset

where 
\begin_inset Formula $\theta=\left[\theta_{1},\theta_{2},\theta_{2}\right]^{\top}\in\mathbb{R}^{3}$
\end_inset

, 
\begin_inset Formula $\omega=\left[\theta\right]_{\times}$
\end_inset

 and 
\begin_inset Formula $\left[\cdot\right]_{\times}$
\end_inset

 is the skew symmetric operator defined as 
\begin_inset Formula 
\[
\left[\theta\right]_{\times}=\begin{bmatrix}0 & -\theta_{3} & \theta_{2}\\
\theta_{3} & 0 & -\theta_{1}\\
-\theta_{2} & \theta_{1} & 0
\end{bmatrix},
\]

\end_inset

and 
\begin_inset Formula 
\[
\begin{bmatrix}\rho\\
\theta
\end{bmatrix}\in\mathbb{R}^{6}
\]

\end_inset

which is the Cartesian vector space.
 
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $g\in SE\left(3\right)$
\end_inset

 and 
\begin_inset Formula $u\in\mathfrak{se}\left(3\right)$
\end_inset

.
 Using an element of the Lie algebra, we can define the infinitesimal generator
 
\begin_inset Formula $\xi_{u}:G\to TG$
\end_inset

 as 
\begin_inset Formula 
\begin{align*}
\xi_{u}\left(g\right) & =gu\\
 & =\dot{g}.
\end{align*}

\end_inset

The discretized system function 
\begin_inset Formula $f:SE\left(3\right)\times\mathbb{R}^{3}\to SE\left(3\right)\times\mathbb{R}^{3}$
\end_inset

 is 
\begin_inset Formula 
\begin{align*}
g_{k} & =\exp\left(\delta_{k}\left(u_{k^{-}}+w_{k}^{g}\right)+\frac{\delta_{k}^{2}}{2}w_{k}^{u}\right)\\
u_{k} & =u_{k^{-}}+\delta_{k}w_{k}^{u}
\end{align*}

\end_inset


\end_layout

\begin_layout Subsection
Group Operations
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $g_{1},g_{2}\in SE\left(3\right)$
\end_inset

.
 The inversion and group multiplication is matrix inversion and matrix multiplic
ation as follows
\begin_inset Formula 
\begin{align*}
g_{1}^{-1} & =\begin{bmatrix}R_{1}^{\top} & -R_{1}^{\top}t_{1}\\
0 & 1
\end{bmatrix}\\
g_{1}g_{2} & =\begin{bmatrix}R_{1}R_{2} & R_{1}t_{2}+t_{1}\\
0 & 1
\end{bmatrix}.
\end{align*}

\end_inset

 
\end_layout

\begin_layout Subsection
Exponential Map
\end_layout

\begin_layout Standard
The exponential map is the matrix exponential and it's inverse is the matrix
 logarithm.
 The matrix exponential is a surjective function; however, by restricting
 the domain to 
\begin_inset Formula 
\[
U=\left\{ u\in\mathfrak{se}\left(3\right)\,\mid\,\left\Vert u\right\Vert <\pi\right\} ,
\]

\end_inset

it becomes a bijection.
 In this case, the exponential map and its inverse have a simplified form
 
\begin_inset Formula 
\begin{align*}
\exp\left(u\right) & =\begin{bmatrix}\exp\left(\left[\omega\right]_{\times}\right) & V\left(\omega\right)\rho\\
0 & 1
\end{bmatrix}\\
\text{\log}\left(g\right) & =\begin{bmatrix}V^{-1}\left(\omega\right)t\\
\log\left(R\right)
\end{bmatrix}
\end{align*}

\end_inset

with 
\begin_inset Formula $g=\exp\left(u\right)$
\end_inset

,
\begin_inset Formula 
\begin{align}
\phi & =\sqrt{\omega^{\top}\omega}\\
\exp\left(\omega\right) & =I+\frac{\sin\left(\theta\right)}{\theta}\omega+\frac{1-\cos\left(\theta\right)}{\theta^{2}}\omega^{2}\\
\phi & =\arccos\left(\frac{\text{trace}\left(R\right)-1}{2}\right)\\
\log\left(R\right) & =\begin{cases}
0_{2\times2} & \text{if }\phi=0\\
\frac{\phi}{2\sin\left(\phi\right)}\left(R-R^{\top}\right) & \text{else}
\end{cases}\\
V\left(\omega\right) & =\begin{cases}
I & \text{if }\phi=0\\
I+\frac{1-\cos\left(\phi\right)}{\phi^{2}}\omega+\frac{\phi-\sin\left(\phi\right)}{\phi^{3}}\omega^{2} & \text{else}
\end{cases}\label{eq:V_se3}\\
V^{-1}\left(\omega\right) & =\begin{cases}
I & \text{if }\theta=0\\
I-\frac{\omega}{2}+\left(\frac{1}{\phi^{2}}-\frac{\phi\sin\left(\phi\right)}{2\phi^{2}\left(1-\cos\left(\phi\right)\right)}\right)\omega^{2} & \text{else}
\end{cases}.
\end{align}

\end_inset


\end_layout

\begin_layout Subsection
Jacobians
\end_layout

\begin_layout Subsubsection
Adjoint
\end_layout

\begin_layout Standard
The group adjoint representation is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{Ad}_{g}=\begin{bmatrix}R & \left[t\right]_{\times}R\\
0_{3\times3} & R
\end{bmatrix}
\]

\end_inset

with inverse 
\begin_inset Formula 
\[
\mathbf{Ad}_{g}^{-1}=\begin{bmatrix}R^{\top} & -R^{\top}\left[t\right]_{\times}\\
0_{3\times3} & R^{\top}
\end{bmatrix}.
\]

\end_inset


\end_layout

\begin_layout Standard
The Lie algebra representation is 
\begin_inset Formula 
\[
\mathbf{ad}_{u}=\begin{bmatrix}\left[\omega\right]_{\times} & \left[\rho\right]_{\times}\\
0_{3\times3} & \left[\omega\right]_{\times}
\end{bmatrix}.
\]

\end_inset


\end_layout

\begin_layout Subsubsection
Left and Right Jacobians
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $u=\begin{bmatrix}\omega & \rho\\
0 & 0
\end{bmatrix}\in\mathfrak{se}\left(3\right)$
\end_inset

 and 
\begin_inset Formula 
\begin{align}
\phi & =\sqrt{\omega^{\top}\omega}\nonumber \\
a_{\phi} & =\frac{\cos\left(\phi\right)-1}{\phi^{2}}\nonumber \\
b_{\phi} & =\frac{\phi-\sin\left(\phi\right)}{\phi^{3}}\nonumber \\
c_{\phi} & =-\frac{1}{\phi^{3}}\sin\left(\phi\right)+2\left(\frac{1-\cos\left(\phi\right)}{\phi^{4}}\right)\nonumber \\
d_{\theta} & =-\frac{2}{\phi^{4}}+\frac{3}{\phi^{5}}\sin\left(\phi\right)-\frac{1}{\phi^{4}}\cos\left(\phi\right)\nonumber \\
q_{r}\left(\omega\right) & =\left(\left(\omega^{\vee}\right)^{\top}\rho\right)\left(d_{\phi}\omega^{2}+c_{\phi}\omega\right)\nonumber \\
q_{l}\left(\omega\right) & =\left(\left(\omega^{\vee}\right)^{\top}\rho\right)\left(d_{\phi}\omega^{2}-c_{\phi}\omega\right)\nonumber \\
B_{r}\left(u\right) & =q_{r}\left(\omega\right)+a_{\phi}\left[\rho\right]_{\times}+b_{\phi}\left(\omega\left[\rho\right]_{\times}+\left[\rho\right]_{\times}\omega\right)\nonumber \\
B_{l}\left(u\right) & =q_{l}\left(\omega\right)-a_{\phi}\left[\rho\right]_{\times}+b_{\phi}\left(\omega\left[\rho\right]_{\times}+\left[\rho\right]_{\times}\omega\right)\nonumber \\
J_{r}\left(\omega\right) & =I+\frac{\cos\left(\phi\right)-1}{\phi^{2}}\omega+\frac{\phi-\sin\left(\phi\right)}{\phi^{3}}\omega^{2}\nonumber \\
J_{l}\left(\omega\right) & =I+\frac{1-\cos\left(\phi\right)}{\phi^{2}}\omega+\frac{\phi-\sin\left(\phi\right)}{\phi^{3}}\omega^{2}\label{eq:Jl_so3}\\
J_{r}^{-1}\left(\omega\right) & =I+\frac{1}{2}\omega-\frac{\phi\cot\left(\frac{\phi}{2}\right)-2}{2\phi^{2}}\omega^{2}\nonumber \\
J_{l}^{-1}\left(\omega\right) & =I-\frac{1}{2}\omega-\frac{\phi\cot\left(\frac{\phi}{2}\right)-2}{2\phi^{2}}\omega^{2}.\nonumber 
\end{align}

\end_inset

then 
\begin_inset Formula 
\begin{align*}
J_{r}\left(u\right) & =\begin{bmatrix}J_{r}\left(\omega\right) & B_{r}\left(u\right)\\
0 & J_{r}\left(\omega\right)
\end{bmatrix}\\
J_{l}\left(u\right) & =\begin{bmatrix}J_{l}\left(\omega\right) & B_{l}\left(u\right)\\
0 & J_{l}\left(\omega\right)
\end{bmatrix}\\
J_{r}^{-1}\left(u\right) & =\begin{bmatrix}J_{r}^{-1}\left(\omega\right) & J_{r}^{-1}\left(\omega\right)B_{r}\left(u\right)J_{r}^{-1}\left(\omega\right)\\
0 & J_{r}^{-1}\left(\omega\right)
\end{bmatrix}\\
J_{l}^{-1}\left(u\right) & =\begin{bmatrix}J_{l}^{-1}\left(\omega\right) & J_{l}^{-1}\left(\omega\right)B_{l}\left(u\right)J_{l}^{-1}\left(\omega\right)\\
0 & J_{l}^{-1}\left(\omega\right)
\end{bmatrix}.
\end{align*}

\end_inset


\end_layout

\begin_layout Section
Lemma
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:dJl"

\end_inset

Let 
\begin_inset Formula $J_{l}\left(\omega\right)$
\end_inset

 denote the left Jacobian of 
\begin_inset Formula $SO\left(3\right)$
\end_inset

 and 
\begin_inset Formula $\rho\in\mathbb{R}^{3}$
\end_inset

.
 The derivative of 
\begin_inset Formula $J_{l}\left(\omega\right)p$
\end_inset

 with respect to 
\begin_inset Formula $\omega$
\end_inset

, denote 
\begin_inset Formula $\partial V_{\omega}\left(\rho\right)$
\end_inset

, is 
\begin_inset Formula 
\begin{align*}
\partial V_{\omega}\left(\rho\right) & =\left(\frac{1-\cos\left(\theta\right)}{\theta^{2}}\right)\left[-\rho\right]_{\times}\\
 & +\left(\frac{\theta-\sin\left(\theta\right)}{\theta^{3}}\right)\left(-2\omega\left[\rho\right]_{\times}+\left[\rho\right]_{\times}\omega_{\times}\right)\\
 & +\left(\frac{\sin\left(\theta\right)\theta+2\left(\cos\left(\theta\right)-1\right)}{\theta^{4}}\right)\omega\rho\left(\omega^{\vee}\right)^{\top}\\
 & +\left(\frac{3\sin\left(\theta\right)-\cos\left(\theta\right)\theta-2\theta}{\theta^{5}}\right)\omega^{2}\rho\left(\omega^{\vee}\right)^{\top}.
\end{align*}

\end_inset

where 
\begin_inset Formula $\omega\in\mathfrak{s0}\left(3\right)$
\end_inset

, and 
\begin_inset Formula $\theta=\sqrt{\left(\omega^{\vee}\right)^{\top}\omega^{\vee}}$
\end_inset

.
\end_layout

\begin_layout Proof
We first note that 
\begin_inset Formula $V\left(\omega\right)=J_{l}\left(\omega\right)$
\end_inset

 where 
\begin_inset Formula $J_{l}\left(\omega\right)$
\end_inset

 is defined in equation 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Jl_so3"

\end_inset

.
 It follows directly that 
\begin_inset Formula 
\[
\frac{\partial J_{l}\left(\omega\right)}{\partial\omega}=\frac{\partial}{\partial\omega}\left(I+\frac{1-\cos\left(\theta\right)}{\theta^{2}}\omega+\frac{\theta-\sin\left(\theta\right)}{\theta^{3}}\omega^{2}\right)\rho.
\]

\end_inset

Using the product rule, we can break up the derivation into parts: 
\begin_inset Formula 
\[
\frac{\partial}{\partial\omega}\frac{1-\cos\left(\theta\right)}{\theta^{2}}=\frac{\sin\left(\theta\right)\theta+2\left(\cos\left(\theta\right)+1\right)}{\theta^{3}}\left(\omega^{\vee}\right)^{\top}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\partial}{\partial\omega}\frac{\theta-\sin\left(\theta\right)}{\theta^{3}}=\frac{3\sin\left(\theta\right)-\cos\left(\theta\right)\theta-2\theta}{\theta^{5}}
\]

\end_inset


\begin_inset Formula 
\[
\frac{\partial}{\partial\omega}\omega\rho=\left[-\rho\right]_{\times}
\]

\end_inset

and 
\begin_inset Formula 
\[
\frac{\partial}{\partial\omega}\omega^{2}\rho=-2\omega\left[\rho\right]_{\times}+\left[\rho\right]_{\times}\omega_{\times}.
\]

\end_inset

Putting the pieces together, we get solution stated in the lemma.
\end_layout

\begin_layout --Separator--
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "/home/mark/Documents/mendeley/library"
options "plain"

\end_inset


\end_layout

\end_body
\end_document
