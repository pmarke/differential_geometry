#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass article
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 1in
\topmargin 1in
\rightmargin 1in
\bottommargin 1in
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Localization With Error-State Kalman Filter on Manifold
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
In recent years there has been a remarkable push for representing state
 estimation properly.
 This push has led to recent research in expressing the pose of a robot
 on manifolds such that the derivatives, integrals, and uncertainties are
 handled properly and with ease.
 This approach aims at representing uncertainties in a minimal way to increase
 computational efficiency and accuracy.
 This note follows example A in section 4 of 
\begin_inset CommandInset citation
LatexCommand cite
key "Sola2018"

\end_inset

, and is intended to elaborate the details in order to test my understanding
 of the material.
 In addition, I hope to understand if this new method is truly superior
 to previous methods.
 
\end_layout

\begin_layout Subsection
Notation
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathcal{F}^{x}$
\end_inset

 Represents the frame where 
\begin_inset Formula $x\in\left\{ g,i,b\right\} $
\end_inset

where 
\begin_inset Formula $g$
\end_inset

 denotes global, 
\begin_inset Formula $i$
\end_inset

 inertial, and 
\begin_inset Formula $b$
\end_inset

 body.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathcal{O}^{x}$
\end_inset

 Represent the origin of the coordinate system associated with 
\begin_inset Formula $\mathcal{F}^{x}$
\end_inset

 where 
\begin_inset Formula $x\in\left\{ g,i,b\right\} $
\end_inset

where 
\begin_inset Formula $g$
\end_inset

 denotes global, 
\begin_inset Formula $i$
\end_inset

 inertial, and 
\begin_inset Formula $b$
\end_inset

 body.
\end_layout

\begin_layout Itemize
\begin_inset Formula $P_{o/m}^{n}$
\end_inset

 Denotes a vector from object 
\begin_inset Formula $o$
\end_inset

 to 
\begin_inset Formula $\mathcal{O}^{m}$
\end_inset

 expressed in 
\begin_inset Formula $\mathcal{F}^{n}$
\end_inset

 were 
\begin_inset Formula $m,n\in\left\{ g,i,b\right\} $
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathcal{X}\in G$
\end_inset

 denotes an element of a group 
\begin_inset Formula $G$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\tau\in\mathbb{R}^{n}$
\end_inset

 denotes an element in the vector space that is isomorphic to the tangent
 space of 
\begin_inset Formula $G$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\tau^{\wedge}\in\mathfrak{g}$
\end_inset

 denotes an element in the Lie algebra associated with the Lie Group 
\begin_inset Formula $G$
\end_inset


\end_layout

\begin_layout Itemize
The operator 
\begin_inset Formula $\wedge$
\end_inset

 maps an element from the vector space 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

 to the tangent space of 
\begin_inset Formula $G$
\end_inset

 such that 
\begin_inset Formula $\left(\tau\right)^{\wedge}\in\mathfrak{g}$
\end_inset


\end_layout

\begin_layout Itemize
The operator 
\begin_inset Formula $\vee$
\end_inset

 maps an element from 
\begin_inset Formula $\mathfrak{g}$
\end_inset

 to 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

 and is expressed as 
\begin_inset Formula $\left(\tau^{\wedge}\right)^{\vee}=\tau$
\end_inset

.
\end_layout

\begin_layout Itemize
The operator 
\begin_inset Formula $\curlywedge$
\end_inset

 maps an element from the vector space 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

 to the adjoint of an element of 
\begin_inset Formula $\mathfrak{g}$
\end_inset

 and is expressed as 
\begin_inset Formula $\tau^{\curlywedge}\in\mathbf{ad}\left(\mathfrak{g}\right)$
\end_inset

.
\end_layout

\begin_layout Itemize
The operator 
\begin_inset Formula $\curlyvee$
\end_inset

 maps an element from 
\begin_inset Formula $\mathbf{ad}\left(\mathfrak{g}\right)$
\end_inset

 to 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

 and is expressed as 
\begin_inset Formula $\left(\tau^{\curlywedge}\right)^{\curlyvee}$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\boxplus$
\end_inset

 Is a binary operator that maps an element of 
\begin_inset Formula $G$
\end_inset

 and 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

 to 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

, 
\begin_inset Formula $\boxplus:G\times\mathbb{R}^{n}\to G$
\end_inset

, and is expressed as 
\begin_inset Formula $\mathcal{X}\boxplus\tau=\left(\mathcal{X}\exp\left(\tau^{\wedge}\right)\right)\in G$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\boxminus$
\end_inset

 Is a binary operator that maps two elements of 
\begin_inset Formula $G$
\end_inset

 to 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

,
\begin_inset Formula $\boxminus:G\times G\to\mathbb{R}^{n}$
\end_inset

, and is expressed as 
\begin_inset Formula $\mathcal{X}_{1}\boxminus\mathcal{X}_{2}=\log\left(\mathcal{X}_{2}^{-1}\mathcal{X}_{1}\right)^{\vee}\in\mathbb{R}^{n}$
\end_inset

.
 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\oplus$
\end_inset

 Is a binary operator that maps an element of 
\begin_inset Formula $G$
\end_inset

 and 
\begin_inset Formula $\mathfrak{g}$
\end_inset

 to 
\begin_inset Formula $\mathfrak{g}$
\end_inset

, 
\begin_inset Formula $\oplus:G\times\mathfrak{g}\to G$
\end_inset

, and is expressed as 
\begin_inset Formula $\mathcal{X}\oplus\tau^{\wedge}=\left(\mathcal{X}\exp\left(\tau^{\wedge}\right)\right)\in G$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\ominus$
\end_inset

 Is a binary operator that maps two elements of 
\begin_inset Formula $G$
\end_inset

 to 
\begin_inset Formula $\mathfrak{g}$
\end_inset

,
\begin_inset Formula $\oplus:G\times G\to\mathfrak{g}$
\end_inset

, and is expressed as 
\begin_inset Formula $\mathcal{X}_{1}\boxminus\mathcal{X}_{2}=\log\left(\mathcal{X}_{2}^{-1}\mathcal{X}_{1}\right)\in\mathfrak{g}$
\end_inset

.
 
\end_layout

\begin_layout Itemize
\begin_inset Formula $Ad_{\mathcal{X}}$
\end_inset


\begin_inset Formula $\left(\cdot\right)$
\end_inset

 Is the adjoint of the group 
\begin_inset Formula $G$
\end_inset

 at 
\begin_inset Formula $\mathcal{X}\in G$
\end_inset

 operating on 
\begin_inset Formula $\tau^{\wedge}\in\mathfrak{g}$
\end_inset

, 
\begin_inset Formula $Ad_{\mathcal{X}}$
\end_inset


\begin_inset Formula $\left(\tau^{\wedge}\right):\mathcal{X}\times\mathfrak{g}\to\mathfrak{g}$
\end_inset

, and is expressed as 
\begin_inset Formula $Ad_{\mathcal{X}}$
\end_inset


\begin_inset Formula $\left(\tau^{\wedge}\right)\in\mathfrak{g}$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathbf{Ad}_{\mathcal{X}}$
\end_inset

 Is the matrix adjoint of the group 
\begin_inset Formula $G$
\end_inset

 at 
\begin_inset Formula $\mathcal{X}$
\end_inset

 operating on 
\begin_inset Formula $\tau\in\mathbb{R}^{n}$
\end_inset

, 
\begin_inset Formula $\mathbf{Ad}_{\mathcal{X}}:\mathcal{X}\times\mathbb{R}^{n}\to\mathbb{R}^{n}$
\end_inset

, and is expressed as 
\begin_inset Formula $\mathbf{Ad}_{\mathcal{X}}\tau\in\mathbb{R}^{n}$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathbf{ad}_{\tau^{\wedge}}$
\end_inset

 Is the matrix adjoint of the Lie algebra.
\end_layout

\begin_layout Itemize
\begin_inset Formula $k^{\pm}$
\end_inset

 Increment or decrement the value of 
\begin_inset Formula $k$
\end_inset

 by 
\begin_inset Formula $1$
\end_inset

.
 e.g.
 
\begin_inset Formula $k^{-}=k-1$
\end_inset

 and 
\begin_inset Formula $k^{+}=k+1$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\left[\theta\right]_{x}$
\end_inset

 The skew symmetric matrix of 
\begin_inset Formula $\theta\in\mathbb{R}^{n}$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathbf{1}$
\end_inset

 The identity element of a group.
\end_layout

\begin_layout Itemize
E
\begin_inset Formula $\left[\cdot\right]$
\end_inset

 The expected value operator.
\end_layout

\begin_layout Section
Problem Statement
\end_layout

\begin_layout Standard
There is a planar robot moving around with a sensor that can detect beacons
 in its environment.
 The beacons, 
\begin_inset Formula $b_{j}$
\end_inset

, are situated at known locations and can always be distinguished when seen
 with the robot's sensor.
 The objective is to use the beacons to localize the robot in the environment
 in the presence of odometry and measurement noise using a Discrete Lie
 Group Extended Kalman Filter (D-LG-EKF).
 
\end_layout

\begin_layout Standard
The robot system model is 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "eq:PS_systemDynamics"

\end_inset


\begin_inset Formula 
\begin{align}
\mathcal{X}_{k} & =\mathcal{X}_{k^{-}}\boxplus\left(u_{k}+w_{k}\right)\\
y_{k,j} & =\mathcal{X}_{k}^{-1}b_{j}+v_{k}
\end{align}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset

where 
\begin_inset Formula $\mathcal{X}\in SE\left(2\right)$
\end_inset

 is the pose of the robot defined as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathcal{X}\triangleq\begin{bmatrix}R_{b}^{i} & P_{r/i}^{i}\\
0 & 1
\end{bmatrix}
\end{equation}

\end_inset

with 
\begin_inset Formula $R\in SO\left(1\right)$
\end_inset

 denoting the rotation from the 
\begin_inset Formula $\mathcal{F}^{b}$
\end_inset

 to the 
\begin_inset Formula $\mathcal{F}^{i}$
\end_inset

 and 
\begin_inset Formula $P_{r/i}^{i}\in\mathbb{R}^{2}$
\end_inset

 denoting the position of the robot w.r.t.
 
\begin_inset Formula $\mathcal{O}^{i}$
\end_inset

 expressed in 
\begin_inset Formula $\mathcal{F}^{i}$
\end_inset

.
 The subscript 
\begin_inset Formula $k$
\end_inset

 denotes the time index.
 The input to the system is denoted as 
\begin_inset Formula $u$
\end_inset

 and is composed of the heading rate 
\begin_inset Formula $\omega_{r/b}^{b}\in\mathbb{R}$
\end_inset

 and linear velocity 
\begin_inset Formula $v_{r/b}^{b}\in\mathbb{R}^{2}$
\end_inset

 such that 
\begin_inset Formula $u_{r/b}^{b}=\delta\left[v_{r/b}^{b},\omega_{r/b}^{b}\right]^{\top}$
\end_inset

 where 
\begin_inset Formula $\delta$
\end_inset

 is the time interval between 
\begin_inset Formula $k$
\end_inset

 and 
\begin_inset Formula $k^{-}$
\end_inset

.
 The output associated with beacon 
\begin_inset Formula $b_{j}$
\end_inset

 at time step 
\begin_inset Formula $k$
\end_inset

 is denoted as 
\begin_inset Formula $y_{k,j}\in\mathbb{R}^{2}$
\end_inset

, and 
\begin_inset Formula $b_{j}\in\mathbb{R}^{2}$
\end_inset

 is the position of the 
\begin_inset Formula $j^{th}$
\end_inset

 beacon in 
\begin_inset Formula $\mathcal{F}^{i}$
\end_inset

 w.r.t.
 
\begin_inset Formula $\mathcal{O}^{i}$
\end_inset

.
 The terms 
\begin_inset Formula $w$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

 are zero mean Gaussian random variables with covariances 
\begin_inset Formula $W$
\end_inset

 and 
\begin_inset Formula $V$
\end_inset

.
 Is is assumed that 
\begin_inset Formula $w$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

 are independent such that 
\begin_inset Formula $\text{E}\left[wv^{\top}\right]=0$
\end_inset

.
\end_layout

\begin_layout Standard
Before we derive the D-LG-EKF we will introduce applicable Lie Group theory.
\end_layout

\begin_layout Section
Lie Group Theory
\end_layout

\begin_layout Standard
This section is not intended to go in depth about Lie Group Theory; rather,
 it will present only the necessary portions of the theory here.
 We refer the reader to 
\begin_inset CommandInset citation
LatexCommand cite
key "Stillwell2008,Sola2018,Barfoot2019"

\end_inset

 which give a more extensive and thorough introduction to Lie Group Theory.
\end_layout

\begin_layout Subsection
Lie Group
\end_layout

\begin_layout Standard
A Lie Group is a set, 
\begin_inset Formula $\mathcal{X}_{n}\in G$
\end_inset

, that contains the identity element, 
\begin_inset Formula $\mathbf{1}$
\end_inset

, and has a binary operator, 
\begin_inset Formula $\left(\cdot\right)$
\end_inset

, with the properties 
\begin_inset Formula 
\begin{align*}
\text{Closure:} & \mathcal{X}_{1}\cdot\mathcal{X}_{2}\in G\\
\text{Associative:} & \mathcal{X}_{1}\cdot\left(\mathcal{X}_{2}\cdot\mathcal{X}_{3}\right)=\left(\mathcal{X}_{1}\cdot\mathcal{X}_{2}\right)\cdot\mathcal{X}_{3}\\
\text{Identity:} & \mathcal{X}\cdot\mathbf{1}=\mathcal{X}\\
\text{Inverse:} & \mathcal{X}^{-1}\cdot\mathcal{X}=\mathbf{1},\,\mathcal{X}^{-1}\in G
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
The common matrix Lie Groups include rotation matrices in 1D and 3D, 
\begin_inset Formula $SO\left(1\right)$
\end_inset

 and 
\begin_inset Formula $SO\left(3\right)$
\end_inset

; unitary quaternions, 
\begin_inset Formula $SU\left(2\right)$
\end_inset

; and rigid-body motion in 2D and 3D, 
\begin_inset Formula $SE\left(2\right)$
\end_inset

 and 
\begin_inset Formula $SE\left(3\right)$
\end_inset

.
 These matrix Lie Groups form a group under multiplication.
 The Lie Group for 
\begin_inset Formula $SE\left(2\right)$
\end_inset

 is 
\begin_inset Formula 
\[
\mathcal{X}\triangleq\begin{bmatrix}R & P\\
0 & 1
\end{bmatrix}
\]

\end_inset

where 
\begin_inset Formula $R\in SO\left(1\right)$
\end_inset

 represents the relative rotation between two frames and 
\begin_inset Formula $P\in\mathbb{R}^{2}$
\end_inset

 is the position of the robot with respect to some origin and frame.
 How 
\begin_inset Formula $R$
\end_inset

 represents the relative rotation between frames depends on how the problem
 is posed.
 For our particular case, we will have 
\begin_inset Formula $R$
\end_inset

 represent the rotation from 
\begin_inset Formula $\mathcal{F}^{b}$
\end_inset

 to 
\begin_inset Formula $\mathcal{F}^{i}$
\end_inset

 and 
\begin_inset Formula $P$
\end_inset

 represent the position of the robot w.r.t.
 
\begin_inset Formula $\mathcal{O}^{i}$
\end_inset

 expressed in 
\begin_inset Formula $\mathcal{F}^{i}$
\end_inset

.
 
\end_layout

\begin_layout Standard
The identity element of 
\begin_inset Formula $SE\left(2\right)$
\end_inset

 is 
\begin_inset Formula 
\[
\mathbf{1}\triangleq\begin{bmatrix}I & 0_{2\times2}\\
0 & 1
\end{bmatrix}
\]

\end_inset

where 
\begin_inset Formula $I$
\end_inset

 is the matrix identity element.
 The inverse element of 
\begin_inset Formula $SE\left(2\right)$
\end_inset

 is 
\begin_inset Formula 
\[
\mathcal{X}^{-1}\triangleq\begin{bmatrix}R^{\top} & -R^{\top}P\\
0 & 1
\end{bmatrix}
\]

\end_inset


\end_layout

\begin_layout Standard
The Lie Group 
\begin_inset Formula $SE\left(2\right)$
\end_inset

 has a corresponding Lie Algebra 
\begin_inset Formula $\mathfrak{se}\left(2\right)$
\end_inset

 which we will derive in the next subsection.
\end_layout

\begin_layout Subsection
Lie Algebra
\begin_inset CommandInset label
LatexCommand label
name "sub:Lie-Algebra"

\end_inset


\end_layout

\begin_layout Standard
The Lie Algebra of a Lie Group is the tangent space of the Lie Group at
 the identity element.
 The Lie Algebra is a vector space, 
\begin_inset Formula $\tau_{n}^{\wedge}\in\mathfrak{g}$
\end_inset

, over the field of real numbers, 
\begin_inset Formula $\mathbb{R},$
\end_inset

 with an additive operation, 
\begin_inset Formula $\left(+\right)$
\end_inset

, scalar multiplication operation, 
\begin_inset Formula $\left(\cdot\right)$
\end_inset

, and Lie Bracket operation, 
\begin_inset Formula $\left(\left[,\right]\right)$
\end_inset

.
 
\end_layout

\begin_layout Standard
The Lie algebra forms a group under addition where 
\begin_inset Formula $0$
\end_inset

 is the identity element and 
\begin_inset Formula $-\tau^{\wedge}$
\end_inset

 is the additive inverse of 
\begin_inset Formula $\tau^{\wedge}$
\end_inset

.
 It's properties are 
\begin_inset Formula 
\begin{align*}
\text{Closure:} & \mathcal{\tau}_{1}^{\wedge}+\tau_{2}^{\wedge}\in\mathfrak{g}\\
\text{Associative:} & \mathcal{\tau}_{1}^{\wedge}+\left(\mathcal{\tau}_{2}^{\wedge}+\tau_{3}^{\wedge}\right)=\left(\mathcal{\tau}_{1}^{\wedge}+\tau_{2}^{\wedge}\right)+\tau_{3}^{\wedge}\\
\text{Identity:} & \mathcal{\tau}^{\wedge}+0=\mathcal{\tau}^{\wedge}\\
\text{Inverse:} & -\mathcal{\mathcal{\tau}^{\wedge}}+\mathcal{\tau}^{\wedge}=0,\,-\mathcal{\mathcal{\tau}^{\wedge}}\in\mathfrak{se}\left(2\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $a_{n}\in\mathbb{R}$
\end_inset

, then the scalar multiplication properties are 
\begin_inset Formula 
\begin{gather*}
a\tau^{\wedge}\in\mathfrak{g}\\
a_{1}\left(a_{2}\tau^{\wedge}\right)=\left(a_{1}a_{2}\right)\tau^{\wedge}\\
\left(a_{1}+a_{2}\right)\tau^{\wedge}=a_{1}\tau^{\wedge}+a_{2}\tau^{\wedge}\\
a\left(\tau_{1}^{\wedge}+\tau_{2}^{\wedge}\right)=a\tau_{1}^{\wedge}+a\tau_{2}^{\wedge}
\end{gather*}

\end_inset


\end_layout

\begin_layout Standard
Lastly we have the Lie Bracket operator defined as 
\begin_inset Formula 
\[
\left[\tau_{1}^{\wedge},\tau_{2}^{\wedge}\right]\triangleq\tau_{1}^{\wedge}\tau_{2}^{\wedge}-\tau_{2}^{\wedge}\tau_{1}^{\wedge}
\]

\end_inset


\end_layout

\begin_layout Standard
The structure for the Lie Algebra is derived by taking the time derivative
 of the constraint 
\begin_inset Formula $\mathcal{X}^{-1}\cdot\mathcal{X}=\mathbf{1}$
\end_inset

 at the identity element which yields 
\begin_inset Formula 
\begin{align}
0 & =\frac{d}{dt}\left(\mathcal{X}^{-1}\cdot\mathcal{X}\right)\\
0 & =\dot{\mathcal{X}}^{-1}\mathcal{X}+\mathcal{X}^{-1}\dot{\mathcal{X}}\label{eq:LA_tangentConstraint}\\
0 & =\dot{\mathcal{X}}^{-1}+\dot{\mathcal{X}}
\end{align}

\end_inset

since 
\begin_inset Formula $\mathcal{X}=\mathbf{1}$
\end_inset

.
 This implies that the Lie Algebra contains elements of the form 
\begin_inset Formula $\dot{\mathcal{X}}$
\end_inset

 that satisfy the constraint 
\begin_inset Formula $0=\dot{\mathcal{X}}^{-1}+\dot{\mathcal{X}}$
\end_inset

.
\end_layout

\begin_layout Standard
We will derive the Lie Algebra for 
\begin_inset Formula $SE\left(2\right)$
\end_inset

 as follows
\begin_inset Formula 
\begin{align}
0 & =\frac{d}{dt}\mathcal{X}^{-1}\mathcal{X}\\
0 & =\dot{\mathcal{X}}^{-1}\mathcal{X}+\mathcal{X}^{-1}\dot{\mathcal{X}}\\
0 & =\begin{bmatrix}\dot{R} & \dot{P}\\
0 & 0
\end{bmatrix}^{-1}\begin{bmatrix}R & P\\
0 & 1
\end{bmatrix}+\begin{bmatrix}R^{\top} & -R^{\top}P\\
0 & 1
\end{bmatrix}\begin{bmatrix}\dot{R} & \dot{P}\\
0 & 0
\end{bmatrix}
\end{align}

\end_inset

since we are evaluating the constraint at the identity, the expression simplifie
s to 
\begin_inset Formula 
\begin{align}
0 & =\begin{bmatrix}\dot{R} & \dot{P}\\
0 & 0
\end{bmatrix}^{-1}\begin{bmatrix}I & 0\\
0 & 1
\end{bmatrix}+\begin{bmatrix}I & 0\\
0 & 1
\end{bmatrix}\begin{bmatrix}\dot{R} & \dot{P}\\
0 & 0
\end{bmatrix}\\
0 & =\begin{bmatrix}\dot{R} & \dot{P}\\
0 & 0
\end{bmatrix}^{-1}+\begin{bmatrix}\dot{R} & \dot{P}\\
0 & 0
\end{bmatrix}
\end{align}

\end_inset

the rotation matrix 
\begin_inset Formula $R$
\end_inset

 can be parametrized by 
\begin_inset Formula $\theta\in\mathbb{R}$
\end_inset

 as 
\begin_inset Formula 
\begin{align}
R & =\begin{bmatrix}\cos t\theta & -\sin t\theta\\
\sin t\theta & \cos t\theta
\end{bmatrix}
\end{align}

\end_inset

taking it's derivative with respect to time yields 
\begin_inset Formula 
\begin{align}
\dot{R} & =\frac{d}{dt}R\\
 & =\frac{d}{dt}\begin{bmatrix}\cos t\theta & -\sin t\theta\\
\sin t\theta & \cos t\theta
\end{bmatrix}\\
 & =\begin{bmatrix}-\theta\sin t\theta & -\theta\cos t\theta\\
\theta\cos t\theta & -\theta\sin t\theta
\end{bmatrix}\\
 & =\begin{bmatrix}\cos t\theta & -\sin t\theta\\
\sin t\theta & \cos t\theta
\end{bmatrix}\begin{bmatrix}0 & -\theta\\
\theta & 0
\end{bmatrix}\\
 & =R\left[\theta\right]_{\times}
\end{align}

\end_inset

substituting the derivative into the constraint and evaluating it at the
 identity element yields 
\begin_inset Formula 
\begin{align}
0 & =\begin{bmatrix}-\left[\theta\right]_{\times} & -\dot{P}\\
0 & 0
\end{bmatrix}+\begin{bmatrix}\left[\theta\right]_{\times} & \dot{P}\\
0 & 0
\end{bmatrix}
\end{align}

\end_inset

thus 
\begin_inset Formula 
\begin{equation}
\tau^{\wedge}\in\mathfrak{se}\left(2\right)\triangleq\begin{bmatrix}\left[\theta\right]_{\times} & \rho\\
0 & 0
\end{bmatrix}
\end{equation}

\end_inset

where 
\begin_inset Formula $\rho=\dot{P}$
\end_inset

.
\end_layout

\begin_layout Standard
As stated before, the Lie Algebra of a group is the tangent plane of the
 group at the identity element.
 In most cases, we will be working with elements of the group that are not
 at identity.
 Fortunately there is an isomorphic transformation between the Lie Algebra
 and the tangent space at any group element.
 This transformation comes from the constraint 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:LA_tangentConstraint"

\end_inset

.
 which is shown again
\begin_inset Formula 
\begin{equation}
0=\dot{\mathcal{X}}^{-1}\mathcal{X}+\mathcal{X}^{-1}\dot{\mathcal{X}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The implications of this constraint can be shown with an example.
 For 
\begin_inset Formula $SE\left(2\right)$
\end_inset

 the constraint is 
\begin_inset Formula 
\begin{equation}
\begin{bmatrix}\dot{R} & \dot{P}\\
0 & 0
\end{bmatrix}^{-1}\begin{bmatrix}R & P\\
0 & 1
\end{bmatrix}=-\begin{bmatrix}R & P\\
0 & 1
\end{bmatrix}^{-1}\begin{bmatrix}\dot{R} & \dot{P}\\
0 & 0
\end{bmatrix}
\end{equation}

\end_inset

expanding the right side term we get 
\begin_inset Formula 
\begin{align}
\begin{bmatrix}R & P\\
0 & 1
\end{bmatrix}^{-1}\begin{bmatrix}\dot{R} & \dot{P}\\
0 & 0
\end{bmatrix} & =\begin{bmatrix}R^{\top} & -R^{\top}P\\
0 & 1
\end{bmatrix}\begin{bmatrix}R\left[\theta\right]_{\times} & \dot{P}\\
0 & 0
\end{bmatrix}\\
 & =\begin{bmatrix}R^{\top}R\left[\theta\right]_{\times} & R^{\top}\dot{P}\\
0 & 0
\end{bmatrix}\\
 & =\begin{bmatrix}\left[\theta\right]_{\times} & R^{\top}\dot{P}\\
0 & 0
\end{bmatrix}\\
 & =\tau^{\wedge}
\end{align}

\end_inset

this implies that 
\begin_inset Formula 
\begin{equation}
\dot{\mathcal{X}}=\mathcal{X}\tau^{\wedge}\label{eq:LA_leftInvariance}
\end{equation}

\end_inset

and 
\begin_inset Formula $\dot{\mathcal{X}}$
\end_inset

 has the same structure as 
\begin_inset Formula $\tau^{\wedge}$
\end_inset

.
 In other words, the tangent space at 
\begin_inset Formula $\mathcal{X}\neq\mathbf{1}$
\end_inset

 has the same structure as the tangent space at the identity element of
 the group.
 Bourmaud refers to this as left invariance since the Lie algebra multiplied
 by an element of the Lie Group yields a space with the same structure as
 the Lie algebra.
 
\end_layout

\begin_layout Subsection
Exponential and Logarithmic Maps
\end_layout

\begin_layout Standard
The exponential matrix maps elements in the tangent space of a Lie group
 onto the Lie group
\begin_inset Formula 
\begin{equation}
\exp\left(\mathfrak{g}\right)\in G
\end{equation}

\end_inset

this is easily seen from 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:LA_leftInvariance"

\end_inset

 which is a differential equation whose solution is 
\begin_inset Formula 
\begin{equation}
\mathcal{X}\left(t\right)=\mathcal{X}\left(0\right)\exp\left(\delta\tau^{\wedge}\right)\in G
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta$
\end_inset

 represents the time interval.
\end_layout

\begin_layout Standard
The inverse of the exponential map is the natural logarithmic map that maps
 elements from the Lie group onto the tangent space of the Lie group
\begin_inset Formula 
\begin{equation}
\log\left(G\right)\in\mathfrak{g}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Depending on the Lie Group, these mappings can have simplified alternate
 forms.
 For example, the mappings for 
\begin_inset Formula $SE\left(2\right)$
\end_inset

 are 
\begin_inset Formula 
\begin{align}
\mathcal{X} & =\exp\left(\tau^{\wedge}\right)=\begin{bmatrix}\exp\left(\left[\theta\right]_{\times}\right) & V\left(\theta\right)\rho\\
0 & 1
\end{bmatrix}\\
\tau^{\wedge} & =\log\left(\mathcal{X}\right)=\begin{bmatrix}\log\left(R\right) & V^{-1}\left(\theta\right)\rho\\
0 & 0
\end{bmatrix}\\
V\left(\theta\right) & =\frac{\sin\left(\theta\right)}{\theta}I+\frac{1-\cos\theta}{\theta}\left[1\right]_{\times}
\end{align}

\end_inset


\end_layout

\begin_layout Subsection
Isomorphic Cartesian Vector Space
\end_layout

\begin_layout Standard
The elements of a Lie algebra are not necessarily a minimal representation.
 For example, 
\begin_inset Formula $\mathfrak{se}\left(2\right)$
\end_inset

, consists of 
\begin_inset Formula $3\times3$
\end_inset

 matrices where each matrix is completely defined by three variables, 
\begin_inset Formula $\rho\in\mathbb{R}^{2}$
\end_inset

, and 
\begin_inset Formula $\theta\in\mathbb{R}$
\end_inset

.
 These minimal representations are vectors with isomorphic transformations
 between the Lie algebra and the Cartesian vector space
\begin_inset CommandInset citation
LatexCommand cite
key "Sola2018"

\end_inset

.
 We transform elements of 
\begin_inset Formula $\mathfrak{g}\to\mathbb{R}^{n}$
\end_inset

 using the 
\begin_inset Formula $\left(\vee\right)$
\end_inset

 operator and the inverse operation is performed using the 
\begin_inset Formula $\left(\wedge\right)$
\end_inset

 operator such that 
\begin_inset Formula 
\begin{align}
\left(\wedge\right):\mathbb{R}^{n}\to\mathfrak{g}; & \hfill\left(\tau\right)^{\wedge}=\tau^{\wedge}\in\mathfrak{g}\\
\left(\vee\right):\mathfrak{g}\to\mathbb{R}^{n}; & \hfill\left(\tau^{\wedge}\right)^{\vee}=\tau\in\mathbb{R}^{n}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
For 
\begin_inset Formula $\mathfrak{se}\left(2\right)$
\end_inset

, these operations are defined as 
\begin_inset Formula 
\begin{align}
\tau^{\wedge} & =\begin{bmatrix}\left[\theta\right]_{\times} & \rho\\
0 & 0
\end{bmatrix}\\
\left(\tau^{\wedge}\right)^{\vee} & =\tau=\begin{bmatrix}\rho\\
\theta
\end{bmatrix}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
The Cartesian vector space representation of the Lie algebra will play an
 important part which will be shown later.
 
\end_layout

\begin_layout Subsection
Plus and Minus Operators
\end_layout

\begin_layout Standard
Now that we have introduced Lie groups with their respective Lie algebra
 and Cartesian vector space, we are ready to present the plus and minus
 operators.
 The plus and minus operators are defined for right and left operations.
 We first present the box plus and minus where are between elements of the
 Lie group and the corresponding Cartesian vector space.
 
\begin_inset Formula 
\begin{align*}
\text{right}-\boxplus:G\times\mathbb{R}^{n}\to\mathbb{R}^{n}\quad; & \mathcal{X}_{1}=\mathcal{X}_{2}\boxplus\tau\triangleq\mathcal{X}_{2}\exp\left(\tau^{\wedge}\right)\in G\\
\text{right}-\boxminus:G\times G\to\mathbb{R}^{n}\quad\:\,; & \tau=\mathcal{X}_{1}\boxminus\mathcal{X}_{2}\triangleq\log\left(\mathcal{X}_{2}^{-1}\mathcal{X}_{1}\right)^{\vee}\in\mathbb{R}^{n}\\
\text{left}-\boxplus:G\times\mathbb{R}^{n}\to\mathbb{R}^{n}\quad; & \mathcal{X}_{1}=\tau\boxplus\mathcal{X}_{2}\triangleq\mathcal{X}_{2}\exp\left(\tau^{\wedge}\right)\in G\\
\text{left}-\boxminus:G\times G\to\mathbb{R}^{n}\quad\:\,; & \tau=\mathcal{X}_{1}\boxminus\mathcal{X}_{2}\triangleq\log\left(\mathcal{X}_{1}^{-1}\mathcal{X}_{2}\right)^{\vee}\in\mathbb{R}^{n}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
The circle plus and minus operations are between elements of the Lie group
 and the corresponding Lie algebra.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\text{right}-\oplus:G\times\mathfrak{g}\to\mathfrak{g}\qquad; & \mathcal{X}_{1}=\mathcal{X}_{2}\oplus\tau^{\wedge}\triangleq\mathcal{X}_{2}\exp\left(\tau^{\wedge}\right)\in G\\
\text{right}-\ominus:G\times G\to\mathfrak{g}\qquad; & \tau^{\wedge}=\mathcal{X}_{1}\ominus\mathcal{X}_{2}\triangleq\log\left(\mathcal{X}_{2}^{-1}\mathcal{X}_{1}\right)\in\mathfrak{g}\\
\text{left}-\oplus:G\times\mathfrak{g}\to\mathfrak{g}\qquad\quad; & \mathcal{X}_{1}=\tau^{\wedge}\oplus\mathcal{X}_{2}\triangleq\mathcal{X}_{2}\exp\left(\tau^{\wedge}\right)\in G\\
\text{left}-\ominus:G\times G\to\mathfrak{g}\qquad\quad; & \tau^{\wedge}=\mathcal{X}_{1}\ominus\mathcal{X}_{2}\triangleq\log\left(\mathcal{X}_{1}^{-1}\mathcal{X}_{2}\right)\in\mathfrak{g}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
The left and right operations of the plus operator can be distinguished
 by the order of the operand; however, the left and right operations of
 the minus operator is ambiguous and needs to be specified.
 In this paper we will default to using only the right operator.
 
\end_layout

\begin_layout Subsection
Adjoint
\begin_inset CommandInset label
LatexCommand label
name "sub:Adjoint"

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\mathcal{X}_{1}=\mathcal{X}_{2}\oplus\tau_{1}^{\wedge}$
\end_inset

 and 
\begin_inset Formula $\mathcal{X}_{1}=\tau_{2}^{\wedge}\oplus\mathcal{X}_{2}$
\end_inset

.
 The adjoint relates 
\begin_inset Formula $\tau_{1}^{\wedge}$
\end_inset

 and 
\begin_inset Formula $\tau_{2}^{\wedge}$
\end_inset

 and is found by equating the equations
\begin_inset Formula 
\begin{align}
\mathcal{X}_{2}\oplus\tau_{1}^{\wedge} & =\tau_{2}^{\wedge}\oplus\mathcal{X}_{2}\\
\mathcal{X}_{2}\exp\left(\tau_{1}^{\wedge}\right) & =\exp\left(\tau_{2}^{\wedge}\right)\mathcal{X}_{2}\\
\mathcal{X}_{2}\exp\left(\tau_{1}^{\wedge}\right)\mathcal{X}_{2}^{-1} & =\exp\left(\tau_{2}^{\wedge}\right)\\
\exp\left(\mathcal{X}_{2}\tau_{1}^{\wedge}\mathcal{X}_{2}^{-1}\right) & =\exp\left(\tau_{2}^{\wedge}\right)\\
\mathcal{X}_{2}\tau_{1}^{\wedge}\mathcal{X}_{2}^{-1} & =\tau_{2}^{\wedge}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
We thus define the adjoint of the Lie group at 
\begin_inset Formula $\mathcal{X}$
\end_inset

 to be 
\begin_inset Formula $Ad_{\mathcal{X}}$
\end_inset


\begin_inset Formula 
\begin{equation}
Ad_{\mathcal{X}}:\mathfrak{g}\to\mathfrak{g};\quad Ad_{\mathcal{X}}\left(\tau^{\wedge}\right)\triangleq\mathcal{X}\tau^{\wedge}\mathcal{X}^{-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
There is an equivalent matrix adjoint of a Lie group that operates on elements
 of the Cartesian vector space.
 We define it at 
\begin_inset Formula $\mathcal{X}$
\end_inset

 to be 
\begin_inset Formula $\mathbf{Ad}_{\mathcal{X}}$
\end_inset


\begin_inset Formula 
\begin{equation}
\mathbf{Ad}_{\mathcal{X}}:\mathbb{R}^{n}\to\mathbb{R}^{n};\quad\mathbf{Ad}_{\mathcal{X}}\left(\tau\right)\triangleq\mathbf{Ad}_{\mathcal{X}}\tau
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The matrix adjoint of a Lie group is a Lie group with it's own corresponding
 Lie algebra and Cartesian vector space.
 Barfoot 
\begin_inset CommandInset citation
LatexCommand cite
key "Barfoot2019"

\end_inset

 refers to the Lie algebra of the matrix adjoint the matrix adjoint of an
 element of 
\begin_inset Formula $\mathfrak{g}$
\end_inset

.
 And 
\begin_inset Formula $\mathfrak{g}$
\end_inset

 is isomorphic to the matrix adjoint of an element of 
\begin_inset Formula $\mathfrak{g}$
\end_inset

.
 
\end_layout

\begin_layout Standard
To explain in more detail, let 
\begin_inset Formula $\mathbf{Ad}\left(G\right)$
\end_inset

 denote the matrix adjoint group of the Lie group 
\begin_inset Formula $G$
\end_inset

, 
\begin_inset Formula $\Xi\in\mathbf{Ad}\left(G\right)$
\end_inset

, 
\begin_inset Formula $\mathbf{ad}\left(\mathfrak{g}\right)$
\end_inset

 denote the Lie algebra of 
\begin_inset Formula $\mathbf{Ad}\left(G\right)$
\end_inset

 and let 
\begin_inset Formula $\xi\in\mathbf{ad}\left(\mathfrak{g}\right)$
\end_inset

, then we have the relations
\begin_inset Formula 
\begin{gather}
\exp:\mathbf{ad}\left(\mathfrak{g}\right)\to\mathbf{Ad}\left(G\right)\\
\log:\mathbf{Ad}\left(G\right)\to\mathbf{ad}\left(\mathfrak{g}\right)\\
\left(\curlywedge\right):\mathfrak{g}\to\mathbf{ad}\left(\mathfrak{g}\right)\\
\left(\curlyvee\right):\mathbf{ad}\left(\mathfrak{g}\right)\to\mathfrak{g}
\end{gather}

\end_inset

where the operators 
\begin_inset Formula $\left(\curlywedge\right)$
\end_inset

 and 
\begin_inset Formula $\left(\curlyvee\right)$
\end_inset

 map elements between 
\begin_inset Formula $\mathfrak{g}$
\end_inset

 and 
\begin_inset Formula $\mathbf{ad}\left(\mathfrak{g}\right)$
\end_inset

.
 Another way to view the mapping is shown below 
\begin_inset Formula 
\begin{align*}
\tau^{\wedge}\in\mathfrak{se}\left(3\right) & \quad\underset{\to}{\exp}\quad\chi\in SE\left(3\right)\\
\downarrow ad & \quad\quad\quad\quad\downarrow Ad\\
\tau^{\curlywedge}\in\mathbf{ad}\left(\mathfrak{se}\left(3\right)\right) & \quad\underset{\to}{\exp}\quad\mathrm{\chi}^{\curlywedge}\in\mathbf{Ad}\left(SE\left(3\right)\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
The Lie algebra of the matrix adjoint allows us to simplify the Lie bracket
 of the Lie algebra of the original Lie group.
 
\begin_inset Formula 
\begin{equation}
\left[\tau_{1}^{\wedge},\tau_{2}^{\wedge}\right]^{\vee}=\tau_{1}^{\curlywedge}\tau_{2}
\end{equation}

\end_inset

this property will be used when deriving the left and right Jacobians of
 a Lie group.
\end_layout

\begin_layout Standard
To solidify this subsection we give the example of the adjoints of 
\begin_inset Formula $SE\left(2\right)$
\end_inset

.
 Let 
\begin_inset Formula $\mathcal{X}_{n}\in SE\left(2\right)$
\end_inset

, 
\begin_inset Formula $\tau_{n}^{\wedge}\in\mathfrak{se}\left(2\right)$
\end_inset

, 
\begin_inset Formula $\Xi_{n}\in\mathbf{Ad}\left(SE\left(2\right)\right)$
\end_inset

, and 
\begin_inset Formula $\xi_{n}\in\mathbf{ad}\left(\mathfrak{g}\right)$
\end_inset

 then 
\begin_inset Formula $Ad_{\mathcal{X}_{1}}$
\end_inset

 is 
\begin_inset Formula 
\begin{equation}
Ad_{\mathcal{X}}\left(\tau^{\wedge}\right)\triangleq\mathcal{X}\tau^{\wedge}\mathcal{X}^{-1}\label{eq:Adjoint_adjointSE2}
\end{equation}

\end_inset

we form the matrix adjoint 
\begin_inset Formula $\mathbf{Ad}_{\mathcal{X}}$
\end_inset

 by rearranging 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Adjoint_adjointSE2"

\end_inset

 as such 
\begin_inset Formula 
\begin{gather}
\left(\begin{bmatrix}R & P\\
0 & 1
\end{bmatrix}\begin{bmatrix}\left[\theta\right]_{\times} & \rho\\
0 & 0
\end{bmatrix}\begin{bmatrix}R^{\top} & -R^{\top}P\\
0 & 1
\end{bmatrix}\right)^{\vee}\\
\left(\begin{bmatrix}R\left[\theta\right]_{\times} & R\rho\\
0 & 0
\end{bmatrix}\begin{bmatrix}R^{\top} & -R^{\top}P\\
0 & 1
\end{bmatrix}\right)^{\vee}\\
\left(\begin{bmatrix}R\left[\theta\right]_{\times}R^{\top} & -R\left[\theta\right]_{\times}R^{\top}P+R\rho\\
0 & 0
\end{bmatrix}\right)^{\vee}\\
\left(\begin{bmatrix}\left[\theta\right]_{\times} & -\left[\theta\right]_{\times}P+R\rho\\
0 & 0
\end{bmatrix}\right)^{\vee}\\
\left(\begin{bmatrix}\left[1\right]_{\times}\theta & -\left[1\right]_{\times}\theta P+R\rho\\
0 & 0
\end{bmatrix}\right)^{\vee}\\
\begin{bmatrix}-\left[1\right]_{\times}\theta P+R\rho\\
\left[1\right]_{\times}\theta
\end{bmatrix}\\
\begin{bmatrix}R & -\left[1\right]_{\times}P\\
0 & 1
\end{bmatrix}\begin{bmatrix}\rho\\
\theta
\end{bmatrix}
\end{gather}

\end_inset

which gives us 
\begin_inset Formula 
\begin{equation}
\mathbf{Ad}_{\mathcal{X}}=\begin{bmatrix}R & -\left[1\right]_{\times}P\\
0 & 1
\end{bmatrix}\label{eq:Adjoint_matrixAdjointSE2}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
By inspection you can see that the matrix adjoint has the same structure
 of 
\begin_inset Formula $SE\left(2\right)$
\end_inset

, and thus 
\begin_inset Formula $\mathbf{Ad}\left(SE\left(2\right)\right)$
\end_inset

 is also a Lie group.
 This implies that the matrix adjoint has a corresponding Lie algebra which
 will derive in the same way shown in subsection 
\begin_inset CommandInset ref
LatexCommand eqref
reference "sub:Lie-Algebra"

\end_inset

.
\end_layout

\begin_layout Standard
We being using the constraint 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:LA_tangentConstraint"

\end_inset

 to get 
\begin_inset Formula 
\begin{equation}
\Xi^{-1}\dot{\Xi}=-\dot{\Xi}^{-1}\Xi
\end{equation}

\end_inset

working with the left hand side we get 
\begin_inset Formula 
\begin{multline*}
\begin{bmatrix}R & -\left[1\right]_{\times}P\\
0 & 1
\end{bmatrix}^{-1}\frac{d}{dt}\begin{bmatrix}R & -\left[1\right]_{\times}P\\
0 & 1
\end{bmatrix}\\
\begin{bmatrix}R^{\top} & R^{\top}\left[1\right]_{\times}P\\
0 & 1
\end{bmatrix}\begin{bmatrix}R\left[\theta\right]_{\times} & -\left[1\right]_{\times}\dot{P}\\
0 & 0
\end{bmatrix}\\
\begin{bmatrix}\left[\theta\right]_{\times} & -R^{\top}\left[1\right]_{\times}\dot{P}\\
0 & 0
\end{bmatrix}
\end{multline*}

\end_inset

evaluating the expression at identity yields 
\begin_inset Formula 
\begin{equation}
\xi\triangleq\begin{bmatrix}\left[\theta\right]_{\times} & -\left[1\right]_{\times}\rho\\
0 & 0
\end{bmatrix}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
By inspection you can see that the Lie algebra of the matrix adjoint has
 the same structure of 
\begin_inset Formula $\mathfrak{se}\left(2\right)$
\end_inset

, and that 
\begin_inset Formula $\mathbf{ad}\left(\mathfrak{se}\left(2\right)\right)$
\end_inset

 is isomorphic to 
\begin_inset Formula $\mathfrak{se}\left(2\right)$
\end_inset

.
 The last thing we will show is that 
\begin_inset Formula 
\begin{equation}
\left[\tau_{1}^{\wedge},\tau_{2}^{\wedge}\right]^{\vee}=\tau_{1}^{\curlywedge}\tau_{2}
\end{equation}

\end_inset

we begin with the left hand side 
\begin_inset Formula 
\begin{align}
\left[\tau_{1}^{\wedge},\tau_{2}^{\wedge}\right]^{\vee} & =\left(\begin{bmatrix}\left[\theta_{1}\right]_{\times} & \rho_{1}\\
0 & 0
\end{bmatrix}\begin{bmatrix}\left[\theta_{2}\right]_{\times} & \rho_{2}\\
0 & 0
\end{bmatrix}-\begin{bmatrix}\left[\theta_{2}\right]_{\times} & \rho_{2}\\
0 & 0
\end{bmatrix}\begin{bmatrix}\left[\theta_{1}\right]_{\times} & \rho_{1}\\
0 & 0
\end{bmatrix}\right)^{\vee}\\
 & =\left(\begin{bmatrix}\left[\theta_{1}\right]_{\times}\left[\theta_{2}\right]_{\times} & \left[\theta_{1}\right]_{\times}\rho_{2}\\
0 & 0
\end{bmatrix}-\begin{bmatrix}\left[\theta_{2}\right]_{\times}\left[\theta_{1}\right]_{\times} & \left[\theta_{2}\right]_{\times}\rho_{1}\\
0 & 0
\end{bmatrix}\right)^{\vee}\\
 & =\left(\begin{bmatrix}0 & \left[\theta_{1}\right]_{\times}\rho_{2}-\left[\theta_{2}\right]_{\times}\rho_{1}\\
0 & 0
\end{bmatrix}\right)^{\vee}\\
 & =\begin{bmatrix}\left[\theta_{1}\right]_{\times}\rho_{2}-\left[\theta_{2}\right]_{\times}\rho_{1}\\
0
\end{bmatrix}
\end{align}

\end_inset

now we expand the right hand side 
\begin_inset Formula 
\begin{align*}
\tau_{1}^{\curlyvee}\tau_{2} & =\begin{bmatrix}\left[\theta_{1}\right]_{\times} & -\left[1\right]_{\times}\rho_{1}\\
0 & 0
\end{bmatrix}\begin{bmatrix}\rho_{2}\\
\theta_{2}
\end{bmatrix}\\
 & =\begin{bmatrix}\left[\theta_{1}\right]_{\times}\rho_{2}-\left[\theta_{2}\right]_{\times}\rho_{1}\\
0
\end{bmatrix}
\end{align*}

\end_inset

which proves 
\begin_inset Formula 
\begin{equation}
\left[\tau_{1}^{\wedge},\tau_{2}^{\wedge}\right]^{\vee}=\tau_{1}^{\curlywedge}\tau_{2}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Repeating the same process for nested Lie brackets we can also show that
 
\begin_inset Formula 
\begin{equation}
\left[\underbrace{\tau_{1}^{\wedge},\ldots}_{n-1}\left[\tau_{1}^{\wedge},\tau_{2}^{\wedge}\right]\right]^{\vee}=\left(\tau_{1}^{\curlywedge}\right)^{n}\tau_{2}
\end{equation}

\end_inset

with 
\begin_inset Formula $\underbrace{\tau_{1}^{\wedge},\ldots}_{n-1}$
\end_inset

 representing 
\begin_inset Formula $n-1$
\end_inset

 nested Lie brackets.
 For example if 
\begin_inset Formula $n=3$
\end_inset

 it would be 
\begin_inset Formula 
\begin{equation}
\left[\tau_{1}^{\wedge},\left[\tau_{1}^{\wedge},\left[\tau_{1}^{\wedge},\tau_{2}^{\wedge}\right]\right]\right]
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Jacobians
\end_layout

\begin_layout Standard
Sola in 
\begin_inset CommandInset citation
LatexCommand cite
key "Sola2018"

\end_inset

 provides a great overview of taking derivatives on Lie Groups.
 I will simply cover the basic convention needed for this paper.
 The first order partial derivative of a function is the Jacobian and is
 defined as 
\begin_inset Formula 
\begin{equation}
J=\frac{\partial f\left(x\right)}{\partial x}\triangleq\lim_{h\to0}\frac{f\left(x+h\right)-f\left(x\right)}{h}\label{eq:Derivatives_Jacobian}
\end{equation}

\end_inset

For a multivariate function 
\begin_inset Formula $f:\mathbb{R}^{n}\to\mathbb{R}^{m}$
\end_inset

 the Jacobian becomes a matrix of the form 
\begin_inset Formula 
\begin{equation}
J=\frac{\partial f\left(x\right)}{\partial x}=\begin{bmatrix}\frac{\partial f_{1}}{\partial x_{1}} & \cdots & \frac{\partial f_{1}}{\partial x_{n}}\\
\vdots & \ddots & \vdots\\
\frac{\partial f_{m}}{\partial x_{1}} & \cdots & \frac{\partial f_{m}}{\partial x_{n}}
\end{bmatrix}
\end{equation}

\end_inset

where each component is 
\begin_inset Formula 
\begin{equation}
\frac{\partial f_{m}}{\partial x_{n}}=\lim_{h\to0}e_{m}\left(\frac{f\left(x+e_{n}h\right)-f\left(x\right)}{h}\right)
\end{equation}

\end_inset

where 
\begin_inset Formula $e_{n}$
\end_inset

 is the 
\begin_inset Formula $n^{th}$
\end_inset

 vector of the basis of 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $e_{m}$
\end_inset

 is the 
\begin_inset Formula $m^{th}$
\end_inset

 vector of the basis of 
\begin_inset Formula $f\left(x\right)$
\end_inset

.
 The Jacobian can be written in a compact form for convenience.
 Let 
\begin_inset Formula $j_{i}=\left[\frac{\partial f_{1}}{\partial x_{i}},\ldots,\frac{\partial f_{m}}{\partial x_{i}}\right]^{\top}$
\end_inset

 be the 
\begin_inset Formula $i^{th}$
\end_inset

 column of 
\begin_inset Formula $J$
\end_inset

 so that 
\begin_inset Formula $J=\left[j_{1},\ldots,j_{n}\right]$
\end_inset

.
 Each column of 
\begin_inset Formula $J$
\end_inset

 is defined as 
\begin_inset Formula 
\begin{equation}
j_{i}\triangleq\lim_{h\to0}\left(\frac{f\left(x+e_{n}h\right)-f\left(x\right)}{h}\right)
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Then let 
\begin_inset Formula 
\begin{equation}
J=\frac{\partial f\left(x\right)}{\partial x}\triangleq\lim_{h\to0}\frac{f\left(x+h\right)-f\left(x\right)}{h}
\end{equation}

\end_inset

be the compact Jacobian form which infers taking partial derivatives of
 
\begin_inset Formula $f\left(x\right)$
\end_inset

 with respect to 
\begin_inset Formula $x$
\end_inset

 for every 
\begin_inset Formula $x_{i}$
\end_inset

 to form 
\begin_inset Formula $j_{i}$
\end_inset

, and then aggregate them together.
 In other words
\begin_inset Formula 
\begin{align}
J=\frac{\partial f\left(x\right)}{\partial x} & \triangleq\lim_{h\to0}\frac{f\left(x+h\right)-f\left(x\right)}{h}\\
 & \triangleq\begin{bmatrix}\lim_{h\to0}\left(\frac{f\left(x+e_{1}h\right)-f\left(x\right)}{h}\right) & \lim_{h\to0}\left(\frac{f\left(x+e_{2}h\right)-f\left(x\right)}{h}\right) & \cdots & \lim_{h\to0}\left(\frac{f\left(x+e_{n}h\right)-f\left(x\right)}{h}\right)\end{bmatrix}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
When taking Jacobians on Lie groups, there is a left and right Jacobian.
 Since we will only work with the right Jacobian, we will not define the
 left Jacobian.
 The right Jacobian of a Lie group is defined as, using the compact form,
 
\begin_inset Formula 
\begin{equation}
J=\frac{\partial f\left(x\right)}{\partial x}\triangleq\lim_{\tau\to0}\frac{f\left(x\boxplus\tau\right)\boxminus f\left(x\right)}{\tau}\label{eq:Derivatives_lieGroupJacobian}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Note that the right Jacobian is defined with respect to the Cartesian vector
 space representation of the Lie algebra.
 This allows us to represent the Jacobian in a minimal form.
 
\end_layout

\begin_layout Standard
The final notation for Jacobian is 
\begin_inset Formula 
\begin{equation}
J_{x_{i}}^{f\left(x_{1},x_{2},\ldots,x_{n}\right)}=\frac{\partial f\left(x_{1},x_{2},\ldots,x_{n}\right)}{\partial x_{i}}
\end{equation}

\end_inset

where 
\begin_inset Formula $x_{i}$
\end_inset

 is a vector that can correspond to states, input, etc,
\end_layout

\begin_layout Subsection
Taylor Series Expansion 
\begin_inset CommandInset label
LatexCommand label
name "sub:Taylor-Series-Expansion"

\end_inset


\end_layout

\begin_layout Standard
When working with Lie groups, you will often need to calculate their Taylor
 series expansion.
 Since we work with right Jacobians, we will only present the right Taylor
 series expansion.
 The Taylor series of a real or complex-valued function that is infinitely
 differentiable at 
\begin_inset Formula $x$
\end_inset

 is 
\begin_inset Formula 
\begin{equation}
f\left(x+h\right)=\sum_{n=0}^{\infty}\frac{f^{n}\left(x\right)}{n!}h^{n}
\end{equation}

\end_inset

where 
\begin_inset Formula $f^{n}$
\end_inset

 denotes the 
\begin_inset Formula $n^{th}$
\end_inset

 partial derivative of 
\begin_inset Formula $f$
\end_inset

 w.r.t.
 
\begin_inset Formula $x$
\end_inset

.
 For Lie groups, the Taylor series expansion is slightly different since
 the Jacobians are taken w.r.t.
 the Cartesian vector space.
 To give you an idea, we will look at the definition of the Jacobian which
 is the first partial derivative of a function.
 
\begin_inset Formula 
\begin{align}
\frac{\partial f\left(\mathcal{X}\right)}{\partial x} & =\lim_{\tau\to0}\frac{f\left(\mathcal{X}\boxplus\tau\right)\boxminus f\left(\mathcal{X}\right)}{\tau}
\end{align}

\end_inset

dropping the limit and assuming 
\begin_inset Formula $\tau$
\end_inset

 to be small we get 
\begin_inset Formula 
\begin{align}
\frac{\partial f\left(\mathcal{X}\right)}{\partial\mathcal{X}}\tau & \approx f\left(\mathcal{X}\boxplus\tau\right)\boxminus f\left(\mathcal{X}\right)\\
\frac{\partial f\left(x\right)}{\partial x}\tau & \approx\log\left(f\left(\mathcal{X}\right)^{-1}f\left(\mathcal{X}\boxplus\tau\right)\right)^{\vee}\\
\exp\left(\left(\frac{\partial f\left(\mathcal{X}\right)}{\partial\mathcal{X}}\tau\right)^{\wedge}\right) & \approx f\left(\mathcal{X}\right)^{-1}f\left(\mathcal{X}\boxplus\tau\right)\\
f\left(\mathcal{X}\right)\exp\left(\left(\frac{\partial f\left(\mathcal{X}\right)}{\partial\mathcal{X}}\tau\right)^{\wedge}\right) & \approx f\left(\mathcal{X}\boxplus\tau\right)\\
f\left(\mathcal{X}\right)\boxplus\left(\frac{\partial f\left(\mathcal{X}\right)}{\partial x}\tau\right) & \approx f\left(\mathcal{X}\boxplus\tau\right)
\end{align}

\end_inset

notice that the perturbation, 
\begin_inset Formula $\frac{\partial f\left(x\right)}{\partial x}\tau$
\end_inset

, is in the Cartesian vector space.
 Taking this idea and incorporating it into the Taylor series expansion
 we get
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "eq:TaylorSeries_generic"

\end_inset

 
\begin_inset Formula 
\begin{align}
f\left(\mathcal{X}\boxplus\tau\right) & =f\left(\mathcal{X}\right)\boxplus\left(\sum_{n=1}^{\infty}\frac{f^{n}\left(\mathcal{X}\right)}{n!}\tau^{n}\right)\\
 & =f\left(\mathcal{X}\right)\boxplus\left(\frac{\partial f\left(\mathcal{X}\right)}{\partial\mathcal{X}}\tau+\tau^{\top}\frac{\partial^{2}f\left(\mathcal{X}\right)}{\partial\mathcal{X}^{2}}\tau\cdots\right)\\
 & \approx f\left(\mathcal{X}\right)\boxplus\left(\frac{\partial f\left(\mathcal{X}\right)}{\partial\mathcal{X}}\tau\right)
\end{align}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
Since the mapping between the Lie group and Lie algebra involves the exponential
 and logarithmic maps, we will use their Taylor series which are 
\begin_inset Formula 
\begin{align}
\exp\left(x\right) & =\sum_{n=0}^{\infty}\frac{x^{n}}{n!}\label{eq:TaylorSeries_exponential}\\
\log\left(\mathbf{1}-x\right) & =-\sum_{n=1}^{\infty}\frac{x}{n!}^{n}\\
\log\left(x\right) & =-\sum_{n=1}^{\infty}\frac{\left(\mathbf{1}-x\right)}{n!}^{n}\label{eq:TaylorSeries_log}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
The Taylor series of the exponential matrix can be linearized when 
\begin_inset Formula $x$
\end_inset

 is small.
 This linearization is 
\begin_inset Formula 
\begin{equation}
\exp\left(x\right)\approx1+x
\end{equation}

\end_inset

for Lie groups it is 
\begin_inset Formula 
\begin{equation}
\exp\left(\tau^{\wedge}\right)\approx\mathbf{1}+\tau^{\wedge}\label{eq:TaylorSeries_expLinearized}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Group Action
\end_layout

\begin_layout Standard
The group action describes how a Lie group interacts with another group
 under a specified operator.
 For example, let 
\begin_inset Formula $G_{1}$
\end_inset

 and 
\begin_inset Formula $G_{2}$
\end_inset

 be other groups, not necessarily Lie groups, and let 
\begin_inset Formula $G$
\end_inset

 still denote a Lie group.
 The group action is 
\begin_inset Formula 
\begin{equation}
\left(\cdot\right):G\times G_{1}\to G_{2}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For matrix Lie groups, the group action is often with vectors or groups
 defined in 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

 with an operator similar to multiplication.
 For example, let 
\begin_inset Formula $r_{1}\in\mathbb{R}^{n}$
\end_inset

 and 
\begin_inset Formula $r_{2}\in\mathbb{R}^{m}$
\end_inset

 then 
\begin_inset Formula 
\begin{equation}
\mathcal{X}\cdot r_{1}=r_{2}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
With group actions, there are also Jacobians defined as 
\begin_inset Formula 
\begin{align}
J_{\mathcal{X}}^{\mathcal{X}\cdot r_{1}} & =\lim_{\tau\to0}\frac{f\left(\mathcal{X}\boxplus\tau\right)\cdot r-f\left(\mathcal{X}\right)\cdot r}{\tau}\\
J_{r_{1}}^{\mathcal{X}\cdot r_{1}} & =\lim_{h\to0}\frac{f\left(\mathcal{X}\right)\cdot\left(r+h\right)-f\left(\mathcal{X}\right)\cdot r}{h}
\end{align}

\end_inset

where 
\begin_inset Formula $r$
\end_inset

 is an element of a group under the addition operation.
 You can see that it is impossible to be specific about the group action
 since it depends on the groups involved.
 Because of this, we leave this subsection vague and end with the example
 of 
\begin_inset Formula $SE\left(2\right)$
\end_inset

 with the group action on 
\begin_inset Formula $\mathbb{R}^{2}$
\end_inset

 and operator 
\begin_inset Formula $\left(\cdot\right)$
\end_inset

.
 
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $p\in\mathbb{R}^{2}$
\end_inset

 represent a point in Cartesian coordinates, then 
\begin_inset Formula 
\begin{equation}
\mathcal{X}\cdot p\triangleq Rp+P
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\mathcal{X}=\begin{bmatrix}R & P\\
0 & 1
\end{bmatrix}
\end{equation}

\end_inset

and the Jacobian w.r.t.
 the Lie group is 
\begin_inset Formula 
\begin{equation}
J_{\mathcal{X}}^{\mathcal{X}\cdot p}\triangleq\lim_{\tau\to0}\frac{f\left(\mathcal{X}\boxplus\tau\right)\cdot p-f\left(\mathcal{X}\right)\cdot p}{\tau}
\end{equation}

\end_inset

which is a 
\begin_inset Formula $2\times3$
\end_inset

 matrix that maps small changes in the Lie algebra to small changes in the
 output of the group action.
 
\end_layout

\begin_layout Section
Baker-Campbell-Hausdorff
\begin_inset CommandInset label
LatexCommand label
name "sec:Baker-Campbell-Hausdorff"

\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "Barfoot2019"

\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "Michael2019"

\end_inset


\end_layout

\begin_layout Standard
Since we work with the exponential function we need to understand how they
 commute.
 For example we can easily combine two scalar exponential functions as follows:
\begin_inset Formula 
\begin{equation}
\exp\left(a\right)\exp\left(b\right)=\exp\left(a+b\right)
\end{equation}

\end_inset

where 
\begin_inset Formula $a,b\in\mathbb{R}$
\end_inset

.
 However, this is not the case for matrices that do not commute, i.e.
 let 
\begin_inset Formula $A,B\in\mathfrak{g},\quad AB\neq BA$
\end_inset

, where 
\begin_inset Formula $\mathfrak{g}$
\end_inset

 is a matrix Lie algebra, then 
\begin_inset Formula 
\begin{equation}
\exp\left(A\right)\exp\left(B\right)\neq\exp\left(A+B\right)
\end{equation}

\end_inset

we thus desire a 
\begin_inset Formula $z\in\mathbb{R}^{n\times n}$
\end_inset

 such that 
\begin_inset Formula 
\begin{equation}
\exp\left(A\right)\exp\left(B\right)=\exp\left(z\right)
\end{equation}

\end_inset

this can be done using the natural log to get 
\begin_inset Formula 
\begin{align}
\ln\left(\exp\left(A\right)\exp\left(B\right)\right) & =\ln\left(\exp\left(z\right)\right)\label{eq:BCH_identity}\\
 & =z
\end{align}

\end_inset

We recall from subsection 
\begin_inset CommandInset ref
LatexCommand eqref
reference "sub:Taylor-Series-Expansion"

\end_inset

 
\begin_inset Formula 
\[
\log\left(A\right)=-\sum_{n=1}^{\infty}\frac{\left(I-A\right)}{n!}^{n}
\]

\end_inset

and 
\begin_inset Formula 
\begin{equation}
\exp\left(A\right)=\sum_{r=0}^{\infty}\frac{A^{r}}{r!}
\end{equation}

\end_inset

which allows us to write 
\begin_inset Formula 
\begin{align}
\exp\left(A\right)\exp\left(B\right) & =\sum_{r=0}^{\infty}\frac{A^{r}}{r!}\sum_{s=0}^{\infty}\frac{B^{s}}{s!}\\
 & =\sum_{r=0}^{\infty}\sum_{s=0}^{\infty}\frac{A^{r}}{r!}\frac{B^{s}}{s!}\\
 & =\sum_{r,s=0}^{\infty}\frac{A^{r}}{r!}\frac{B^{s}}{s!}
\end{align}

\end_inset

we can now write 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:BCH_identity"

\end_inset

 as 
\begin_inset Formula 
\begin{align}
\ln\left(\exp\left(A\right)\exp\left(B\right)\right) & =\sum_{k=1}^{\infty}\frac{\left(-1\right)^{k-1}}{k}\left(\sum_{r,s=0}^{\infty}\frac{A^{r}}{r!}\frac{B^{s}}{s!}-1\right)^{k}\label{eq:BCH_ln_exp}\\
 & =\sum_{k=1}^{\infty}\sum_{r_{1}+s_{1}>0}\cdots\sum_{r_{k}+s_{k}>0}\frac{\left(-1\right)^{k-1}}{k}\frac{A^{r_{1}}B^{s_{1}}\cdots A^{r_{k}}B^{r_{k}}}{r_{1}!s_{1}!\cdots r_{k}!s_{k}!}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Using this expression we can easily calculate the first two order terms.
\begin_inset Formula 
\begin{gather*}
\underbrace{\left(A+B+AB+\cdots\right)}_{k=1}-\underbrace{\frac{1}{2}\left(A^{2}+B^{2}+AB+BA+\cdots\right)}_{k=2}\\
=A+B+\frac{1}{2}\left[A,B\right]+\cdots
\end{gather*}

\end_inset

where 
\begin_inset Formula 
\[
\left[A,B\right]=AB-BA
\]

\end_inset

 is the lie bracket.
 If you continue to calculate the higher order terms, you will notice that
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:BCH_ln_exp"

\end_inset

 can be written in terms of lie brackets.
 This new form is known as the BCH formula
\begin_inset Formula 
\begin{equation}
\ln\left(\exp\left(A\right)\exp\left(B\right)\right)=\sum_{k=1}^{\infty}\frac{\left(-1\right)^{k-1}}{k}\sum_{r_{1}+s_{1}>0}\cdots\sum_{r_{k}+s_{k}>0}\frac{\left[A^{r_{1}}B^{s_{1}}A^{r_{2}}B^{s_{2}}\cdots A^{r_{n}}B^{s_{n}}\right]}{\left(\sum_{j=1}^{k}\left(r_{j}+s_{j}\right)\right)\prod_{i=1}^{k}r_{i}!s_{i}!}\label{eq:BCH_dynkins}
\end{equation}

\end_inset

where the super scripts 
\begin_inset Formula $r$
\end_inset

 and 
\begin_inset Formula $s$
\end_inset

 indicate the order of the lie bracket
\begin_inset Formula 
\[
\left[A^{r_{1}}B^{s_{1}}A^{r_{2}}B^{s_{2}}\cdots A^{r_{n}}B^{s_{n}}\right]=\underbrace{[A,[\cdots A,}_{r_{1}}\underbrace{[B,[\cdots,[B}_{s_{1}},[\cdots,\underbrace{[A,[\cdots A,}_{r_{k}}\underbrace{[B,[\cdots,[B]}_{s_{k}}\cdots]
\]

\end_inset

 and note that 
\begin_inset Formula $r_{i}+s_{i}>0$
\end_inset

.
 Also if the lie bracket only has one term then,
\begin_inset Formula $\left[A\right]=A$
\end_inset

 and 
\begin_inset Formula $\left[B\right]=B$
\end_inset

.
 This form can be confusing to understand for those who are seeing it for
 the first time.
 To help the reader understand 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:BCH_dynkins"

\end_inset

, we will demonstrate how to use it to calculate the first few order terms.
 
\end_layout

\begin_layout Standard
When 
\begin_inset Formula $k=1$
\end_inset

, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:BCH_dynkins"

\end_inset

 can be simplified to 
\begin_inset Formula 
\begin{equation}
\frac{\left[A^{r_{1}}B^{s_{1}}\right]}{\left(r_{1}+s_{1}\right)r_{1}!s_{1}!}\label{eq:BCH_k1}
\end{equation}

\end_inset

we first note that if 
\begin_inset Formula $s_{1}>1$
\end_inset

 then the term 
\begin_inset Formula $\left[A^{r_{1}}B^{s_{1}}\right]=0$
\end_inset

 since 
\begin_inset Formula $\left[B,B\right]=0$
\end_inset

.
 For example, let 
\begin_inset Formula $r_{1}=1$
\end_inset

 and 
\begin_inset Formula $s_{1}=2$
\end_inset

, then 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:BCH_k1"

\end_inset

 becomes 
\begin_inset Formula 
\begin{equation}
\frac{\left[A,\left[B,B\right]\right]}{\left(1+2\right)1!2!}=0
\end{equation}

\end_inset

we also note that if 
\begin_inset Formula $r_{1}=0$
\end_inset

 and 
\begin_inset Formula $s_{1}>1$
\end_inset

 then the term 
\begin_inset Formula $\left[A^{r_{1}}B^{s_{1}}\right]=0$
\end_inset

 since 
\begin_inset Formula $\left[A,A\right]=0$
\end_inset

.
 For example, let 
\begin_inset Formula $r_{1}=3$
\end_inset

 and 
\begin_inset Formula $s_{1}=2$
\end_inset

, then 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:BCH_k1"

\end_inset

 becomes
\begin_inset Formula 
\begin{equation}
\frac{\left[A,\left[A,A\right]\right]}{\left(3+0\right)3!0!}=0
\end{equation}

\end_inset

What we have shown you implies that if 
\begin_inset Formula $s_{k}>1$
\end_inset

 or 
\begin_inset Formula $r_{k}>1$
\end_inset

 when 
\begin_inset Formula $s_{1}=0$
\end_inset

 then the lie bracket term 
\begin_inset Formula 
\[
\left[A^{r_{1}}B^{s_{1}}A^{r_{2}}B^{s_{2}}\cdots A^{r_{n}}B^{s_{n}}\right]
\]

\end_inset

is zero.
 This simplifies the terms that we need to compute.
 We are now ready to calculate the first few non-zero terms of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:BCH_k1"

\end_inset

.
 To simplify the notation, let 
\begin_inset Formula 
\begin{equation}
f_{k}\left(r_{1},s_{1},\ldots,r_{k},s_{k}\right)=\frac{\left(-1\right)^{k-1}}{k}\sum_{r_{1}+s_{1}>0}\cdots\sum_{r_{k}+s_{k}>0}\frac{\left[A^{r_{1}}B^{s_{1}}A^{r_{2}}B^{s_{2}}\cdots A^{r_{n}}B^{s_{n}}\right]}{\left(\sum_{j=1}^{k}\left(r_{j}+s_{j}\right)\right)\prod_{i=1}^{k}r_{i}!s_{i}!}
\end{equation}

\end_inset

so that 
\begin_inset Formula 
\begin{equation}
\ln\left(\exp\left(A\right)\exp\left(B\right)\right)=\sum_{k=1}^{\infty}f_{k}\left(r_{1},s_{1},\ldots,r_{k},s_{k}\right).
\end{equation}

\end_inset

Now
\begin_inset Formula 
\begin{align}
f_{1}\left(1,0\right) & =\frac{\left[A\right]}{\left(1+0\right)1!0!}=A\\
f_{1}\left(0,1\right) & =\frac{\left[B\right]}{\left(0+1\right)0!1!}=B\\
f_{1}\left(1,1\right) & =\frac{\left[A,B\right]}{\left(1+1\right)1!1!}=\frac{1}{2}\left[A,B\right]\\
f_{1}\left(2,1\right) & =\frac{\left[A,\left[A,B\right]\right]}{\left(2+1\right)2!1!}=\frac{1}{6}\left[A,\left[A,B\right]\right]\\
 & \vdots
\end{align}

\end_inset

When 
\begin_inset Formula $k=2$
\end_inset

, then 
\begin_inset Formula 
\begin{equation}
f_{k}\left(r_{1},s_{1},r_{2},s_{2}\right)=\frac{\left(-1\right)^{k-1}}{k}\sum_{r_{1}+s_{1}>0}\sum_{r_{2}+s_{2}>0}\frac{\left[A^{r_{1}}B^{s_{1}}A^{r_{2}}B^{s_{2}}\right]}{\left(r_{1}+s_{1}+r_{2}+s_{2}\right)r_{1}!s_{1}!r_{2}!s_{2}!}
\end{equation}

\end_inset

and the first few terms are
\begin_inset Formula 
\begin{align}
f_{2}\left(1,0,0,1\right) & =-\frac{1}{2}\frac{\left[A,B\right]}{\left(1+0+0+1\right)1!0!0!1!}=-\frac{1}{3}\left[A,B\right]\\
f_{2}\left(0,1,1,0\right) & =-\frac{1}{2}\frac{\left[B,A\right]}{\left(0+1+1+0\right)0!1!1!0!}=-\frac{1}{3}\left[B,A\right]\\
f_{2}\left(1,0,1,1\right) & =-\frac{1}{2}\frac{\left[A,\left[A,B\right]\right]}{\left(1+0+1+1\right)1!0!1!1!}=-\frac{1}{6}\left[A,\left[A,B\right]\right]\\
f_{2}\left(0,1,1,1\right) & =-\frac{1}{2}\frac{\left[B,\left[A,B\right]\right]}{\left(0+1+1+1\right)0!1!1!1!}=-\frac{1}{6}\left[B,\left[A,B\right]\right]\\
f_{2}\left(2,0,0,1\right) & =-\frac{1}{2}\frac{\left[A,\left[A,B\right]\right]}{\left(2+0+0+1\right)2!0!0!1!}=-\frac{1}{12}\left[A,\left[A,B\right]\right]\\
f_{2}\left(0,2,1,0\right) & =-\frac{1}{2}\frac{\left[B,\left[B,A\right]\right]}{\left(0+2+1+0\right)0!2!1!0!}=-\frac{1}{12}\left[B,\left[B,A\right]\right]\\
 & \vdots
\end{align}

\end_inset

If we add the first few terms that we calculated, we would get 
\begin_inset Formula 
\begin{multline}
A+B+\frac{1}{2}\left[A,B\right]+\frac{1}{6}\left[A,\left[A,B\right]\right]-\frac{1}{3}\left[A,B\right]-\frac{1}{3}\left[B,A\right]\\
-\frac{1}{6}\left[A,\left[A,B\right]\right]-\frac{1}{6}\left[B,\left[A,B\right]\right]-\frac{1}{12}\left[A,\left[A,B\right]\right]-\frac{1}{12}\left[B,\left[B,A\right]\right]
\end{multline}

\end_inset

noting that 
\begin_inset Formula $\left[A,B\right]=-\left[B,A\right]$
\end_inset

 we can simplify the above sum to 
\begin_inset Formula 
\begin{equation}
A+B+\frac{1}{2}\left[A,B\right]+\frac{1}{12}\left(\left[A,\left[A,B\right]\right]-\left[B,\left[A,B\right]\right]\right)
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
It is worth showing the first few orders of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:BCH_dynkins"

\end_inset

 since they are well known 
\begin_inset Formula 
\begin{align*}
Z & =\ln\left(\exp\left(A\right)\exp\left(B\right)\right)\\
 & =A+B+\frac{1}{2}\left[A,B\right]+\frac{1}{12}\left(\left[A,\left[A,B\right]\right]-\left[B,\left[A,B\right]\right]\right)-\frac{1}{24}\left[B,\left[A,\left[A,B\right]\right]\right]\\
 & -\frac{1}{720}\left(\left[\left[\left[\left[A,B\right],B\right],B\right],B\right]+\left[\left[\left[\left[B,A\right],A\right],A\right],A\right]\right)\\
 & +\frac{1}{360}\left(\left[\left[\left[\left[A,B\right],B\right],B\right],A\right]+\left[\left[\left[\left[B,A\right],A\right],A\right],B\right]\right)\\
 & +\frac{1}{120}\left(\left[\left[\left[\left[A,B\right],A\right],B\right],A\right]+\left[\left[\left[\left[B,A\right],B\right],A\right],B\right]\right)+\cdots+
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
In subsection 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Adjoint"

\end_inset

 we showed that the Lie bracket of a matrix Lie algebra can be written different
ly using the adjoint of the Lie algebra.
 This allows us to write 
\begin_inset Formula $Z$
\end_inset

 as 
\begin_inset Formula 
\begin{align*}
Z & =\ln\left(\exp\left(A\right)\exp\left(B\right)\right)\\
 & =A+B+\frac{1}{2}\left(A^{\curlywedge}B\right)^{\wedge}+\frac{1}{12}\left(\left(A^{\curlywedge^{2}}B\right)^{\wedge}+\left(B^{\curlywedge^{2}}A\right)^{\wedge}\right)-\frac{1}{24}\left[B,\left[A,\left[A,B\right]\right]\right]\\
 & -\frac{1}{720}\left(\left(A^{\curlywedge^{4}}B\right)^{\wedge}+\left(B^{\curlywedge^{4}}A\right)^{\wedge}\right)\\
 & +\frac{1}{360}\left(\left[\left[\left[\left[A,B\right],B\right],B\right],A\right]+\left[\left[\left[\left[B,A\right],A\right],A\right],B\right]\right)\\
 & +\frac{1}{120}\left(\left[\left[\left[\left[A,B\right],A\right],B\right],A\right]+\left[\left[\left[\left[B,A\right],B\right],A\right],B\right]\right)+\cdots+
\end{align*}

\end_inset

which shows that there are terms linear in 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

.
\end_layout

\begin_layout Standard
If we keep only terms linear in 
\begin_inset Formula $A$
\end_inset

 by assuming that the norm of 
\begin_inset Formula $A$
\end_inset

 is small, the general BCH formula becomes 
\begin_inset Formula 
\begin{equation}
\ln\left(\exp\left(A\right)\exp\left(B\right)\right)\approx B+\sum_{k=0}^{\infty}\frac{\mathcal{B}_{k}}{k!}\underbrace{[B,[B,\ldots,[B}_{k},A]]]\label{eq:BCH_approx_A}
\end{equation}

\end_inset

and if we keep only the linear terms in 
\begin_inset Formula $B$
\end_inset

 by assuming that the norm of 
\begin_inset Formula $B$
\end_inset

 is small, the general BCH formula becomes 
\begin_inset Formula 
\begin{equation}
\ln\left(\exp\left(A\right)\exp\left(B\right)\right)\approx A+\sum_{k=0}^{\infty}\left(-1\right)^{k}\frac{\mathcal{B}_{k}}{k!}\underbrace{[A,[A,\ldots,[A}_{k},B]]]\label{eq:BCH_approx_B}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathcal{B}_{k}$
\end_inset

 are the Bernoulli numbers
\begin_inset Formula 
\begin{equation}
\mathcal{B}_{0}=1,\,\mathcal{B}_{1}=-\frac{1}{2},\,\mathcal{B}_{2}=\frac{1}{6},\,\mathcal{B}_{3}=0,\,\mathcal{B}_{4}=-\frac{1}{30},\ldots
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
These approximations can be represented differently using an alternate form
 of the Lie bracket as discussed in subsection 
\begin_inset CommandInset ref
LatexCommand eqref
reference "sub:Adjoint"

\end_inset

.
 These alternate forms are 
\begin_inset Formula 
\begin{align}
\ln\left(\exp\left(A\right)\exp\left(B\right)\right) & \approx B+\sum_{k=0}^{\infty}\frac{\mathcal{B}_{k}}{k!}\left(B^{\curlywedge^{k}}A\right)^{\wedge}\\
 & \approx B+\left(J_{\ell}^{-1}\left(B\right)A\right)^{\wedge}
\end{align}

\end_inset

when the norm of 
\begin_inset Formula $A$
\end_inset

 is small and 
\begin_inset Formula 
\begin{align}
\ln\left(\exp\left(A\right)\exp\left(B\right)\right) & \approx A+\sum_{k=0}^{\infty}\left(-1\right)^{k}\frac{\mathcal{B}_{k}}{k!}\left(A^{\curlywedge^{k}}B\right)^{\wedge}\\
 & \approx A+\left(J_{r}^{-1}\left(A\right)B\right)^{\wedge}
\end{align}

\end_inset

when the norm of 
\begin_inset Formula $B$
\end_inset

 is small.
 The terms 
\begin_inset Formula $J_{\ell}$
\end_inset

 and 
\begin_inset Formula $J_{r}$
\end_inset

 are the left and right Jacobians defined as 
\begin_inset Formula 
\begin{align}
J_{r}^{-1}\left(\tau\right) & \triangleq\sum_{k=0}^{\infty}\left(-1\right)^{k}\frac{\mathcal{B}_{k}}{k!}\tau^{\curlywedge^{k}}\\
J_{\ell}^{-1}\left(\tau\right) & \triangleq\sum_{k=0}^{\infty}\frac{\mathcal{B}_{k}}{k!}\tau^{\curlywedge^{k}}\\
J_{r}\left(\tau\right) & \triangleq\sum_{k=0}^{\infty}\frac{1}{\left(k+1\right)!}\left(-\tau^{\curlywedge}\right)^{k}\label{eq:BCH_rightJacobian}\\
J_{\ell}\left(\tau\right) & \triangleq\sum_{k=0}^{\infty}\frac{1}{\left(k+1\right)!}\left(\tau^{\curlywedge}\right)^{k}\label{eq:BCH_leftJacobian}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
These Jacobians are also used when you are wanting to express 
\begin_inset Formula 
\begin{equation}
\exp\left(A+B\right)
\end{equation}

\end_inset

as the products of two exponents.
 For example 
\begin_inset Formula 
\begin{equation}
\exp\left(A+B\right)\approx\exp\left(A\right)\exp\left(J_{r}\left(A\right)B\right)
\end{equation}

\end_inset

when the norm of 
\begin_inset Formula $B$
\end_inset

 is small or 
\begin_inset Formula 
\begin{equation}
\exp\left(A+B\right)\approx\exp\left(J_{\ell}\left(B\right)A\right)\exp\left(B\right)
\end{equation}

\end_inset

when the norm of 
\begin_inset Formula $A$
\end_inset

 is small.
 
\end_layout

\begin_layout Subsection
The Left and Right Jacobians of 
\begin_inset Formula $SE\left(2\right)$
\end_inset


\end_layout

\begin_layout Standard
The Left and Right Jacobians of 
\begin_inset Formula $SE\left(2\right)$
\end_inset

 are derived using the process outlined in section 
\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Baker-Campbell-Hausdorff"

\end_inset

 For the sake of brevity, we will not repeat that derivation but simply
 use the derivation done it 
\begin_inset CommandInset citation
LatexCommand cite
key "Chirikjian2011"

\end_inset

 which yields 
\begin_inset Formula 
\begin{equation}
J_{r}\left(\tau\right)=\begin{bmatrix}\frac{\sin\omega}{\omega} & \frac{\left(1-\cos\omega\right)}{\omega} & \frac{\left(\omega v_{x}-v_{y}+v_{y}\cos\omega-v_{x}\sin\omega\right)}{\omega^{2}}\\
\frac{\left(\cos\omega-1\right)}{\omega} & \frac{\sin\omega}{\omega} & \frac{\left(v_{x}+\omega v_{y}-v_{x}\cos\omega-v_{2}\sin\omega\right)}{\omega^{2}}\\
0 & 0 & 1
\end{bmatrix}\label{eq:BCH_rightJacobianSE2}
\end{equation}

\end_inset

and 
\begin_inset Formula 
\begin{equation}
J_{\ell}\left(\tau\right)=\begin{bmatrix}\frac{\sin\omega}{\omega} & \frac{\left(\cos\left(\omega\right)-1\right)}{\omega} & \frac{\left(\omega v_{x}+v_{y}-v_{y}\cos\omega-v_{x}\sin\omega\right)}{\omega^{2}}\\
\frac{\left(1-\cos\omega\right)}{\omega} & \frac{\sin\omega}{\omega} & \frac{\left(-v_{x}+\omega v_{y}+v_{x}\cos\omega-v_{2}\sin\omega\right)}{\omega^{2}}\\
0 & 0 & 1
\end{bmatrix}\label{eq:BCH_leftJacobianSE2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\tau^{\wedge}=\left(\left[v_{x},v_{y},\omega\right]^{\top}\right)^{\wedge}\in\mathfrak{se}\left(2\right)$
\end_inset

.
\end_layout

\begin_layout Standard
If the angular velocity 
\begin_inset Formula $\omega\ll0$
\end_inset

, then computing the left and right Jacobians using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:BCH_rightJacobianSE2"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:BCH_leftJacobianSE2"

\end_inset

 could produce poor approximations.
 In this case, calculate the left and right Jacobians using the first few
 terms of 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:BCH_rightJacobian"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:BCH_leftJacobian"

\end_inset

 to estimate it.
 
\end_layout

\begin_layout Section
Discrete Lie Group Extended Kalman Filter
\end_layout

\begin_layout Standard
This section will derive the Discrete Lie Group Extended Kalman Filter on
 
\begin_inset Formula $SE\left(2\right)$
\end_inset

 following the derivation in 
\begin_inset CommandInset citation
LatexCommand cite
key "Thrun2006,Bourmaud2013,Bourmaud2014"

\end_inset

.
 We contribute to the derivation in 
\begin_inset CommandInset citation
LatexCommand cite
key "Bourmaud2013,Bourmaud2014"

\end_inset

 by adding in detail and clarity using the methodology in 
\begin_inset CommandInset citation
LatexCommand cite
key "Thrun2006"

\end_inset

.
 This specific name for the filter, D-LG-EKF, was invented by Guillaume
 Bourmaud, but it is more commonly known as an error state Kalman Filter
 
\begin_inset CommandInset citation
LatexCommand cite
key "Sola2018"

\end_inset

 since it is a type of one.
 
\end_layout

\begin_layout Standard
We begin with some preliminaries by expressing the system model, and specifying
 the random variables.
 
\end_layout

\begin_layout Subsection
Preliminaries
\end_layout

\begin_layout Standard
The discrete system model for 
\begin_inset Formula $SE\left(2\right)$
\end_inset

 is
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "eq:DLGEKF_Pre_systemModel"

\end_inset

 
\begin_inset Formula 
\begin{align}
\mathcal{X}_{k} & =\mathcal{X}_{k^{-}}\boxplus\left(u_{k}+w_{k}\right)\label{eq:DLGEKF_systemModel}\\
y_{k,j} & =\mathcal{X}_{k}^{-1}b_{j}+v_{k}\label{eq:DLGEKF_outputModel}
\end{align}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset

 where 
\begin_inset Formula $\mathcal{X}\in SE\left(2\right)$
\end_inset

, 
\begin_inset Formula $k$
\end_inset

 is the time instance, 
\begin_inset Formula $u\in\mathbb{R}^{3}$
\end_inset

 is the input vector, 
\begin_inset Formula $w\in\mathbb{R}^{3}\sim\mathcal{N}\left(0,W\right)$
\end_inset

 is zero mean Gaussian process noise with covariance 
\begin_inset Formula $W$
\end_inset

, 
\begin_inset Formula $y_{k,j}\in\mathbb{R}^{2}$
\end_inset

 is the output at time instance 
\begin_inset Formula $k$
\end_inset

 associated with the 
\begin_inset Formula $j^{th}$
\end_inset

 beacon, 
\begin_inset Formula $b_{j}\in\mathbb{R}^{2}$
\end_inset

 is the position of the 
\begin_inset Formula $j^{th}$
\end_inset

 beacon, and 
\begin_inset Formula $v\in\mathbb{R}^{2}\sim\mathcal{N}\left(0,V\right)$
\end_inset

 is zero mean Gaussian measurement noise with covariance 
\begin_inset Formula $V$
\end_inset

.
 We assume that 
\begin_inset Formula $w$
\end_inset

, 
\begin_inset Formula $\delta\mathcal{X}$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

 are independent random variables such that 
\begin_inset Formula $\text{E}\left[vw^{\top}\right]=0$
\end_inset

, 
\begin_inset Formula $\text{E}\left[v\delta\mathcal{X}^{\top}\right]=0$
\end_inset

, and 
\begin_inset Formula $\text{E}\left[w\delta\mathcal{X}^{\top}\right]=0$
\end_inset

.
\end_layout

\begin_layout Standard
The discrete estimate model for our system is
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset

 
\begin_inset Formula 
\begin{align}
\hat{\mathcal{X}}_{k} & =\hat{\mathcal{X}}_{k^{-}}\boxplus\left(u_{k}\right)\label{eq:DLGEKF_estimateSystemModel}\\
\hat{y}_{k,j} & =\hat{\mathcal{X}}_{k}^{-1}b_{j}
\end{align}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset

 where
\begin_inset Formula $\hat{\mathcal{X}}\in SE\left(2\right)$
\end_inset

 is the estimate or mean of 
\begin_inset Formula $\mathcal{X}$
\end_inset

, and 
\begin_inset Formula $\hat{y}$
\end_inset

 is the estimate of 
\begin_inset Formula $y$
\end_inset

.
\end_layout

\begin_layout Standard
The error state is defined as 
\begin_inset Formula 
\begin{align}
\delta\mathcal{X} & =\mathcal{X}\boxminus\hat{\mathcal{X}}\label{eq:DLGEKF_error}\\
 & =\log\left(\hat{\mathcal{X}}^{-1}\mathcal{X}\right)^{\vee}
\end{align}

\end_inset

and is a zero mean Gaussian random variable with covariance 
\begin_inset Formula $P$
\end_inset

; 
\begin_inset Formula $\delta\mathcal{X}\sim N\left(0,P\right)$
\end_inset

.
\end_layout

\begin_layout Standard
The way the problem is framed, the random variables are 
\begin_inset Formula $\delta\mathcal{X}$
\end_inset

, 
\begin_inset Formula $w$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

.
 The variables 
\begin_inset Formula $\mathcal{X}$
\end_inset

, and 
\begin_inset Formula $\hat{\mathcal{X}}$
\end_inset

 are deterministic variables.
 Since 
\begin_inset Formula $\delta\mathcal{X}$
\end_inset

, 
\begin_inset Formula $w$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

 are in the vector space isomorphic to the lie algebra, the probability
 distributions are represented in the vector space.
 The reason for this is to represent the probability distributions in minimum
 number of generalized coordinates as possible.
\end_layout

\begin_layout Standard
The D-LG-EKF is composed of two steps, the prediction step and the update
 step.
 The prediction step occurs when we get inputs to the system in the form
 of odometry measurements, and the update step occurs when we get output
 measurements.
 Since these steps do not occur simultaneously, it is important to distinguish
 them.
 To do this, we will use subscripts.
 Let 
\begin_inset Formula $\delta\mathcal{X}_{k|\ell}$
\end_inset

, and 
\begin_inset Formula $P_{k|\ell}$
\end_inset

 denote the error state and error covariance after the 
\begin_inset Formula $k^{th}$
\end_inset

 prediction step and after the 
\begin_inset Formula $\ell^{th}$
\end_inset

 update step.
 
\end_layout

\begin_layout Subsection
Prediction
\begin_inset CommandInset label
LatexCommand label
name "sub:DLGEKF_Prediction"

\end_inset


\end_layout

\begin_layout Standard
The prediction step is calculated by solving for the posterior distribution
 when there is a new odometry measurement.
 It is framed as 
\begin_inset Formula 
\begin{equation}
p\left(\delta\mathcal{X}_{k|\ell^{-}}\right)=\int p\left(\left.\delta\mathcal{X}_{k|\ell^{-}}\right|\delta\mathcal{X}_{k^{-}|\ell^{-}},u_{k}\right)p\left(\delta\mathcal{X}_{k^{-}|\ell^{-}}\right)d\delta\mathcal{X}_{k^{-}|\ell^{-}}\label{eq:DLGEKF_Pre_Prob}
\end{equation}

\end_inset

We will derive each term in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DLGEKF_Pre_Prob"

\end_inset

.
 To simplify notation, we will drop the subscript 
\begin_inset Formula $\ell$
\end_inset

 since it does not change in this step.
 
\end_layout

\begin_layout Standard
The first term is simply
\begin_inset Formula 
\begin{align}
p\left(\delta\mathcal{X}_{k^{-}}\right) & =\eta\exp\left(-\frac{1}{2}\left(\mathcal{X}_{k^{-}}\boxminus\hat{\mathcal{X}}_{k^{-}}\right)^{\top}P_{k^{-}}^{-1}\left(\mathcal{X}_{k^{-}}\boxminus\hat{\mathcal{X}}_{k^{-}}\right)\right)\\
 & =\eta\exp\left(-\frac{1}{2}\delta\mathcal{X}_{k^{-}}^{\top}P_{k^{-}}^{-1}\delta\mathcal{X}_{k^{-}}\right)\label{eq:DLGEKF_e-}
\end{align}

\end_inset

where 
\begin_inset Formula $\eta$
\end_inset

 is a normalizing factor.
\end_layout

\begin_layout Standard
The second term is the probability of 
\begin_inset Formula $\delta\mathcal{X}_{k|\ell}$
\end_inset

 after an input is applied to the previous error.
 To calculate this probability we will use 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DLGEKF_systemModel"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DLGEKF_estimateSystemModel"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DLGEKF_error"

\end_inset

 to propagate the error using the input from the current time step, and
 then calculate the new probability distribution.
 The error propagation is 
\begin_inset Formula 
\begin{align}
\delta\mathcal{X}_{k} & =\mathcal{X}_{k}\boxminus\hat{\mathcal{X}}_{k}\\
 & =\left(\mathcal{X}_{k^{-}}\boxplus\left(u_{k}+w_{k}\right)\right)\boxminus\left(\hat{\mathcal{X}}_{k^{-}}\boxplus\left(u_{k}\right)\right)\\
 & =\left(\left(\hat{\mathcal{X}}_{k^{-}}\boxplus\delta\mathcal{X}_{k^{-}}\right)\boxplus\left(u_{k}+w_{k}\right)\right)\boxminus\left(\hat{\mathcal{X}}_{k^{-}}\boxplus\left(u_{k}\right)\right)\label{eq:DLGEKF_deltaX_predict}
\end{align}

\end_inset

which is a nonlinear function of the random variables 
\begin_inset Formula $\delta\mathcal{X}_{k^{-}}$
\end_inset

 and 
\begin_inset Formula $w_{k}$
\end_inset

 which implies that the true distribution of 
\begin_inset Formula $\delta\mathcal{X}_{k}$
\end_inset

 is not Gaussian.
 However, like in other EKFs, we can linearize the system using Taylor series
 expansion and approximate the true distribution of 
\begin_inset Formula $\delta\mathcal{X}_{k}$
\end_inset

 as a Gaussian distribution.
 This approximation holds well when the covariances of 
\begin_inset Formula $\delta\mathcal{X}_{k^{-}}$
\end_inset

 and 
\begin_inset Formula $w_{k}$
\end_inset

 have small eigenvalues 
\begin_inset CommandInset citation
LatexCommand cite
after "Section 3.3"
key "Thrun2006"

\end_inset

.
 
\end_layout

\begin_layout Standard
We will calculate the Taylor Series expansion of 
\begin_inset Formula $\mathcal{X}_{k}$
\end_inset

 by treating 
\begin_inset Formula $\delta\mathcal{X}_{k^{-}}$
\end_inset

 and 
\begin_inset Formula $w_{k}$
\end_inset

 as small deviations from the estimated state 
\begin_inset Formula $\hat{\mathcal{X}}_{k^{-}}$
\end_inset

 and the input 
\begin_inset Formula $u_{k}$
\end_inset

 as shown below 
\begin_inset Formula 
\begin{align}
\mathcal{X}_{k} & =\mathcal{X}_{k^{-}}\boxplus u_{k}\\
 & =\hat{\mathcal{X}}_{k^{-}}\boxplus\delta\mathcal{X}_{k^{-}}\boxplus\left(u_{k}+w_{k}\right)\\
 & =\hat{\mathcal{X}}_{k^{-}}\boxplus u_{k}\boxplus\left(\left.\frac{\partial\mathcal{X}_{k}}{\partial\mathcal{X}_{k^{-}}}\right|_{\hat{\mathcal{X}}_{k^{-}},u_{k}}\delta\mathcal{X}_{k^{-}}+\left.\frac{\partial\mathcal{X}_{k}}{\partial u_{k}}\right|_{\hat{\mathcal{X}}_{k^{-}},u_{k}}w_{k}+H.O.T.\right)\label{eq:DLGEKF_TaylorSeries1}
\end{align}

\end_inset

where 
\begin_inset Formula $H.O.T.$
\end_inset

 stands for higher order terms of the Taylor series.
 We will ignore the 
\begin_inset Formula $H.O.T.$
\end_inset

 assuming that 
\begin_inset Formula $\left\Vert \delta\mathcal{X}_{k^{-}}\right\Vert ^{n}$
\end_inset

 and 
\begin_inset Formula $\left\Vert \delta u_{k}\right\Vert ^{n}$
\end_inset

 are negligible for 
\begin_inset Formula $n>1$
\end_inset

.
 It is worth noting that incorporating higher order terms will improve the
 estimate at a cost of complexity.
 
\end_layout

\begin_layout Standard
We will calculate the Jacobians used in the Taylor series expansion by using
 the method described in 
\begin_inset CommandInset citation
LatexCommand cite
key "Sola2018"

\end_inset

.
 Let 
\begin_inset Formula $F=\left.\frac{\partial\mathcal{X}_{k}}{\partial\mathcal{X}_{k^{-}}}\right|_{\mathcal{\hat{X}}_{k^{-}},u_{k}}$
\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 then
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
F & =\frac{\partial\mathcal{X}_{k^{-}}\boxplus u_{k}}{\partial\mathcal{X}_{k^{-}}}\\
 & =\lim_{\tau\to0}\frac{\left(\mathcal{X}_{k^{-}}\boxplus\tau\boxplus u_{k}\right)\boxminus\left(\mathcal{X}_{k^{-}}\boxplus u_{k}\right)}{\tau}\\
 & =\lim_{\tau\to0}\frac{\log\left(\exp\left(u_{k}\right)^{-1}\mathcal{X}_{k^{-}}^{-1}\mathcal{X}_{k^{-}}\exp\left(\tau\right)\exp\left(u_{k}\right)\right)}{\tau}\\
 & =\lim_{\tau\to0}\frac{\log\left(\exp\left(u_{k}\right)^{-1}\exp\left(\tau\right)\exp\left(u_{k}\right)\right)}{\tau},\quad\text{using the adjoint}\\
 & =\lim_{\tau\to0}\frac{\log\left(\exp\left(\text{\textbf{Ad}}_{\exp u_{k}^{-1}}\tau\right)\exp\left(u_{k}\right)^{-1}\exp\left(u_{k}\right)\right)}{\tau}\\
 & =\lim_{\tau\to0}\frac{\text{\textbf{Ad}}_{\exp u_{k}^{-1}}\tau}{\tau}\\
 & =\text{\textbf{Ad}}_{\exp u_{k}^{-1}}\\
 & =\textbf{Ad}_{\exp u_{k}}^{-1}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $G=\left.\frac{\partial\mathcal{X}_{k}}{\partial u_{k}}\right|_{\hat{\mathcal{X}}_{k^{-}},u_{k}}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
G & =\frac{\partial\mathcal{X}_{k^{-}}\boxplus u_{k}}{\partial u_{k}}\\
 & =\lim_{\tau\to0}\frac{\left(\mathcal{X}_{k^{-}}\boxplus\left(u_{k}+\tau\right)\right)\boxminus\left(\mathcal{X}_{k^{-}}\boxplus u_{k}\right)}{\tau}\\
 & =\lim_{\tau\to0}\frac{\log\left(\exp\left(u_{k}\right)^{-1}\mathcal{X}_{k^{-}}^{-1}\mathcal{X}_{k^{-}}\exp\left(u_{k}+\tau\right)\right)}{\tau}\\
 & =\lim_{\tau\to0}\frac{\log\left(\exp\left(u_{k}\right)^{-1}\exp\left(u_{k}+\tau\right)\right)}{\tau}\\
 & \approx\lim_{\tau\to0}\frac{\log\left(\exp\left(u_{k}\right)^{-1}\exp\left(u_{k}\right)\exp\left(J_{r}\left(u_{k}\right)\tau\right)\right)}{\tau}\\
 & \approx J_{r}\left(u_{k}\right)
\end{align}

\end_inset

with 
\begin_inset Formula 
\begin{equation}
J_{r}\left(u_{k}\right)=\begin{bmatrix}\frac{\sin\omega}{\omega} & \frac{\left(1-\cos\omega\right)}{\omega} & \frac{\left(\omega v_{x}-v_{y}+v_{y}\cos\omega-v_{x}\sin\omega\right)}{\omega^{2}}\\
\frac{\left(\cos\omega-1\right)}{\omega} & \frac{\sin\omega}{\omega} & \frac{\left(v_{x}+\omega v_{y}-v_{x}\cos\omega-v_{2}\sin\omega\right)}{\omega^{2}}\\
0 & 0 & 1
\end{bmatrix}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Substituting 
\begin_inset Formula $F$
\end_inset

 and 
\begin_inset Formula $G$
\end_inset

 into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DLGEKF_TaylorSeries1"

\end_inset

 yields 
\begin_inset Formula 
\begin{equation}
\mathcal{X}_{k}\approx\hat{\mathcal{X}}_{k^{-}}\boxplus u_{k}\boxplus\left(F\delta\mathcal{X}_{k^{-}}+Gw_{k}\right)
\end{equation}

\end_inset

which is substituted into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DLGEKF_deltaX_predict"

\end_inset

 to give 
\begin_inset Formula 
\begin{align}
\delta\mathcal{X}_{k} & \approx\left(\hat{\mathcal{X}}_{k^{-}}\boxplus u_{k}\boxplus\left(F\delta\mathcal{X}_{k^{-}}+Gw_{k}\right)\right)\boxminus\left(\hat{\mathcal{X}}_{k^{-}}\boxplus\left(u_{k}\right)\right)\\
 & \approx\log\left(\exp\left(u_{k}\right)^{-1}\hat{\mathcal{X}}_{k^{-}}^{-1}\hat{\mathcal{X}}_{k^{-}}\exp\left(u_{k}\right)\exp\left(F\delta\mathcal{X}_{k^{-}}+Gw_{k}\right)\right)\\
 & \approx F\delta\mathcal{X}_{k^{-}}+Gw_{k}
\end{align}

\end_inset

which is a linear function of 
\begin_inset Formula $\delta\mathcal{X}_{k^{-}}$
\end_inset

 and 
\begin_inset Formula $w_{k}$
\end_inset

.
 This implies that 
\begin_inset Formula $\delta\mathcal{X}_{k}$
\end_inset

 will be a Gaussian distribution since a linear function of Gaussian distributio
ns is a Gaussian distribution 
\begin_inset CommandInset citation
LatexCommand cite
key "Reid2001"

\end_inset

.
 Since 
\begin_inset Formula $\delta\mathcal{X}_{k}$
\end_inset

 will be approximated as a Gaussian distribution, we only need to calculate
 the first and second moments to fully represent the distribution.
 The mean of 
\begin_inset Formula $\delta\mathcal{X}_{k}$
\end_inset

 
\begin_inset Formula 
\begin{align}
\text{E}\left[\delta\mathcal{X}_{k}\right] & =\text{E}\left[F\delta\mathcal{X}_{k^{-}}+Gw_{k}\right]\\
 & =F\text{E}\left[\delta\mathcal{X}_{k^{-}}\right]+G\text{E}\left[w_{k}\right]\\
 & =0
\end{align}

\end_inset


\end_layout

\begin_layout Standard
The covariance of 
\begin_inset Formula $\delta\mathcal{X}_{k}$
\end_inset

 is 
\begin_inset Formula 
\begin{align}
\text{E}\left[\delta\mathcal{X}_{k}\delta\mathcal{X}_{k}^{\top}\right]= & \text{E}\left[\left(F\delta\mathcal{X}_{k^{-}}+Gw_{k}\right)\left(F\delta\mathcal{X}_{k^{-}}+Gw_{k}\right)^{\top}\right]\\
= & F\text{E}\left[\delta\mathcal{X}_{k^{-}}\delta\mathcal{X}_{k^{-}}^{\top}\right]F^{\top}+G\text{E}\left[w_{k}w_{k}^{\top}\right]G^{\top}\\
 & +F\text{E}\left[\delta\mathcal{X}_{k^{-}}w_{k}^{\top}\right]G^{\top}+G\text{E}\left[w_{k}\delta\mathcal{X}_{k^{-}}^{\top}\right]F^{\top}\\
= & FP_{k^{-}}F^{\top}+GWG^{\top}\\
= & P_{k}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Using the first and second moments we now have 
\begin_inset Formula 
\begin{equation}
p\left(\left.\delta\mathcal{X}_{k|\ell^{-}}\right|\delta\mathcal{X}_{k^{-}|\ell^{-}},u_{k}\right)\triangleq\eta\exp\left(-\frac{1}{2}\delta\mathcal{X}_{k}^{\top}P_{k}^{-1}\delta\mathcal{X}_{k}\right)
\end{equation}

\end_inset

where 
\begin_inset Formula $\eta$
\end_inset

 is a normalizing factor.
 Note that this probability is independent of 
\begin_inset Formula $\delta\mathcal{X}_{k^{-}|\ell}$
\end_inset

.
 This will allow us to pull this probability outside of the integral in
 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DLGEKF_Pre_Prob"

\end_inset

 to get 
\begin_inset Formula 
\begin{equation}
p\left(\delta\mathcal{X}_{k}\right)=p\left(\left.\delta\mathcal{X}_{k}\right|\delta\mathcal{X}_{k^{-}},u_{k}\right)\int p\left(\delta\mathcal{X}_{k^{-}}\right)d\delta\mathcal{X}_{k^{-}}
\end{equation}

\end_inset

since the integral of any probability distribution over all possible values
 is 
\begin_inset Formula $1$
\end_inset

, we can simplify the above expression to 
\begin_inset Formula 
\begin{align}
p\left(\delta\mathcal{X}_{k}\right) & =p\left(\left.\delta\mathcal{X}_{k}\right|\delta\mathcal{X}_{k^{-}},u_{k}\right)\\
 & =\eta\exp\left(-\frac{1}{2}\delta\mathcal{X}_{k}^{\top}P_{k}^{-1}\delta\mathcal{X}_{k}\right)
\end{align}

\end_inset


\end_layout

\begin_layout Standard
We now have all of the pieces for the prediction step of the D-LG-EKF which
 is summarized as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "eq:DLGEKF_predictionStep"

\end_inset

 
\begin_inset Formula 
\begin{align}
\hat{\mathcal{X}}_{k|\ell^{-}} & =\hat{\mathcal{X}}_{k^{-}|\ell^{-}}\boxplus\left(u_{k}\right)\\
P_{k|\ell^{-}} & =FP_{k^{-}|\ell^{-}}F^{\top}+GWG^{\top}
\end{align}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Update
\begin_inset CommandInset label
LatexCommand label
name "sub:DLGEKF_Update"

\end_inset


\end_layout

\begin_layout Standard
The update step is calculated by solving for the posterior distribution
 when a new measurement is received.
 In this case the measurement is relative position to a beacon.
 The posterior distribution is defined as 
\begin_inset Formula 
\begin{equation}
p\left(\delta\mathcal{X}_{k|\ell}\right)=\eta p\left(\left.y_{k,j}\right|\mathcal{X}_{k|\ell^{-}}\right)p\left(\delta\mathcal{X}_{k|\ell^{-}}\right)
\end{equation}

\end_inset

where 
\begin_inset Formula $\eta$
\end_inset

 is a normalizing factor.
 The term 
\begin_inset Formula $p\left(\delta\mathcal{X}_{k|\ell^{-}}\right)$
\end_inset

 was solved for in subsection 
\begin_inset CommandInset ref
LatexCommand eqref
reference "sub:DLGEKF_Prediction"

\end_inset

 and is 
\begin_inset Formula 
\begin{equation}
p\left(\delta\mathcal{X}_{k|\ell^{-}}\right)=\eta\exp\left(-\frac{1}{2}\delta\mathcal{X}_{k|\ell^{-}}^{\top}P_{k|\ell^{-}}^{-1}\delta\mathcal{X}_{k|\ell^{-}}\right)
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The other term 
\begin_inset Formula $p\left(\left.y_{k,j}\right|\mathcal{X}_{k|\ell^{-}}\right)$
\end_inset

 is solved for by linearizing 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:DLGEKF_outputModel"

\end_inset

 as follows
\begin_inset Formula 
\begin{align}
y_{k,j} & =\mathcal{X}_{k}^{-1}b_{j}\\
 & =\hat{\mathcal{X}}_{k|\ell^{-}}^{-1}b_{j}+\left.\frac{\partial\mathcal{X}_{k}^{-1}b_{j}}{\partial\mathcal{X}_{k}^{-1}}\right|_{\hat{\mathcal{X}}_{k|\ell^{-}}}\delta\mathcal{X}_{k|\ell^{-}}+H.O.T.\\
 & \approx\hat{\mathcal{X}}_{k|\ell^{-}}^{-1}b_{j}+\left.\frac{\partial\mathcal{X}_{k}^{-1}b_{j}}{\partial\mathcal{X}_{k}^{-1}}\right|_{\hat{\mathcal{X}}_{k|\ell^{-}}}\delta\mathcal{X}_{k|\ell^{-}}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $H=\left.\frac{\partial\mathcal{X}_{k}^{-1}b_{j}}{\partial\mathcal{X}_{k}^{-1}}\right|_{\hat{\mathcal{X}}_{k|\ell^{-}}}$
\end_inset

.
 This derivative can be solved for using the chain rule which is shown below;
 some notation has been dropped for simplicity.
 
\begin_inset Formula 
\[
H=\frac{\partial\mathcal{X}^{-1}b_{j}}{\partial\mathcal{X}^{-1}}\frac{\partial\mathcal{X}^{-1}}{\partial\mathcal{X}}
\]

\end_inset

The first partial derivative term is
\begin_inset Formula 
\begin{align}
\frac{\partial\mathcal{X}^{-1}b_{k}}{\partial\mathcal{X}^{-1}} & =\lim_{\tau\to0}\frac{\left(\mathcal{X}^{-1}\boxplus\tau\right)b_{k}-\mathcal{X}^{-1}b_{k}}{\tau}\\
 & =\lim_{\tau\to0}\frac{\mathcal{X}^{-1}\exp\left(\tau^{\wedge}\right)b_{k}-\mathcal{X}^{-1}b_{k}}{\tau}\\
 & \approx\lim_{\tau\to0}\frac{\mathcal{X}^{-1}\left(I+\tau^{\wedge}\right)b_{k}-\mathcal{X}^{-1}b_{k}}{\tau}\\
 & \approx\lim_{\tau\to0}\frac{\mathcal{X}^{-1}\tau^{\wedge}b_{k}}{\tau}\\
 & \approx\lim_{\tau\to0}\frac{\begin{bmatrix}R^{\top} & -R^{\top}t\\
0 & 1
\end{bmatrix}\begin{bmatrix}\left[\theta\right]_{\times} & \rho\\
0 & 0
\end{bmatrix}b_{k}}{\tau}\\
 & \approx\lim_{\tau\to0}\frac{\begin{bmatrix}R^{\top}\left[\theta\right]_{\times} & R^{\top}\rho\\
0 & 0
\end{bmatrix}b_{k}}{\tau}\\
 & \approx\lim_{\tau\to0}\frac{R^{\top}\rho+R^{\top}\left[\theta\right]_{\times}b_{k}}{\tau}\\
 & \approx\begin{bmatrix}R^{\top} & R^{\top}\left[1\right]_{\times}b_{k}\end{bmatrix}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
and the second partial derivative term is 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\frac{\partial\mathcal{X}^{-1}}{\partial\mathcal{X}} & =\lim_{\tau\to0}\frac{\left(\mathcal{X}\exp\left(\tau^{\wedge}\right)\right)^{-1}\boxminus x^{-1}}{\tau}\\
 & =\lim_{\tau\to0}\frac{\log\left(\mathcal{X}\exp\left(-\tau^{\wedge}\right)\mathcal{X}^{-1}\right)^{\vee}}{\tau}\\
 & =\lim_{\tau\to0}\frac{\log\left(\exp\left(-\mathcal{X}\tau^{\wedge}\mathcal{X}^{-1}\right)\right)^{\vee}}{\tau}\\
 & =\lim_{\tau\to0}\frac{\left(-\mathcal{X}\tau^{\wedge}\mathcal{X}^{-1}\right)^{\vee}}{\tau}\\
 & =\lim_{\tau\to0}\frac{-\mathbf{Ad}_{\mathcal{X}}\tau}{\tau}\\
 & =-\mathbf{Ad}_{\mathcal{X}}
\end{align}

\end_inset

we can now form 
\begin_inset Formula $H$
\end_inset

, 
\begin_inset Formula 
\begin{align}
H & =\frac{\partial\mathcal{X}^{-1}b_{k}}{\partial\mathcal{X}^{-1}}\frac{\partial\mathcal{X}^{-1}}{\partial\mathcal{X}}\\
 & =\begin{bmatrix}R^{\top} & R^{\top}\left[1\right]_{\times}b_{k}\end{bmatrix}\left(-\mathbf{Ad}_{x}\right)\\
 & =\begin{bmatrix}R^{\top} & R^{\top}\left[1\right]_{\times}b_{k}\end{bmatrix}\begin{bmatrix}-R^{\top} & \left[1\right]_{\times}t\\
0 & -1
\end{bmatrix}\\
 & =-\begin{bmatrix}I & R^{\top}\left[1\right]_{\times}\left(b_{k}-t\right)\end{bmatrix}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Using 
\begin_inset Formula $H$
\end_inset

 we can linearize the output
\begin_inset Formula 
\begin{equation}
y_{k,j}\approx\hat{\mathcal{X}}_{k|\ell^{-}}^{-1}b_{j}+H\delta\mathcal{X}_{k|\ell^{-}}
\end{equation}

\end_inset

which means that 
\begin_inset Formula 
\begin{equation}
p\left(\left.y_{k,j}\right|\mathcal{X}_{k|\ell^{-}}\right)=\eta\exp\left(-\frac{1}{2}\left(y_{k,j}-\hat{\mathcal{X}}_{k|\ell^{-}}^{-1}b_{j}-H\delta\mathcal{X}_{k|\ell^{-}}\right)^{\top}R^{-1}\left(y_{k,j}-\hat{\mathcal{X}}_{k|\ell^{-}}^{-1}b_{j}-H\delta\mathcal{X}_{k|\ell^{-}}\right)^{\top}\right)\label{eq:DLGEKF_prob_y_x}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We can now solve for 
\begin_inset Formula $p\left(\delta\mathcal{X}_{k|\ell}\right)$
\end_inset

 by multiplying the probability distributions 
\begin_inset Formula $p\left(\left.y_{k,j}\right|\mathcal{X}_{k|\ell^{-}}\right)$
\end_inset

 and 
\begin_inset Formula $p\left(\delta\mathcal{X}_{k|\ell^{-}}\right)$
\end_inset

 and solving for 
\begin_inset Formula $p\left(\delta\mathcal{X}_{k|\ell}\right)$
\end_inset

.
\begin_inset Formula 
\begin{equation}
p\left(\left.y_{k,j}\right|\mathcal{X}_{k|\ell^{-}}\right)p\left(\delta\mathcal{X}_{k|\ell^{-}}\right)=\eta\exp\left(-L_{t}\right)
\end{equation}

\end_inset

with 
\begin_inset Formula 
\begin{equation}
L_{t}=\frac{1}{2}\left(y_{k,j}-\hat{\mathcal{X}}_{k|\ell^{-}}^{-1}b_{j}-H\delta\mathcal{X}_{k|\ell^{-}}\right)^{\top}R^{-1}\left(y_{k,j}-\hat{\mathcal{X}}_{k|\ell^{-}}^{-1}b_{j}-H\delta\mathcal{X}_{k|\ell^{-}}\right)^{\top}+\frac{1}{2}\delta\mathcal{X}_{k|\ell^{-}}^{\top}P_{k|\ell^{-}}^{-1}\delta\mathcal{X}_{k|\ell^{-}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
To represent the distribution in terms of 
\begin_inset Formula $\delta\mathcal{X}_{k|\ell^{-}}$
\end_inset

 we take the first and second partial derivatives of 
\begin_inset Formula $L_{t}$
\end_inset

 with respect to 
\begin_inset Formula $\delta\mathcal{X}_{k|\ell^{-}}$
\end_inset


\begin_inset Formula 
\begin{align}
\frac{\partial L_{t}}{\delta\mathcal{X}_{k|\ell^{-}}} & =-H^{\top}R^{-1}\left(y_{k,j}-\hat{\mathcal{X}}_{k|\ell^{-}}^{-1}b_{j}-H\delta\mathcal{X}_{k|\ell^{-}}\right)+P_{k|\ell^{-}}^{-1}\delta\mathcal{X}_{k|\ell^{-}}\\
\frac{\partial^{2}L_{t}}{\delta\mathcal{X}_{k|\ell^{-}}^{2}} & =H^{\top}R^{-1}H+P_{k|\ell^{-}}^{-1}=P_{k|\ell}^{-1}
\end{align}

\end_inset

the mean is derived by setting the first partial derivative of 
\begin_inset Formula $L_{t}$
\end_inset

 to 
\begin_inset Formula $0$
\end_inset

 and solving for 
\begin_inset Formula $\delta\mathcal{X}_{k|\ell^{-}}$
\end_inset


\begin_inset Formula 
\begin{align}
H^{\top}R^{-1}\left(y_{k,j}-\hat{\mathcal{X}}_{k|\ell^{-}}^{-1}b_{j}-H\delta\mathcal{X}_{k|\ell^{-}}\right) & =P_{k|\ell^{-}}^{-1}\delta\mathcal{X}_{k|\ell^{-}}\\
H^{\top}R^{-1}\left(y_{k,j}-\hat{\mathcal{X}}_{k|\ell^{-}}^{-1}b_{j}\right) & =H^{\top}R^{-1}H\delta\mathcal{X}_{k|\ell^{-}}+P_{k|\ell^{-}}^{-1}\delta\mathcal{X}_{k|\ell^{-}}\\
H^{\top}R^{-1}\left(y_{k,j}-\hat{\mathcal{X}}_{k|\ell^{-}}^{-1}b_{j}\right) & =P_{k|\ell}^{-1}\delta\mathcal{X}_{k|\ell^{-}}\\
P_{k|\ell}H^{\top}R^{-1}\left(y_{k,j}-\hat{\mathcal{X}}_{k|\ell^{-}}^{-1}b_{j}\right) & =\delta\mathcal{X}_{k|\ell^{-}}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
The error 
\begin_inset Formula $\delta\mathcal{X}_{k|\ell^{-}}$
\end_inset

, which we will denote as 
\begin_inset Formula $\delta\mathcal{X}$
\end_inset

, becomes the new mean of 
\begin_inset Formula $p\left(\delta\mathcal{X}_{k|\ell}\right)$
\end_inset

 such that 
\begin_inset Formula 
\begin{equation}
p\left(\delta\mathcal{X}_{k|\ell}\right)=\eta\exp\left(-\frac{1}{2}\left(\delta\mathcal{X}_{k|\ell}-\delta\mathcal{X}\right)^{\top}P_{k|\ell}^{-1}\left(\delta\mathcal{X}_{k|\ell}-\delta\mathcal{X}\right)\right)
\end{equation}

\end_inset

however, we would like the distribution to remain zero mean.
 This can be done by adding the mean onto 
\begin_inset Formula $\mathcal{X}_{k|\ell^{-}}$
\end_inset

 so that 
\begin_inset Formula 
\begin{equation}
p\left(\delta\mathcal{X}_{k|\ell}\right)\sim\mathcal{N}\left(0,P_{k|\ell}\right)
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We can now summarize the update step of the D-LG-EKF
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\text{Innovation}: & \hfill z=y_{k,j}-\hat{\mathcal{X}}_{k|\ell^{-}}^{-1}b_{j}\\
\text{Innovation Covariance}: & \hfill Z=HP_{k|\ell^{-}}H^{\top}+R\\
\text{Kalman Gain:} & \hfill K=P_{k|\ell^{-}}H^{\top}Z^{-1}\\
\text{Observed Error:} & \hfill\delta\mathcal{X}=Kz\\
\text{State Update:} & \hfill\mathcal{X}_{k|\ell}=\mathcal{X}_{k|\ell^{-}}\boxplus\delta\mathcal{X}\\
\text{Cov Update:} & \hfill P_{k|\ell}=P_{k|\ell^{-}}-KZK^{\top}
\end{align}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Summary of D-LG-EKF
\end_layout

\begin_layout Standard
We summarize the main steps of the D-LG-EKF in this subsection for organizationa
l purposes.
\end_layout

\begin_layout Standard
We have the prediction step 
\begin_inset Formula 
\begin{align}
\hat{\mathcal{X}}_{k|\ell^{-}} & =\hat{\mathcal{X}}_{k^{-}|\ell^{-}}\boxplus\left(u_{k}\right)\\
P_{k|\ell^{-}} & =FP_{k^{-}|\ell^{-}}F^{\top}+GWG^{\top}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
and the update step
\begin_inset Formula 
\begin{align}
\text{Innovation}: & \hfill z=y_{k,j}-\hat{\mathcal{X}}_{k|\ell^{-}}^{-1}b_{j}\\
\text{Innovation Covariance}: & \hfill Z=HP_{k|\ell^{-}}H^{\top}+R\\
\text{Kalman Gain:} & \hfill K=P_{k|\ell^{-}}H^{\top}Z^{-1}\\
\text{Observed Error:} & \hfill\delta\mathcal{X}=Kz\\
\text{State Update:} & \hfill\hat{\mathcal{X}}_{k|\ell}=\hat{\mathcal{X}}_{k|\ell^{-}}\boxplus\delta\mathcal{X}\\
\text{Cov Update:} & \hfill P_{k|\ell}=P_{k|\ell^{-}}-KZK^{\top}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula 
\begin{align}
F & =\textbf{Ad}_{\exp u_{k}}^{-1}\\
G & =J_{r}\left(u_{k}\right)\\
H & =-\begin{bmatrix}I & R^{\top}\left[1\right]_{\times}\left(b_{k}-t\right)\end{bmatrix}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "/home/mark/Documents/mendeley/library"
options "plain"

\end_inset


\end_layout

\end_body
\end_document
