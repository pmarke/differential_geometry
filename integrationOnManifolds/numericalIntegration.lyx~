#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass IEEEtran
\begin_preamble
\usepackage{algorithmic}
\end_preamble
\options onecolumn
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 1in
\topmargin 1in
\rightmargin 1in
\bottommargin 1in
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Solving ODE on Manifolds
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
There are two main approaches to solving ordinary differential equations
 (ODE) using numerical integration on manifolds: extrinsic and intrinsic.
 In the extrinsic approach, the manifold in embedded in a higher dimensional
 Euclidean space which allows the use of the classical numerical integration
 techniques used in any vector space; however, the solution produced by
 these techniques are not guaranteed to stay on the manifold, and usually
 requires correction by projecting the solution back onto the manifold.
 In the intrinsic approach, the numerical integration technique uses properties
 of a differentiable manifold to evolve the solution of the ODE on the manifold.
 Because the intrinsic approach naturally evolves on the manifold, the solution
 incurs less error and never needs to be project back onto the manifold;
 however, it is typically more computationally cumbersome due to the need
 of the exponential map.
\end_layout

\begin_layout Standard
Fortunately, computers are becoming more sophisticated and better able to
 handle more computations, and as robotics advances there is a greater need
 for higher accuracy.
 Therefore intrinsic solutions of ODE is becoming not only computationally
 possible, but also necessary.
 The objective of this note is to present intrinsic numerical integration
 methods discovered by other researchers in an easy way to understand for
 the purposes of small unmanned air systems (sUAS) with examples.
 We will try to present them in a general case first, but then quickly apply
 them to sUAS.
 Our belief is that by seeing applications to sUAS along the way will improve
 understanding, versus exposing you to all the theory upfront and then presentin
g an application at the end.
 
\end_layout

\begin_layout Standard
The majority of the material that we will present will be from Crouch and
 Grossman 
\begin_inset CommandInset citation
LatexCommand cite
key "Crouch1993"

\end_inset

, Munthe-Kaas 
\begin_inset CommandInset citation
LatexCommand cite
key "Munthe-Kaas1995,Munthe-Kaas1998,Munthe-Kaas1999"

\end_inset

, and Eng
\begin_inset IPA

\begin_layout Standard
ø
\end_layout

\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "Engo2000,Engo2003"

\end_inset

.
 Crouch and Grossman were one of the first to present the Runge-Kutta (RK)
 method to evolve on manifolds up to the third order.
 Their approach does the approximation on the Lie group which results in
 it being complicated and limited in the order.
 Munthe-Kaas took a similar approach, but instead of performing the RK approxima
tions in the Lie group, the approximation is performed in the Lie algebra
 and then mapped to the Lie group.
 This approach allows the use of the classical RK method up to any order.
 Eng
\begin_inset IPA

\begin_layout Standard
ø
\end_layout

\end_inset

 built upon Munthe-Kaas work by expanding it to other coordinates, and then
 developed the partitioned Runge-Kutta Muthe-Kaas (RK-MK) method used to
 solve partitioned differential equations which will be applicable to solving
 second order ODEs.
 
\end_layout

\begin_layout Standard
For additional references about implicit numerical integration on manifolds
 we refer the reader to 
\begin_inset CommandInset citation
LatexCommand cite
key "Celledoni2014"

\end_inset

 which provides an introduction to different methods, and to 
\begin_inset CommandInset citation
LatexCommand cite
key "Iserles2000"

\end_inset

 which provides an extensive survey and overview of modern techniques.
 It is assumed that the reader has a basic understanding on theory of smooth
 manifolds, Lie groups and Lie algebras.
 Even though we will recall some of it in this note, we refer the reader
 to 
\begin_inset CommandInset citation
LatexCommand cite
key "Abraham1998"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand cite
key "Lee2013"

\end_inset

 for a more in depth exposure on the subjects.
 Everything presented here is a compilation of the works of the authors
 already mentioned except for the multirotor example.
 All we hope to achieve is to add clarity and instruction on how to apply
 this theory to sUASs.
 
\end_layout

\begin_layout Standard
In this section we recall basic definitions that are paramount to understanding
 this material.
 Since we are simply recalling these definitions, we won't present them
 in their most abstract form, rather a simplified form that is sufficient
 for the needs of this note.
 For more precise abstract definitions we refer the reader to the authors
 mentioned in the introduction.
 
\end_layout

\begin_layout Section
Examples
\begin_inset CommandInset label
LatexCommand label
name "sec:Examples"

\end_inset


\end_layout

\begin_layout Standard
We will consider several examples throughout this note.
 The first exampled will be explored throughout the documentation, and the
 other examples will be presented fully in the appendix.
 
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:s1"

\end_inset

Consider a pendulum that is unit length and constrained to move in a plane.
 This pendulum moves on the manifold 
\begin_inset Formula $S^{1}\coloneqq\left\{ \left(x,y\right)\in\mathbb{R}^{2}|x^{2}+y^{2}=1\right\} $
\end_inset

.
 The ordinary differential equation for this example will be developed in
 section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Fundamentals"

\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:se3"

\end_inset

A simplified version of the second order ODE of a multirotor using body-centric
 representation is 
\begin_inset Formula 
\begin{align*}
\dot{q} & =qv^{\wedge}\\
\mathcal{I}\dot{v} & =\text{ad}_{v}^{*}\mathcal{I}v+F\left(v,q\right)
\end{align*}

\end_inset

where 
\begin_inset Formula $q\in SE\left(3\right)$
\end_inset

 is the pose of the multirotor, 
\begin_inset Formula $v$
\end_inset

 is the generalized velocity of the rigid body w.r.t.
 the inertial frame expressed in the body frame, 
\begin_inset Formula $\text{ad}_{v}^{*}$
\end_inset

 is the dual of the adjoint of 
\begin_inset Formula $v$
\end_inset

, 
\begin_inset Formula $\mathcal{I}$
\end_inset

 is the generalized inertial tensor, and 
\begin_inset Formula $F\left(v,q\right):TQ\to T^{*}Q$
\end_inset

 is the force.
 In this example, the generalized velocity 
\begin_inset Formula $v$
\end_inset

 has the form 
\begin_inset Formula 
\[
v=\begin{bmatrix}\rho\\
\omega
\end{bmatrix}
\]

\end_inset

where 
\begin_inset Formula $\rho\in\mathbb{R}^{3}$
\end_inset

 denotes the translational velocity and 
\begin_inset Formula $\omega\in\mathbb{R}^{3}$
\end_inset

 denotes the angular velocity.
 The generalized inertial tensor in matrix form is a diagonal matrix with
 components 
\begin_inset Formula 
\[
\mathcal{I}=\text{diag}\left(m,m,m,J_{x},J_{y},J_{z}\right)
\]

\end_inset

where 
\begin_inset Formula $m$
\end_inset

 is the mass of the multirotor and 
\begin_inset Formula $J_{i}\,i\in\left\{ x,y,z\right\} $
\end_inset

 are the moments of inertial about each axis assuming the multirotor is
 expressed in an NED frame.
 The dual adjoint of 
\begin_inset Formula $v$
\end_inset

 has matrix form 
\begin_inset Formula 
\[
\text{ad}_{v}^{*}=\begin{bmatrix}\omega_{\times} & \rho_{\times}\\
 & \omega_{\times}
\end{bmatrix}^{\top}
\]

\end_inset

where 
\begin_inset Formula $\omega_{\times}$
\end_inset

 and 
\begin_inset Formula $\rho_{\times}$
\end_inset

 are the skew symmetric matrices formed from 
\begin_inset Formula $\omega$
\end_inset

 and 
\begin_inset Formula $u$
\end_inset

 corresponding to the body-centric representation, i.e., 
\begin_inset Formula 
\[
u_{\times}=\begin{bmatrix}0 & -u_{z} & u_{y}\\
u_{z} & 0 & -u_{x}\\
-u_{y} & u_{x} & 0
\end{bmatrix}
\]

\end_inset

where 
\begin_inset Formula $u\in\left\{ \omega,\rho\right\} $
\end_inset

.
 The covector field 
\begin_inset Formula $F\left(v,q\right)$
\end_inset

 is 
\begin_inset Formula 
\[
F\left(v,q\right)=\begin{bmatrix}mgR^{\top}e_{z/i}^{i}+Te_{z/b}^{b}\\
M
\end{bmatrix}
\]

\end_inset

where 
\begin_inset Formula $g$
\end_inset

 is the gravitational constant, 
\begin_inset Formula $m$
\end_inset

 is the mass, 
\begin_inset Formula $R\in SO\left(3\right)$
\end_inset

 is the rotation component of 
\begin_inset Formula $q$
\end_inset

, 
\begin_inset Formula $T$
\end_inset

 is the thrust from the propellers, 
\begin_inset Formula $M$
\end_inset

 is the moment produced by the propellers, 
\begin_inset Formula $e_{z/i}^{i}$
\end_inset

 is the unit vector along the z-axis of the inertial frame expressed in
 the inertial frame, and 
\begin_inset Formula $e_{z/b}^{b}$
\end_inset

 is the unit vector along the z-axis of the body frame expressed in the
 body frame.
 
\begin_inset Formula $e_{z/i}^{i}$
\end_inset

 and 
\begin_inset Formula $e_{z/b}^{b}$
\end_inset

 have the matrix form 
\begin_inset Formula $\begin{bmatrix}0 & 0 & 1\end{bmatrix}^{\top}$
\end_inset

.
 
\end_layout

\begin_layout Example
For our purposes, we will let the generalized inertial tensor have arbitrary
 values
\begin_inset Formula 
\[
\mathcal{I}=\text{diag}\left(10,10,10,0.5,0.5,0.1\right)
\]

\end_inset

and the gravitational constant 
\begin_inset Formula $g$
\end_inset

 will have value 
\begin_inset Formula $9.81$
\end_inset

.
\end_layout

\begin_layout Section
Method Overview
\end_layout

\begin_layout Standard
We are interested in solving first order ordinary differential equations
 of the form 
\begin_inset Formula 
\begin{equation}
\dot{\gamma}\left(t\right)=X\left(t,\gamma\left(t\right)\right)\label{eq:ODE_FO}
\end{equation}

\end_inset

where 
\begin_inset Formula $M$
\end_inset

 is a smooth manifold, 
\begin_inset Formula $I\subseteq\mathbb{R}$
\end_inset

, 
\begin_inset Formula $\gamma\left(t\right):I\to M$
\end_inset

 is an integral curve of the vector field 
\begin_inset Formula $X\in\mathfrak{X}\left(M\right)$
\end_inset

 at the point 
\begin_inset Formula $M\ni m=\gamma\left(0\right)$
\end_inset

.
 In many cases, analytic solutions to the ODE do not exist, or at least
 we cannot solve them, and we must rely on numerical approximations to solve
 the ODE.
 
\end_layout

\begin_layout Standard
One of the most popular methods for numerical integration is the Runge-Kutta
 method (see 
\begin_inset CommandInset citation
LatexCommand cite
key "Butcher2008,Hairer1993"

\end_inset

 for detailed information on this method, and appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Classical-Runge-Kutta-Methods"

\end_inset

 for a simple overview).
 The Runge-Kutta (RK) method is limited to vector spaces, i.e.
 it isn't defined on manifolds that do not support addition and scalar multiplic
ation.
 Fortunately, the explicit classical RK method was extended to manifolds
 on which the vector fields can be locally defined by an infinitesimal generator
 corresponding to a Lie group action.
 This method is called the Runge-Kutta-Munthe-Kaas (RK-MK) and was developed
 in the series of papers 
\begin_inset CommandInset citation
LatexCommand cite
key "Munthe-Kaas1995,Munthe-Kaas1998,Munthe-Kaas1999"

\end_inset

, and later optimized by Munthe-Kass and Owren in 
\begin_inset CommandInset citation
LatexCommand cite
key "Munthe-Kaas1999a"

\end_inset

.
 
\end_layout

\begin_layout Standard
Depending on the manifold 
\begin_inset Formula $M$
\end_inset

, RK-MK can depend on the idea of vector fields with frozen coefficients
 developed by Crouch and Grossman in 
\begin_inset CommandInset citation
LatexCommand cite
key "Crouch1993"

\end_inset

 which is well explained in 
\begin_inset CommandInset citation
LatexCommand cite
key "Celledoni2014"

\end_inset

.
 To understand the basic idea consider the integral curve 
\begin_inset Formula $v\left(t\right):I\to V$
\end_inset

 that evolves on the vector space 
\begin_inset Formula $V$
\end_inset

 according to the simple linear first order ODE with a constant vector field
 
\begin_inset Formula $X:V\to TV,\,v\mapsto Av$
\end_inset

 at the point 
\begin_inset Formula $v\left(0\right)=v_{0}$
\end_inset

 (
\begin_inset Formula $TV$
\end_inset

 is the tangent bundle of 
\begin_inset Formula $V$
\end_inset

) as depicted below 
\begin_inset Formula 
\begin{align*}
\dot{v}\left(t\right) & =X\left(v\left(t\right)\right)\\
 & =Av\left(t\right).
\end{align*}

\end_inset

It is assumed that 
\begin_inset Formula $Av\left(t\right)$
\end_inset

 is defined for some representation of 
\begin_inset Formula $v\left(t\right)$
\end_inset

, and we have chosen to omit explicitly showing representations for clearity.
 The well known solution to the above ODE is 
\begin_inset Formula 
\[
v\left(t\right)=\exp\left(At\right)v_{0}.
\]

\end_inset

Now consider the same scenario, but let 
\begin_inset Formula $X:\mathbb{R}\times V\to V,\,\left(t,v\left(t\right)\right)\mapsto A\left(t\right)v\left(t\right)$
\end_inset

 be a vector field dependent on 
\begin_inset Formula $t$
\end_inset

, but still linear in 
\begin_inset Formula $v\left(t\right)$
\end_inset

, then the well known solution is 
\begin_inset Formula 
\[
v\left(t\right)=\exp\left(\int_{0}^{t}A\left(t\right)dt\right)v_{0}.
\]

\end_inset

Lastly consider the same scenario, but let 
\begin_inset Formula $X$
\end_inset

 be a vector field dependent on 
\begin_inset Formula $t$
\end_inset

 and not linearly dependent in 
\begin_inset Formula $v\left(t\right)$
\end_inset

, then the solution is not necessarily well known and it is not 
\begin_inset Formula 
\[
v\left(t\right)=\exp\left(\int_{0}^{t}A\left(t,v\left(t\right)\right)dt\right)v_{0}.
\]

\end_inset


\end_layout

\begin_layout Standard
For the purposes of using RK-MK, we need to construct a vector field linear
 in 
\begin_inset Formula $t$
\end_inset

 and 
\begin_inset Formula $v\left(t\right)$
\end_inset

 from a nonlinear vector field so that the solution can be approximated
 as 
\begin_inset Formula 
\[
v\left(t\right)=\exp\left(At\right)v_{0},
\]

\end_inset

this is done using vector fields with frozen coefficients.
 The main idea is to take a vector field 
\begin_inset Formula $X\left(t,v\left(t\right)\right)$
\end_inset

 and separate it into two parts
\begin_inset Formula 
\[
X\left(t,v\left(t\right)\right)=A\left(t,v\left(t\right)\right)v\left(t\right)
\]

\end_inset

and freeze the arguments of 
\begin_inset Formula $A$
\end_inset

 at 
\begin_inset Formula $t=t_{0}$
\end_inset

 and 
\begin_inset Formula $v\left(t\right)=v\left(t_{0}\right)=v_{0}$
\end_inset

 to form the approximated vector field 
\begin_inset Formula 
\[
X_{v_{0}}\left(t,v\left(t\right)\right)=A\left(t_{0},v_{0}\right)v\left(t\right),
\]

\end_inset

so that the approximated solution is 
\begin_inset Formula 
\[
v\left(t\right)\approx\exp\left(A\left(t_{0},v_{0}\right)t\right)v_{0},
\]

\end_inset

which is a Lie-Euler Method using vector fields with frozen coefficients.
 This method is only a first order approximation.
 
\end_layout

\begin_layout Standard
To improve this method, let 
\begin_inset Formula $A\left(v\left(t\right)\right)$
\end_inset

 be the vector fields such that 
\begin_inset Formula $X\left(v\left(t\right)\right)=A\left(v\left(t\right)\right)v\left(t\right)$
\end_inset

, and 
\begin_inset Formula $\gamma\left(t\right)$
\end_inset

 be the integral curve of the vector field 
\begin_inset Formula $A\left(v\left(t\right)\right)$
\end_inset

 at the point 
\begin_inset Formula $\gamma\left(t_{0}\right)=0$
\end_inset

 , then the Taylor series of 
\begin_inset Formula $\gamma\left(t\right)$
\end_inset

 is 
\begin_inset Formula 
\[
\gamma\left(t_{0}+h\right)=\gamma\left(t_{0}\right)+h\left(A\left(v\left(t_{0}\right)\right)+\frac{d}{dt}A\left(v\left(t_{0}\right)\right)\frac{h}{2!}+\frac{d^{2}}{dt^{2}}A\left(v\left(t_{0}\right)\right)\frac{h^{2}}{3!}+\frac{d^{3}}{dt^{3}}A\left(v\left(t_{0}\right)\right)\frac{h^{3}}{4!}\right)+\mathcal{O}\left(h^{5}\right).
\]

\end_inset

Recall that 
\begin_inset Formula $X\left(t,v\left(t\right)\right)=A\left(t,v\left(t\right)\right)v\left(t\right)$
\end_inset

.
 An RK method of order 
\begin_inset Formula $4$
\end_inset

 generates a vector field 
\begin_inset Formula 
\[
\bar{A}\left(h,v\left(t_{0}\right)\right)\approx A\left(v\left(t_{0}\right)\right)+\frac{d}{dt}A\left(v\left(t_{0}\right)\right)\frac{h}{2!}+\frac{d^{2}}{dt^{2}}A\left(v\left(t_{0}\right)\right)\frac{h^{2}}{3!}+\frac{d^{3}}{dt^{3}}A\left(v\left(t_{0}\right)\right)\frac{h^{3}}{4!},
\]

\end_inset

using only 
\begin_inset Formula $A\left(v\left(t\right)\right)$
\end_inset

 to approximate the Taylor series up to order 
\begin_inset Formula $4$
\end_inset

 so that the Taylor series of 
\begin_inset Formula $\gamma\left(t\right)$
\end_inset

 becomes 
\begin_inset Formula 
\[
\gamma\left(t_{0}+h\right)=\gamma\left(t_{0}\right)+h\bar{A}\left(h,v\left(t_{0}\right)\right)+\mathcal{O}\left(h^{5}\right).
\]

\end_inset

The constructed vector field 
\begin_inset Formula $\bar{A}\left(v\left(t\right)\right)$
\end_inset

 is then used to approximate the integral 
\begin_inset Formula 
\[
\int_{t_{0}}^{t_{0}+h}A\left(v\left(t\right)\right)=h\bar{A}\left(h,v\left(t_{0}\right)\right)+\mathcal{O}\left(h^{5}\right),
\]

\end_inset

and solve the ODE 
\begin_inset Formula 
\[
v\left(t\right)\approx\exp\left(\bar{A}\left(h,v\left(t\right)\right)h\right)v_{0},
\]

\end_inset

which is a lot more accurate than the 
\begin_inset Formula $1^{st}$
\end_inset

 order Lie-Euler Method.
 The purpose of this note is to lightly explain how to construct the vector
 field 
\begin_inset Formula $\bar{A}$
\end_inset

 using the RK-MK method.
 
\end_layout

\begin_layout Remark
Crouch and Crossman in 
\begin_inset CommandInset citation
LatexCommand cite
key "Crouch1993"

\end_inset

 give a more precise and abstract definition and description for vector
 fields with frozen coefficients.
 We have simplified the definition so that it's application for the purposes
 of this note will be easily understood.
 
\end_layout

\begin_layout Section
Fundamentals
\begin_inset CommandInset label
LatexCommand label
name "sec:Fundamentals"

\end_inset


\end_layout

\begin_layout Standard
In this section we briefly review some of the fundamental theory needed
 to understand the RK-MK method.
 
\end_layout

\begin_layout Subsection
Tangent Bundle
\end_layout

\begin_layout Standard
Consider the pendulum in example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:s1"

\end_inset

.
 Since the pendulum is constrained to rotate on a plane, the system evolves
 on the topological space
\series bold
 
\series default

\begin_inset Formula $S^{1}\coloneqq\left\{ \left(x,y\right)\in\mathbb{R}^{2}|x^{2}+y^{2}=1\right\} $
\end_inset

, i.e., the unit circle.
 Let the pendulum's motion be defined by a curve 
\begin_inset Formula $\gamma\left(t\right)$
\end_inset

 that is a continuous map 
\begin_inset Formula $\gamma:I\to S^{1}$
\end_inset

 defined as 
\begin_inset Formula 
\begin{equation}
\gamma\left(t\right)=\left(\cos\left(t\right)x_{0}-\sin\left(t\right)y_{0},\sin\left(t\right)x_{0}+\cos\left(t\right)y_{0}\right),\label{eq:s1_integralCurve}
\end{equation}

\end_inset

where 
\begin_inset Formula $I$
\end_inset

 is an open interval on 
\begin_inset Formula $\mathbb{R}$
\end_inset

, and 
\begin_inset Formula $\left(x_{0},y_{0}\right)\in S^{1}$
\end_inset

 is a fixed point in 
\begin_inset Formula $S^{1}$
\end_inset

.
 We can also express the curve in a more familiar form.
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "eq:Fund_xy"

\end_inset

 
\begin_inset Formula 
\begin{align}
x\left(t\right) & =\cos\left(t\right)x_{0}-\sin\left(t\right)y_{0}\\
y\left(t\right) & =\sin\left(t\right)x_{0}+\cos\left(t\right)y_{0}.
\end{align}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset

 where 
\begin_inset Formula $x\left(t\right)$
\end_inset

 and 
\begin_inset Formula $y\left(t\right)$
\end_inset

 are diffeomorphism from the interval 
\begin_inset Formula $I$
\end_inset

 to 
\begin_inset Formula $\mathbb{R}$
\end_inset

.
\end_layout

\begin_layout Standard
In order to form the corresponding ordinary differential equation, we need
 the derivative of the curve.
 Recall that the derivative of a function is defined as 
\begin_inset Formula 
\begin{equation}
\frac{d}{dt}f\left(t\right)\coloneqq\lim_{h\to0}\frac{f\left(t+h\right)-f\left(t\right)}{h}.\label{eq:derivative}
\end{equation}

\end_inset

Using the definition of a derivative we can find the derivative of the curve
 
\begin_inset Formula $\gamma\left(t\right)$
\end_inset

 as 
\begin_inset Formula 
\[
\frac{d}{dt}\gamma\left(t\right)\coloneqq\lim_{h\to0}\frac{\gamma\left(t+h\right)-\gamma\left(t\right)}{h}.
\]

\end_inset

This expression for the derivative of 
\begin_inset Formula $\gamma\left(t\right)$
\end_inset

 is subtly misleading.
 The terms 
\begin_inset Formula $\gamma\left(t+h\right)$
\end_inset

 and 
\begin_inset Formula $\gamma\left(t\right)$
\end_inset

 are elements of 
\begin_inset Formula $S^{1}$
\end_inset

, and the topological space has no addition operation defined.
 This means that the derivative cannot be computed in 
\begin_inset Formula $S^{1}$
\end_inset

.
 One possible solution is to embed 
\begin_inset Formula $S^{1}$
\end_inset

 into 
\begin_inset Formula $\mathbb{R}^{2}$
\end_inset

 which is a vector space that has addition operator defined and take the
 derivative in 
\begin_inset Formula $\mathbb{R}^{2}$
\end_inset

.
 This solution is an extrinsic method because it uses a larger dimensional
 space than the manifold.
 Extrinsic methods are good methods, but they generally produce larger errors
 than their counterpart intrinsic methods.
 Intrinsic methods uses local objects that support differentiation and then
 patches them together.
 In order to do this, we need to add additional structure to a topological
 space that maps subsets of the topological space to 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

 in a way that supports differentiation.
\end_layout

\begin_layout Definition
(
\series bold
Chart
\series default
).
 Let 
\begin_inset Formula $T$
\end_inset

 be a topological space.
 A chart is a bijective map 
\begin_inset Formula $\phi$
\end_inset

 from an open subset 
\begin_inset Formula $U$
\end_inset

 of 
\begin_inset Formula $T$
\end_inset

 to an open subspace of 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

.
 The chart is often identified as 
\begin_inset Formula $\left(U,\phi\right)$
\end_inset

 to indicate the domain on which the chart operates.
 A family of compatible charts whose union of domain is a cover of 
\begin_inset Formula $T$
\end_inset

 forms an 
\series bold
atlas
\series default
.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Definition
(
\series bold
Manifold
\series default
).
 A topological manifold (or manifold for short) is a topological space equipped
 with an atlas.
 A 
\series bold
differentiable manifold
\series default
 is a manifold whose charts are 
\begin_inset Formula $C^{k}$
\end_inset

- diffeomorphisms.
 I refer the readers to 
\begin_inset CommandInset citation
LatexCommand cite
key "Abraham1998"

\end_inset

 for a more precise definition.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
Let's return to example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:s1"

\end_inset

 where the topological space is 
\begin_inset Formula $S^{1}$
\end_inset

.
 We can equip it with the chart
\begin_inset Formula 
\begin{equation}
\phi:S^{1}\to\mathbb{R},\,\left(x,y\right)\mapsto\arctan\left(y/x\right)\label{eq:S1_phi}
\end{equation}

\end_inset

whose domain is 
\begin_inset Formula $S^{1}\backslash\left\{ \left(0,-1\right)\right\} $
\end_inset

.
 Note that we haven't created an atlas since we have not constructed a family
 of compatible charts whose union of domain is a cover of 
\begin_inset Formula $S^{1}$
\end_inset

.
 But this is not necessary for our discussion.
 We can form the composition of the curve 
\begin_inset Formula $\gamma\left(t\right)$
\end_inset

 and the chart 
\begin_inset Formula $\phi$
\end_inset

 to form the composite map 
\begin_inset Formula 
\[
\phi\circ\gamma\left(t\right):I\to\mathbb{R},\,t\mapsto\arctan\left(y\left(t\right)/x\left(t\right)\right),
\]

\end_inset

where 
\begin_inset Formula $x\left(t\right)$
\end_inset

 and 
\begin_inset Formula $y\left(t\right)$
\end_inset

 are defined in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Fund_xy"

\end_inset

.
 Since the composite map 
\begin_inset Formula $\phi\circ\gamma$
\end_inset

 is a homeomorphism whose co-domain is a vector space, we can take the derivativ
e with respect to (w.r.t.) 
\begin_inset Formula $t$
\end_inset

.
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "eq:exs1_derivative"

\end_inset


\begin_inset Formula 
\begin{align}
\frac{d}{dt}\phi\circ\gamma\left(t\right) & =\lim_{h\to0}\frac{\phi\circ\gamma\left(t+h\right)-\phi\circ\gamma\left(t\right)}{h}\\
 & =\frac{d}{dt}\arctan\left(y\left(t\right)/x\left(t\right)\right)\\
 & =\frac{\partial\arctan\left(y\left(t\right)/x\left(t\right)\right)}{\partial x}\frac{dx}{dt}+\frac{\partial\arctan\left(y\left(t\right)/x\left(t\right)\right)}{\partial y}\frac{dy}{dt}\\
 & =\frac{y\left(t\right)}{x^{2}\left(t\right)+y^{2}\left(t\right)}\frac{dx}{dt}-\frac{x\left(t\right)}{x^{2}\left(t\right)+y^{2}\left(t\right)}\frac{dy}{dt}\\
 & =y\left(t\right)\frac{dx}{dt}-x\left(t\right)\frac{dy}{dt}\\
 & =y^{2}\left(t\right)+x^{2}\left(t\right)\\
 & =1.
\end{align}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset

The derivative should make sense for our example since the map 
\begin_inset Formula $\arctan$
\end_inset

 maps the components of the ordered pair 
\begin_inset Formula $\left(x,y\right)$
\end_inset

 to the angle between them, and since the curve 
\begin_inset Formula $\gamma\left(t\right)$
\end_inset

 is rotating the point 
\begin_inset Formula $\left(x_{0},y_{0}\right)$
\end_inset

 at a constant angular velocity of 
\begin_inset Formula $1$
\end_inset

, we would expect the derivative of the angle to be 
\begin_inset Formula $1$
\end_inset

.
 The derivative that we calculated is a tangent vector at the point 
\begin_inset Formula $\phi\circ\gamma\left(t\right)$
\end_inset

 which can be written as 
\begin_inset Formula $T_{\phi\circ\gamma\left(t\right)}\mathbb{R}=1$
\end_inset

 where 
\begin_inset Formula $T_{\phi\circ\gamma\left(t\right)}\mathbb{R}$
\end_inset

 indicates the tangent space of 
\begin_inset Formula $\mathbb{R}$
\end_inset

 at the point 
\begin_inset Formula $\phi\circ\gamma\left(t\right)$
\end_inset

.
\end_layout

\begin_layout Definition
(
\series bold
Tangent Space
\series default
).

\series bold
 
\series default
Let 
\begin_inset Formula $M$
\end_inset

 be a manifold and 
\begin_inset Formula $m\in M$
\end_inset

, the tangent space of 
\begin_inset Formula $M$
\end_inset

 at the point 
\begin_inset Formula $m$
\end_inset

 is denoted 
\begin_inset Formula $T_{m}M$
\end_inset

 is the set of all tangent vectors at the point 
\begin_inset Formula $m$
\end_inset

.
 
\end_layout

\begin_layout Remark
There are many different ways to define the tangent space at a point on
 a manifold.
 We merely provide a simplified version of the coordinate approach.
 For other approaches see 
\begin_inset CommandInset citation
LatexCommand cite
key "Abraham1998,Lee2013"

\end_inset

.
\end_layout

\begin_layout Remark
So far for example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:s1"

\end_inset

 we have only defined one tangent vector at the point 
\begin_inset Formula $\phi\circ\gamma\left(t\right)$
\end_inset

.
 There are infinitely more tangent vectors that we could define at this
 point which spans all of 
\begin_inset Formula $\mathbb{R}$
\end_inset

.
 This means that 
\begin_inset Formula $T_{\phi\circ\gamma\left(t\right)}\mathbb{R}=\mathbb{R}$
\end_inset

, i.e., a vector space of 
\begin_inset Formula $\mathbb{R}$
\end_inset

 over the field of real numbers.
 In fact at each point 
\begin_inset Formula $p\in\mathbb{R}$
\end_inset

 there is a tangent space 
\begin_inset Formula $T_{p}\mathbb{R}$
\end_inset

.
 The union of all of these disjoint tangent spaces 
\begin_inset Formula 
\[
T\mathbb{R}=\cup_{p\in\mathbb{R}}T_{p}\mathbb{R}\text{(disjoint)},
\]

\end_inset

is called the tangent bundle of 
\begin_inset Formula $\mathbb{R}$
\end_inset

 and is the ordered pair 
\begin_inset Formula $\left(p,v\right)\in T\mathbb{R}$
\end_inset

 where 
\begin_inset Formula $p$
\end_inset

 is a point in 
\begin_inset Formula $\mathbb{R}$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

 is a tangent vector at 
\begin_inset Formula $p$
\end_inset

.
 This means that 
\begin_inset Formula $T\mathbb{R}=\mathbb{R}\times\mathbb{R}$
\end_inset

.
\end_layout

\begin_layout Definition
(
\series bold
Tangent Bundle
\series default
).
 Let 
\begin_inset Formula $M$
\end_inset

 be a manifold, 
\begin_inset Formula $m\in M$
\end_inset

 and 
\begin_inset Formula $T_{m}M$
\end_inset

 be the tangent space at the point 
\begin_inset Formula $m$
\end_inset

.
 The tangent bundle 
\begin_inset Formula $TM=\cup_{m\in M}T_{m}M$
\end_inset

 is the disjoint union of all of the tangent spaces.
 The projection map 
\begin_inset Formula $\pi_{M}$
\end_inset

 is the map from the tangent bundle to the manifold.
 For example let 
\begin_inset Formula $\left(m,v\right)\in TM$
\end_inset

 where 
\begin_inset Formula $m$
\end_inset

 is a tangent vector at the point 
\begin_inset Formula $m$
\end_inset

, then 
\begin_inset Formula $\pi_{M}\left(m,v\right)=m$
\end_inset

.
\end_layout

\begin_layout Standard
Returning to example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:s1"

\end_inset

.
 We have found the tangent vector of the curve 
\begin_inset Formula $\gamma$
\end_inset

 in local coordinates to be the constant value 
\begin_inset Formula $1$
\end_inset

.
 This vector resides in 
\begin_inset Formula $T_{\phi\circ\gamma\left(t\right)}\mathbb{R}$
\end_inset

, but the question is how to map it to 
\begin_inset Formula $T_{\gamma\left(t\right)}S^{1}$
\end_inset

.
 In order to do this, we need to construct the tangent bundle of our manifold
 and local coordinates, and establish a diffeomorphic map between them.
 
\end_layout

\begin_layout Standard
A quick aside on maps.
 A bijective map is a surjective and injective map which allows us to map
 elements from one space to another and back again.
 A homeomorphic map is a continuous bijective map.
 This is necessary when taking limits to ensure that map isn't 
\begin_inset Quotes eld
\end_inset

jumping around
\begin_inset Quotes erd
\end_inset

 in the co-domain.
 A diffeomorphic map is a differentiable homeomorphic map.
 The differential of a homeomorphic map, sometimes called a tangent or different
ial map, maps tangent vectors between spaces.
 
\end_layout

\begin_layout Definition
(
\series bold
Tangent of f
\series default
) Let 
\begin_inset Formula $M$
\end_inset

 and 
\begin_inset Formula $N$
\end_inset

 be two manifolds with tangent bundles 
\begin_inset Formula $TM$
\end_inset

 and 
\begin_inset Formula $TN$
\end_inset

.
 If 
\begin_inset Formula $f:M\to N$
\end_inset

 is of class 
\begin_inset Formula $C^{1}$
\end_inset

, then the tangent map or differential map is the map 
\begin_inset Formula $Tf:TM\to TN$
\end_inset

.
\end_layout

\begin_layout Standard
The tangent map 
\begin_inset Formula $T\phi$
\end_inset

 in example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:s1"

\end_inset

 is easy to calculate since we already calculated it in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:exs1_derivative"

\end_inset

.
 
\begin_inset Formula 
\begin{equation}
T\phi:TS^{1}\to T\mathbb{R},\,\left(\left(x,y\right),\left(\dot{x},\dot{y}\right)\right)\to y\dot{x}-x\dot{y},\label{eq:S1_Tphi}
\end{equation}

\end_inset

or in matrix notation
\begin_inset Formula 
\[
\begin{bmatrix}y & -x\end{bmatrix}\begin{bmatrix}\dot{x}\\
\dot{y}
\end{bmatrix}.
\]

\end_inset


\end_layout

\begin_layout Standard
The inverse tangent map is little tricky to calculate.
 We need to make use of the constraint on 
\begin_inset Formula $S^{1}$
\end_inset

 that 
\begin_inset Formula $x^{2}+y^{2}=1$
\end_inset

.
 Recall that if we have a curve 
\begin_inset Formula $\gamma\left(t\right):I\to S^{1}$
\end_inset

, then we can write an element of 
\begin_inset Formula $S^{1}$
\end_inset

 as 
\begin_inset Formula $\left(x\left(t\right),y\left(t\right)\right)$
\end_inset

 as in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Fund_xy"

\end_inset

, and write the constraint as 
\begin_inset Formula $x^{2}\left(t\right)+y^{2}\left(t\right)=1$
\end_inset

.
 Taking the derivative of this constraint yields a holonomic constraint
 on the velocities 
\begin_inset Formula 
\begin{equation}
x\dot{x}+y\dot{y}=0.\label{eq:s1_derv_constraint}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We also need to utilize the inverse map 
\begin_inset Formula $\phi^{-1}:\mathbb{R}\to S^{1}$
\end_inset

 which is defined as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{subequations}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "eq_s1_phi_inv"

\end_inset

 
\begin_inset Formula 
\begin{align}
x & =\frac{1}{\sqrt{\tan^{2}\left(\theta\right)+1}}\\
y & =\frac{\tan^{2}\left(\theta\right)}{\sqrt{1+\tan^{2}\left(\theta\right)}},
\end{align}

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subequations}
\end_layout

\end_inset

where 
\begin_inset Formula $\theta=\phi\left(x,y\right)$
\end_inset

.
 Starting with the tangent map 
\begin_inset Formula $T\phi$
\end_inset

 we have 
\begin_inset Formula 
\begin{align*}
\dot{\theta} & =y\dot{x}+x\dot{y},
\end{align*}

\end_inset

where 
\begin_inset Formula $\dot{\theta}=\frac{d}{dt}\phi\circ\gamma\left(t\right)$
\end_inset

, and the dependence on 
\begin_inset Formula $t$
\end_inset

 is implicit.
 Using the constraint 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:s1_derv_constraint"

\end_inset

 with 
\begin_inset Formula $T\phi$
\end_inset

 we get 
\begin_inset Formula 
\begin{align*}
\dot{x} & =\dot{\theta}y\\
\dot{y} & =-\dot{\theta}x,
\end{align*}

\end_inset

and finally using the definition of 
\begin_inset Formula $\phi^{-1}$
\end_inset

 we get 
\begin_inset Formula 
\begin{align*}
\dot{x} & =\dot{\theta}\frac{\tan^{2}\left(\theta\right)}{\sqrt{1+\tan^{2}\left(\theta\right)}}\\
\dot{y} & =-\dot{\theta}\frac{1}{\sqrt{\tan^{2}\left(\theta\right)+1}}.
\end{align*}

\end_inset

Using matrix notation we define the inverse tangent map 
\begin_inset Formula $T\phi^{-1}:T\mathbb{R}\to TS^{1}$
\end_inset

 as 
\begin_inset Formula 
\begin{equation}
\left(\theta,\dot{\theta}\right)\mapsto\begin{bmatrix}\frac{\tan^{2}\left(\theta\right)}{\sqrt{1+\tan^{2}\left(\theta\right)}}\\
-\frac{1}{\sqrt{\tan^{2}\left(\theta\right)+1}}
\end{bmatrix}\dot{\theta}.\label{eq:s1_Tphi_inverse}
\end{equation}

\end_inset

We can now use the inverse tangent map to map the tangent vector 
\begin_inset Formula $\dot{\theta}=1$
\end_inset

 at 
\begin_inset Formula $\theta$
\end_inset

 found in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:exs1_derivative"

\end_inset

 to 
\begin_inset Formula $T_{\gamma\left(t\right)}S^{1}$
\end_inset

.
 This is merely 
\begin_inset Formula 
\[
\begin{bmatrix}-\frac{\tan^{2}\left(\theta\right)}{\sqrt{1+\tan^{2}\left(\theta\right)}}\\
\frac{1}{\sqrt{\tan^{2}\left(\theta\right)+1}}
\end{bmatrix}.
\]

\end_inset

Using 
\begin_inset Formula $\phi^{-1}$
\end_inset

 we can express it in terms of 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

,
\begin_inset Formula 
\[
\begin{bmatrix}y\\
-x
\end{bmatrix},
\]

\end_inset

which implies that 
\begin_inset Formula 
\[
\frac{d}{dt}\gamma\left(t\right)=\begin{bmatrix}y\left(t\right)\\
-x\left(t\right)
\end{bmatrix},
\]

\end_inset

where 
\begin_inset Formula $x\left(t\right)$
\end_inset

 and 
\begin_inset Formula $y\left(t\right)$
\end_inset

 are defined in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:Fund_xy"

\end_inset

.
\end_layout

\begin_layout Standard
Putting everything together that we have so far for example 
\begin_inset CommandInset ref
LatexCommand eqref
reference "exa:s1"

\end_inset

 we have the following diagram which shows how to map between the manifolds
 
\begin_inset Formula $S^{1}$
\end_inset

 and 
\begin_inset Formula $\mathbb{R}$
\end_inset

, and their corresponding tangent bundles.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/S1TangentBundle.pdf
	width 30col%

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The last thing we need to talk about are vector fields and flows in order
 to complete the diagram.
 
\end_layout

\begin_layout Subsection
Vector Fields and Flows
\end_layout

\begin_layout Definition
(
\series bold
Vector field
\series default
).
 A vector field 
\begin_inset Formula $X\in\mathfrak{X}\left(M\right)$
\end_inset

 is a map 
\begin_inset Formula $X:M\to TM$
\end_inset

 from the manifold 
\begin_inset Formula $M$
\end_inset

 to the tangent space 
\begin_inset Formula $TM$
\end_inset

.
 
\end_layout

\begin_layout Standard
In example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:s1"

\end_inset

 we have already calculated a tangent vector in 
\begin_inset Formula $S^{1}$
\end_inset

 to be 
\begin_inset Formula 
\begin{align*}
\begin{bmatrix}\dot{x}\\
\dot{y}
\end{bmatrix} & =\begin{bmatrix}y\\
-x
\end{bmatrix},
\end{align*}

\end_inset

thus the vector field associated with this tangent vector is 
\begin_inset Formula 
\begin{equation}
X\left(x,y\right)=\begin{bmatrix}y\\
-x
\end{bmatrix}.\label{eq:s1_X}
\end{equation}

\end_inset

It turns out that this specific vector field is a basis of all possible
 vector fields on 
\begin_inset Formula $S^{1}$
\end_inset

.
 Thus all vector fields on 
\begin_inset Formula $S^{1}$
\end_inset

 can be written in as 
\begin_inset Formula 
\[
f\left(t,\left(x,y\right)\right)X\left(x,y\right)
\]

\end_inset

where 
\begin_inset Formula $f:\mathbb{R}\times S^{1}\to\mathbb{R}$
\end_inset

.
 The corresponding vector field in local coordinates is 
\begin_inset Formula 
\begin{equation}
Y\left(\theta\right)=1,\label{eq:S1_y}
\end{equation}

\end_inset

which is also a basis for all possible vector fields on 
\begin_inset Formula $\mathbb{R}^{1}$
\end_inset

.
\end_layout

\begin_layout Standard
The two vector fields 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are 
\begin_inset Formula $\phi$
\end_inset

-related.
\end_layout

\begin_layout Definition
(
\begin_inset Formula $\phi$
\end_inset

-
\series bold
related
\series default
).
 Let 
\begin_inset Formula $\phi:M\to N$
\end_inset

 be a 
\begin_inset Formula $C^{r}$
\end_inset

 mapping of manifolds.
 The vector fields 
\begin_inset Formula $X\in\mathfrak{X}^{r-1}\left(M\right)$
\end_inset

 and 
\begin_inset Formula $Y\in\mathfrak{X}^{r-1}\left(N\right)$
\end_inset

 are called 
\begin_inset Formula $\phi$
\end_inset

-related, denoted 
\begin_inset Formula $X\sim_{\phi}Y$
\end_inset

, if 
\begin_inset Formula $T\phi\circ X=Y\circ\phi$
\end_inset

, i.e., the following diagram commutes
\end_layout

\begin_layout Definition
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/VectorFields_mapRelated.pdf
	width 40col%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Definition
Showing that 
\begin_inset Formula $X\in\mathfrak{X}\left(S^{1}\right)$
\end_inset

 and 
\begin_inset Formula $Y\in\mathfrak{X}\left(\mathbb{R}\right)$
\end_inset

 are 
\begin_inset Formula $\phi$
\end_inset

-related is rather trivial since we have already defined all of the vector
 fields, the map, and the tangent map.
 Using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:S1_phi"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:S1_Tphi"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:s1_X"

\end_inset

, and 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:S1_y"

\end_inset

 we show that 
\begin_inset Formula $X\sim_{\phi}Y$
\end_inset

, 
\begin_inset Formula 
\begin{align*}
T\phi\circ X & =Y\circ\phi\\
y\dot{x}-x\dot{y} & =Y\circ\arctan\left(y/x\right)\\
y^{2}+x^{2} & =1\\
1 & =1.
\end{align*}

\end_inset

In other words, the following diagram commutes
\end_layout

\begin_layout Definition
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/S1_phiRelated.pdf
	width 40col%

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Definition
Since 
\begin_inset Formula $\phi$
\end_inset

 in example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:s1"

\end_inset

 is a diffeomorphism, the vector fields 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are not only 
\begin_inset Formula $\phi$
\end_inset

-related, but also 
\begin_inset Formula $\phi^{-1}$
\end_inset

-related, i.e., the following diagram commutes
\end_layout

\begin_layout Definition
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/s1_phiInvRelated.pdf
	width 40col%

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The vector field 
\begin_inset Formula $X$
\end_inset

 from example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:s1"

\end_inset

 was derived from the curve 
\begin_inset Formula $\gamma\left(t\right)$
\end_inset

 defined in 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:s1_integralCurve"

\end_inset

.
 This curve is called integral curve of 
\begin_inset Formula $X\in\mathfrak{X}\left(S^{1}\right)$
\end_inset

 at 
\begin_inset Formula $\left(x_{o},y_{o}\right)$
\end_inset

.
 
\end_layout

\begin_layout Definition
(
\series bold
Integral curve
\series default
).
 An integral curve of 
\begin_inset Formula $X\in\mathfrak{X}\left(M\right)$
\end_inset

 at 
\begin_inset Formula $m\in M$
\end_inset

 is a curve 
\begin_inset Formula $\gamma\left(t\right)$
\end_inset

 such that 
\begin_inset Formula $\dot{\gamma}\left(t\right)=X\left(\gamma\left(t\right)\right)$
\end_inset

 where 
\begin_inset Formula $t$
\end_inset

 is an element of the interval 
\begin_inset Formula $I\subseteq\mathbb{R}$
\end_inset

 that includes the 
\begin_inset Formula $0$
\end_inset

 element and 
\begin_inset Formula $\gamma\left(0\right)=m$
\end_inset

.
\end_layout

\begin_layout Standard
Finding integral curves is the same as finding the solution to an ODE.
 According to the 
\series bold
Local Existence, Uniqueness, and Smoothness Theorem 
\series default

\begin_inset CommandInset citation
LatexCommand cite
after "THM 4.1.5"
key "Abraham1998"

\end_inset

, if a vector field 
\begin_inset Formula $X\in\mathfrak{X}\left(M\right)$
\end_inset

 is a smooth vector field, then there is a unique integral curve 
\begin_inset Formula $\gamma\left(t\right)$
\end_inset

 of 
\begin_inset Formula $X$
\end_inset

 at 
\begin_inset Formula $m$
\end_inset

, and this integral curve is also unique in local coordinates.
 This theorem says that any smooth ODE has a unique integral curve (i.e.,
 solution) in any local coordinates.
 This theorem is very applicable because we often do not start out with
 an integral curve and derive the vector fields as we did for example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:s1"

\end_inset

, rather we start out with an ODE and solve for the integral curve.
 This theorem tells us when a unique solution exists.
 This is very helpful even in circumstances where we cannot solve the ODE,
 because we can still move along the integral curve by moving along the
 vector fields in infinitesimal increments knowing that it is unique.
\end_layout

\begin_layout Standard
An integral curve might not exist at every point 
\begin_inset Formula $m\in M$
\end_inset

 or for all 
\begin_inset Formula $t\in\mathbb{R}$
\end_inset

.
 For example consider the manifold 
\begin_inset Formula $M=\mathbb{R}^{2}\backslash\left\{ 0\right\} $
\end_inset

 with the vector field 
\begin_inset Formula $\frac{\partial}{\partial x}$
\end_inset

.
 The corresponding integral curve is 
\begin_inset Formula $\gamma\left(t\right)=\left(x+t,y\right)$
\end_inset

 for any 
\begin_inset Formula $\left(x,y\right)\in M$
\end_inset

.
 The integral curve exists until 
\begin_inset Formula $\left(x+t\right)=0$
\end_inset

 since the curve is no longer on the manifold at this time.
 This means that the domain of the integral curve is 
\begin_inset Formula $t\in\left(x,\infty\right)$
\end_inset

 for 
\begin_inset Formula $x<0$
\end_inset

 or 
\begin_inset Formula $t\in\left(-\infty,-x\right)$
\end_inset

 for 
\begin_inset Formula $x>0$
\end_inset

.
 
\end_layout

\begin_layout Definition
(
\series bold
Complete Vector Field
\series default
).
 Given a manifold 
\begin_inset Formula $M$
\end_inset

 and a vector field 
\begin_inset Formula $X$
\end_inset

, let 
\begin_inset Formula $\mathcal{D}_{x}\subseteq\mathbb{R}\times M$
\end_inset

 be the set of the ordered pair 
\begin_inset Formula $\left(m,t\right)\in\mathbb{R}\times M$
\end_inset

 such that there is an integral curve 
\begin_inset Formula $\gamma\left(t\right):I\to M$
\end_inset

 of 
\begin_inset Formula $X$
\end_inset

 at 
\begin_inset Formula $m$
\end_inset

 with 
\begin_inset Formula $t\in I\subseteq\mathbb{R}$
\end_inset

.
 If the set 
\begin_inset Formula $\mathcal{D}_{x}=\mathbb{R}\times M$
\end_inset

, then the vector field is called complete.
 
\end_layout

\begin_layout Standard
What this definition is saying is, if you start at any point in 
\begin_inset Formula $M$
\end_inset

 and move along the vector field for any 
\begin_inset Formula $t\in\mathbb{R}$
\end_inset

 you will always stay in 
\begin_inset Formula $M$
\end_inset

.
 Showing that a vector field is complete can be very difficult.
 Fortunately there are theorems 
\begin_inset CommandInset citation
LatexCommand cite
after "Theorem 9.16 and Theorem 9.18"
key "Lee2013"

\end_inset

 that show that on a compact smooth manifold, every smooth vector field
 is complete, and every left-invariant vector field on a Lie group is complete.
 Similarly, it can be proven that every right-invariant vector field on
 a Lie group is also complete.
 
\end_layout

\begin_layout Standard
In example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:s1"

\end_inset

, the manifold 
\begin_inset Formula $S^{1}$
\end_inset

 is a compact smooth manifold which means that every vector field on this
 manifold is complete and every associated integral curve exist at every
 point 
\begin_inset Formula $s\in S^{1}$
\end_inset

 for all 
\begin_inset Formula $t\in\mathbb{R}$
\end_inset

.
\end_layout

\begin_layout Standard
An object that is closely related to integral curves are flows.
\end_layout

\begin_layout Definition
(
\series bold
Flow
\series default
).
 A flow on 
\begin_inset Formula $M$
\end_inset

 is a continuous map 
\begin_inset Formula $F:\mathbb{R}\times M\to M$
\end_inset

 whose domain is called a 
\series bold
flow domain
\series default
.
 The flow domain is the open subset 
\begin_inset Formula $\mathcal{D}\subseteq\mathbb{R}\times M$
\end_inset

 with the properties that for each 
\begin_inset Formula $\left(t,m\right)\in\mathcal{D}$
\end_inset

, 
\begin_inset Formula $F\left(t,m\right)\in M$
\end_inset

, and for each 
\begin_inset Formula $m\in M$
\end_inset

, the set 
\begin_inset Formula $\mathcal{D}^{m}\coloneqq\left(t\in\mathbb{R}|\left(t,m\right)\in\mathcal{D}\right)$
\end_inset

 is an open interval containing 
\begin_inset Formula $0$
\end_inset

.
 If the domain of a flow 
\begin_inset Formula $\mathcal{D}=\mathbb{R}\times M$
\end_inset

, the flow is called a 
\series bold
global flow
\series default
, otherwise the flow is called a 
\series bold
local flow
\series default
.
 A flow satisfies the group laws: for all 
\begin_inset Formula $m\in M$
\end_inset

,
\begin_inset Formula 
\[
F\left(0,m\right)=m,
\]

\end_inset

and for all 
\begin_inset Formula $s\in\mathcal{D}^{m}$
\end_inset

 and 
\begin_inset Formula $t\in\mathcal{D}^{F\left(t,m\right)}$
\end_inset

 such that 
\begin_inset Formula $s+t\in\mathcal{D}^{m},$
\end_inset


\begin_inset Formula 
\[
F\left(t,F\left(s,m\right)\right)=F\left(t+s,m\right).
\]

\end_inset


\end_layout

\begin_layout Standard
We can evaluate a flow at a specific point 
\begin_inset Formula $m\in M$
\end_inset

 or at a specific point 
\begin_inset Formula $t\in\mathbb{R}$
\end_inset

 to create other maps.
 These maps are defined as 
\begin_inset Formula $F^{t}:M\to M,\,\mapsto F\left(t,\cdot\right)$
\end_inset

, and 
\begin_inset Formula $F^{m}:\mathbb{R}\to M,\,m\mapsto F\left(\cdot,m\right)$
\end_inset

.
 By definition, 
\begin_inset Formula $F^{m}$
\end_inset

 is an integral curve of a vector field at the point 
\begin_inset Formula $m$
\end_inset

.
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $F$
\end_inset

 is a smooth flow, the tangent vector 
\begin_inset Formula $v_{m}\in T_{m}M$
\end_inset

 corresponding to the flow 
\begin_inset Formula $F$
\end_inset

, is defined as 
\begin_inset Formula 
\begin{equation}
v_{m}=\left.\frac{d}{dt}\right|_{t=0}F\left(t,m\right).\label{eq:infiitesimal_generator}
\end{equation}

\end_inset

The assignment 
\begin_inset Formula $m\mapsto v_{m}$
\end_inset

 is a smooth vector filed 
\begin_inset Formula $X$
\end_inset

 on 
\begin_inset Formula $M$
\end_inset

 and is called an 
\series bold
infinitesimal generator of F
\series default
.
 It is called an infinitesimal generator of 
\series bold
F
\series default
 since the flow can be approximated by piecing together the tangent vectors
 generated by the vector field as you move along 
\begin_inset Formula $M$
\end_inset

.
 Also, 
\begin_inset Formula $F^{m}$
\end_inset

 is the integral curve of 
\begin_inset Formula $X$
\end_inset

 at 
\begin_inset Formula $m$
\end_inset

.
\end_layout

\begin_layout Standard
Returning to example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:s1"

\end_inset

 we defined an integral curve 
\begin_inset Formula $\gamma\left(t\right)$
\end_inset

 by 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:s1_integralCurve"

\end_inset

, the corresponding flow is 
\begin_inset Formula 
\begin{align*}
F:\mathbb{R}\times M & \to M,\,\\
\left(t,\left(x_{o},y_{o}\right)\right) & \mapsto\left(\cos\left(t\right)x_{0}-\sin\left(t\right)y_{0},\sin\left(t\right)x_{0}+\cos\left(t\right)y_{0}\right).
\end{align*}

\end_inset

The infinitesimal generator is constructed using 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:infiitesimal_generator"

\end_inset


\begin_inset Formula 
\begin{align*}
X\left(s\right) & =\left.\frac{d}{dt}\right|_{t=0}F\left(t,\cdot\right)\\
 & =\left(-\sin\left(t\right)x_{0}-\cos\left(t\right)y_{0},\cos\left(t\right)x_{0}-\sin\left(t\right)y_{0}\right),
\end{align*}

\end_inset

or in matrix notation
\begin_inset Formula 
\[
X\left(s\right)=\begin{bmatrix}-\sin\left(t\right) & -\cos\left(t\right)\\
\cos\left(t\right) & -\sin\left(t\right)
\end{bmatrix}\begin{bmatrix}x_{0}\\
y_{0}
\end{bmatrix},
\]

\end_inset

where 
\begin_inset Formula $s=\left(x_{0},y_{0}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
In a similar way in which vector fields on different manifolds can be related
 via a map, flows can be related via a map.
 To discuss this, we need to define additional notation.
 For each 
\begin_inset Formula $t\in\mathbb{R}$
\end_inset

, we define 
\begin_inset Formula 
\[
M_{t}\coloneqq\left\{ m\in M|\left(t,m\right)\in\mathcal{D}\right\} ,
\]

\end_inset

where 
\begin_inset Formula $\mathcal{D}$
\end_inset

 is the flow domain of the flow 
\begin_inset Formula $F$
\end_inset

.
\end_layout

\begin_layout Proposition
(
\series bold
Naturality of Flows
\series default
).
\begin_inset CommandInset label
LatexCommand label
name "prop:(Naturality-of-Flows)."

\end_inset

 Suppose 
\begin_inset Formula $M$
\end_inset

 and 
\begin_inset Formula $N$
\end_inset

 are smooth manifolds, 
\begin_inset Formula $\phi:M\to N$
\end_inset

, a smooth map, 
\begin_inset Formula $X\in\mathfrak{X}\left(M\right)$
\end_inset

, and 
\begin_inset Formula $Y\in\mathfrak{X}\left(N\right)$
\end_inset

.
 Let 
\begin_inset Formula $F_{X}$
\end_inset

 be the flow of 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $F_{Y}$
\end_inset

 be the flow of 
\begin_inset Formula $N$
\end_inset

.
 If 
\begin_inset Formula $X\sim_{\phi}Y$
\end_inset

, then for each 
\begin_inset Formula $t\in\mathbb{R}$
\end_inset

, 
\begin_inset Formula $\phi\left(M_{t}\right)\subseteq N_{t}$
\end_inset

 and 
\begin_inset Formula $F_{Y}\circ\phi=\phi\circ F_{X}$
\end_inset

 on 
\begin_inset Formula $M_{t}$
\end_inset

:
\end_layout

\begin_layout Proposition
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/NaturalityOfFlows.pdf
	width 40col%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Proposition
See 
\begin_inset CommandInset citation
LatexCommand cite
after "Proposition 9.13"
key "Lee2013"

\end_inset

 for proof.
\end_layout

\begin_layout Standard
The Naturality of flows allows a flow defined on one manifold to be pulled
 back or pushed forward to another.
 
\end_layout

\begin_layout Corollary
(
\series bold
Diffeomorphism Invariance of Flows
\series default
).
 Let 
\begin_inset Formula $\phi:M\to N$
\end_inset

 be a diffeomorphism.
 If 
\begin_inset Formula $X\in\mathfrak{X}\left(M\right)$
\end_inset

 is a vector field defined on 
\begin_inset Formula $M$
\end_inset

, then we can define a vector field 
\begin_inset Formula $Y\in\mathfrak{X}\left(N\right)$
\end_inset

 using the push forward.
 The push forward of 
\begin_inset Formula $X$
\end_inset

 is defined as 
\begin_inset Formula $Y=\phi_{*}X=T\phi\circ X\circ\phi^{-1}$
\end_inset

.
 Since 
\begin_inset Formula $X$
\end_inset

 is defined, we have the flow 
\begin_inset Formula $F_{X}$
\end_inset

 defined on 
\begin_inset Formula $M$
\end_inset

 which we can push forward to 
\begin_inset Formula $N$
\end_inset

 to define the flow 
\begin_inset Formula $F_{Y}$
\end_inset

 on 
\begin_inset Formula $N$
\end_inset

 whose corresponding vector field is 
\begin_inset Formula $Y=\phi_{*}X$
\end_inset

.
 The push forward of 
\begin_inset Formula $F_{X}$
\end_inset

 is defined as 
\begin_inset Formula $F_{Y}=\phi_{*}F_{X}=\phi\circ F_{X}\circ\phi^{-1}$
\end_inset

.
 Likewise if 
\begin_inset Formula $Y$
\end_inset

 and 
\begin_inset Formula $F_{Y}$
\end_inset

 are defined on 
\begin_inset Formula $N$
\end_inset

, then we can pull the vector field and flow back to 
\begin_inset Formula $M$
\end_inset

.
 The pull back of 
\begin_inset Formula $Y$
\end_inset

 is defined as 
\begin_inset Formula $X=\phi^{*}Y=T\phi^{-1}\circ Y\circ\phi$
\end_inset

, and the pull back of 
\begin_inset Formula $F_{Y}$
\end_inset

 is defined as 
\begin_inset Formula $F_{X}=\phi^{*}F_{Y}=\phi^{-1}\circ F_{Y}\circ\phi$
\end_inset

.
\end_layout

\begin_layout Standard
Returning to example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:s1"

\end_inset

 we have the vector fields 
\begin_inset Formula $X\in\mathfrak{X}\left(S^{1}\right)$
\end_inset

 and 
\begin_inset Formula $Y\in\mathfrak{X}\left(\mathbb{R}\right)$
\end_inset

, the maps 
\begin_inset Formula $\phi$
\end_inset

, 
\begin_inset Formula $\phi^{-1}$
\end_inset

, the tangent maps 
\begin_inset Formula $T\phi$
\end_inset

, 
\begin_inset Formula $T\phi^{-1}$
\end_inset

, and the flows 
\begin_inset Formula $F_{X}$
\end_inset

 and 
\begin_inset Formula $F_{Y}$
\end_inset

 previously defined.
 We defined the vector field 
\begin_inset Formula $X$
\end_inset

 by pulling back the vector filed 
\begin_inset Formula $Y$
\end_inset

, 
\begin_inset Formula $X=\phi^{*}Y$
\end_inset

, and we defined the flow 
\begin_inset Formula $F_{Y}$
\end_inset

 by pushing forward the flow 
\begin_inset Formula $F_{X}$
\end_inset

, 
\begin_inset Formula $F_{Y}=\phi_{*}F_{X}$
\end_inset

.
 
\end_layout

\begin_layout Subsection
Summary
\end_layout

\begin_layout Standard
The main idea from this section is that not every manifold is a vector space
 which means that we cannot perform calculus directly on the space.
 Instead, these manifolds can be mapped to Euclidean space using charts
 via local coordinates.
 In these local coordinates, we can perform calculus to define tangent vectors
 and vector fields.
 These tangent vectors can be mapped to the tangent space of the manifold,
 and the vector fields defined in Euclidean space can be pulled back to
 the manifold.
 In addition, we can perform integration or move along flows in local coordinate
s, and map them back to the manifold.
 
\end_layout

\begin_layout Section
Lie Group Actions and Equivariant Maps
\end_layout

\begin_layout Standard
In this section we explore how Lie group actions and their corresponding
 Lie algebra actions are flows on manifolds that generate infinitesimal
 generators.
 We will mostly follow the work of Eng
\begin_inset IPA

\begin_layout Standard
ø
\end_layout

\end_inset

 in 
\begin_inset CommandInset citation
LatexCommand cite
key "Engo2000,Engo2003"

\end_inset

.
\end_layout

\begin_layout Definition
(
\series bold
Matrix Lie group
\series default
).
 A matrix Lie group is a subgroup of 
\begin_inset Formula $GL\left(n;\mathbb{C}\right)$
\end_inset

 that is a smooth manifold 
\begin_inset Formula $G$
\end_inset

 with the property that the multiplication map 
\begin_inset Formula $m:G\times G\to G$
\end_inset

 and inversion map 
\begin_inset Formula $i:G\to G$
\end_inset

 defined as 
\begin_inset Formula 
\[
m\left(g,h\right)=gh,\quad i\left(g\right)=g^{-1}
\]

\end_inset

are smooth maps.
\end_layout

\begin_layout Standard
One example of a matrix Lie group is 
\begin_inset Formula $SO\left(2\right)\coloneqq\left\{ R\in\mathbb{R}^{2\times2}|R^{\top}R=1,\,\det\left(R\right)=1\right\} $
\end_inset

 which is the set of all rotation isometries in 
\begin_inset Formula $\mathbb{R}^{2}$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Definition
(
\series bold
Group Action
\series default
)
\begin_inset CommandInset label
LatexCommand label
name "def:(Group-Action).-Let"

\end_inset

.
 Let 
\begin_inset Formula $M$
\end_inset

 be a manifold and let 
\begin_inset Formula $\left(G,\cdot\right)$
\end_inset

 be a group.
 A left action of 
\begin_inset Formula $G$
\end_inset

 on 
\begin_inset Formula $M$
\end_inset

 is a map 
\begin_inset Formula $\Phi:G\times M\to M$
\end_inset

 satisfying
\begin_inset Formula 
\[
\Phi\left(e,m\right)=m,\quad\Phi\left(g_{2},\Phi\left(g_{1},m\right)\right)=\Phi\left(g_{2}\cdot g_{1},m\right)
\]

\end_inset

for all 
\begin_inset Formula $m\in M$
\end_inset

.
 Similarly, a right action of 
\begin_inset Formula $G$
\end_inset

 on 
\begin_inset Formula $M$
\end_inset

 is a map 
\begin_inset Formula $\Phi:M\times G\to M$
\end_inset

 satisfying
\begin_inset Formula 
\[
\Phi\left(m,e\right)=m,\quad\Phi\left(\Phi\left(m,g_{1}\right),g_{2}\right)=\Phi\left(m,g_{1}\cdot g_{2}\right)
\]

\end_inset

 for all 
\begin_inset Formula $m\in M$
\end_inset

.
 An action 
\begin_inset Formula $\Phi$
\end_inset

 is class 
\begin_inset Formula $C^{r}$
\end_inset

 if 
\begin_inset Formula $\Phi$
\end_inset

 is a 
\begin_inset Formula $C^{r}$
\end_inset

-map, and is smooth if 
\begin_inset Formula $\Phi$
\end_inset

 is a 
\begin_inset Formula $C^{\infty}$
\end_inset

-map.
\end_layout

\begin_layout Standard
An important property of groups actions to consider is the transitive property.
 A group action is called 
\emph on
transitive
\emph default
 if, for all 
\begin_inset Formula $m_{1},m_{2}\in M$
\end_inset

 there exists an element 
\begin_inset Formula $g\in G$
\end_inset

 such that 
\begin_inset Formula $m_{2}=\Phi\left(g,m_{1}\right)$
\end_inset

 if the action is a left action or 
\begin_inset Formula $m_{2}=\Phi\left(m_{1},g\right)$
\end_inset

 if the action is a right action.
 Basically what this means is that from any element 
\begin_inset Formula $m\in M$
\end_inset

 the group action can map it to any other element in 
\begin_inset Formula $M$
\end_inset

.
 
\end_layout

\begin_layout Standard
In example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:s1"

\end_inset

, let the group be 
\begin_inset Formula $SO\left(2\right)$
\end_inset

, then the left group action in matrix notation is 
\begin_inset Formula 
\[
s_{2}=R\begin{bmatrix}x\\
y
\end{bmatrix},
\]

\end_inset

and the right group action is 
\begin_inset Formula 
\[
s_{2}=\begin{bmatrix}x & y\end{bmatrix}R,
\]

\end_inset

where 
\begin_inset Formula $\left(x,y\right)\in S^{1}$
\end_inset

.
 It can also be shown that the group action is transitive.
\end_layout

\begin_layout Standard
Before we continue, we need to define additional maps.
 If 
\begin_inset Formula $\Phi$
\end_inset

 is a group action of 
\begin_inset Formula $G$
\end_inset

 on 
\begin_inset Formula $M$
\end_inset

, then we define the maps 
\begin_inset Formula $\Phi_{g}:M\to M,\,g\mapsto\Phi\left(g,\cdot\right)$
\end_inset

 and 
\begin_inset Formula $\Phi_{m}:G\to M,\,m\mapsto\Phi\left(\cdot,m\right)$
\end_inset

 for left actions and 
\begin_inset Formula $\Phi_{g}:M\to M,\,g\mapsto\Phi\left(\cdot,g\right)$
\end_inset

 and 
\begin_inset Formula $\Phi_{m}:G\to M,\,m\mapsto\Phi\left(m,\cdot\right)$
\end_inset

 for right actions.
 A group action on itself will be denoted 
\begin_inset Formula $L_{g}:G\to G,\,g\mapsto\Phi\left(g,\cdot\right)$
\end_inset

 for left actions and 
\begin_inset Formula $R_{g}:G\to G,\,g\mapsto\Phi\left(\cdot,g\right)$
\end_inset

.
\end_layout

\begin_layout Definition
(
\series bold
Equivariant map
\series default
\emph on
).
 
\emph default
Let 
\begin_inset Formula $\left(M,G,\Phi\right)$
\end_inset

 and 
\begin_inset Formula $\left(N,G,\Psi\right)$
\end_inset

 be two homogenous spaces.
 The map 
\begin_inset Formula $\phi:M\to N$
\end_inset

 is an equivariant map (or 
\begin_inset Formula $\phi$
\end_inset

-equivariant) if 
\begin_inset Formula $\phi\circ\Phi_{g}=\psi_{g}\circ\phi$
\end_inset

, i.e.
 the following diagram commutes
\end_layout

\begin_layout Definition
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/EquivariantMaps.pdf
	width 40col%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Every Lie group has local coordinates referred to as its Lie algebra which
 we will denote as 
\begin_inset Formula $\mathfrak{g}$
\end_inset

.
 We will restrict the rest of our discussion to restricting the groups 
\begin_inset Formula $G$
\end_inset

 to matrix Lie groups; however, this theory has been generalized to any
 group.
 There are different local coordinates that we can use for matrix Lie groups,
 but we will stick with using the canonical coordinates of the first kind
 which is the matrix exponential mapping defined as 
\begin_inset Formula $\exp:\mathfrak{g}\to G$
\end_inset

 and 
\begin_inset Formula $\exp^{-1}:G\to\mathfrak{g}$
\end_inset

 where 
\begin_inset Formula $\exp^{-1}$
\end_inset

 is the matrix logarithm.
 We quickly note that this is a chart of 
\begin_inset Formula $G$
\end_inset

 whose domain is not all of 
\begin_inset Formula $G$
\end_inset

.
 The Lie algebra of the group 
\begin_inset Formula $G$
\end_inset

 is a space where addition and scalar multiplication is defined; it is a
 space where we can perform numeric integration.
\end_layout

\begin_layout Standard
The goal is to relate Lie group actions to flows, and in order to do this,
 we need to construct an equivariant map between the Lie algebra, the Lie
 group, and the manifold 
\begin_inset Formula $M$
\end_inset

.
 We already have an equivariant map between the Lie group and Lie algebra,
 thus we need to pull back the group action of 
\begin_inset Formula $G$
\end_inset

 on itself to 
\begin_inset Formula $\mathfrak{g}$
\end_inset

.
 
\end_layout

\begin_layout Standard
We can pull back a group action of 
\begin_inset Formula $G$
\end_inset

 on itself to 
\begin_inset Formula $\mathfrak{g}$
\end_inset

 using the exponential mapping in a way similar to the pull back of a flow.
 Let 
\begin_inset Formula $B_{g}=\exp_{*}R_{g}$
\end_inset

 be the pullback of the right group action, then 
\begin_inset Formula $B_{g}$
\end_inset

 is defined as 
\begin_inset Formula 
\begin{align*}
B_{g} & \coloneqq\exp^{-1}\circ R_{g}\circ\exp\\
B_{g}\left(u\right) & =\log\left(\exp\left(u\right)g\right).
\end{align*}

\end_inset


\begin_inset Formula $B_{g}$
\end_inset

 could have been using the left group action.
 With the construction of 
\begin_inset Formula $B_{g}$
\end_inset

, we have the following diagram that commutes
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/EquivariantMaps3.pdf
	width 40col%

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Since the Lie algebra is a local coordinate of 
\begin_inset Formula $G$
\end_inset

, by definition of a chart, the exponential map must be bijective, and in
 fact it is a diffeomorphism.
 In addition, since 
\begin_inset Formula $G$
\end_inset

 is a matrix Lie group, the actions of 
\begin_inset Formula $G$
\end_inset

 are smooth.
 Since 
\begin_inset Formula $B_{g}$
\end_inset

 is a composition of smooth maps, it is also smooth.
 Depending on the map 
\begin_inset Formula $\phi_{M}$
\end_inset

, it may or may not be bijective, but we only need to require it to be of
 class 
\begin_inset Formula $C^{1}$
\end_inset

.
 The purpose of these properties will be made clear in the following sections.
 
\end_layout

\begin_layout Standard
Returning to example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:s1"

\end_inset

, we have the homogenous space 
\begin_inset Formula $\left(S^{1},SO\left(2\right),\Phi\right)$
\end_inset

 where 
\begin_inset Formula $S^{1}$
\end_inset

 is the manifold on which an ODE is evolving, 
\begin_inset Formula $SO\left(2\right)$
\end_inset

 is a matrix Lie group, and 
\begin_inset Formula $\Phi$
\end_inset

 is the group action.
 In this example, we will define the group action as a left group action
 such that 
\begin_inset Formula 
\begin{align*}
\Phi:SO\left(2\right)\times S^{1} & \to S^{1},\,\left(R,s\right)\mapsto Rs\\
\Phi_{R}:S^{1} & \to S^{1},\,s\mapsto Rs\\
\Phi_{s}:SO\left(2\right) & \to S^{1},\,R\mapsto Rs,
\end{align*}

\end_inset

where 
\begin_inset Formula $s$
\end_inset

 is a column matrix representation of an element of 
\begin_inset Formula $S^{1}$
\end_inset

.
 We also define the group action on itself as the left group action 
\begin_inset Formula 
\[
L_{R}:SO\left(2\right)\to SO\left(2\right),\,RH,
\]

\end_inset

where 
\begin_inset Formula $H\in SO\left(2\right)$
\end_inset

.
 The Lie algebra of 
\begin_inset Formula $SO\left(2\right)$
\end_inset

 is 
\begin_inset Formula $\mathfrak{so}\left(2\right)\coloneqq\left\{ u\in\mathbb{R}^{2\times2}|u^{\top}+u=0\right\} $
\end_inset

, i.e., the set of 2 dimensional skew symmetric matrices.
 The mapping between the Lie algebra and the Lie group is the exponential
 map, and the pull back of the Lie group action onto the Lie algebra is
 
\begin_inset Formula 
\begin{align*}
B_{R} & =\exp^{-1}\circ L_{R}\circ\exp\\
B_{R}\left(u\right) & =\log\left(R\exp\left(u\right)\right).
\end{align*}

\end_inset

We thus have the three equivalent composite maps
\begin_inset Formula 
\begin{gather*}
\Phi_{s}\circ\exp\circ B_{R}\\
\Phi_{R}\circ\Phi_{s}\circ\exp\\
\Phi_{s}\circ L_{R}\circ\exp
\end{gather*}

\end_inset


\end_layout

\begin_layout Section
Lie algebra action 
\end_layout

\begin_layout Standard
Using the exponential map, we can define an action of the Lie algebra on
 the manifold.
 This is done by replacing the group element 
\begin_inset Formula $g$
\end_inset

 by 
\begin_inset Formula $\exp\left(\xi\right)$
\end_inset

where 
\begin_inset Formula $g=\exp\left(\xi\right)$
\end_inset

 and 
\begin_inset Formula $\xi\in\mathfrak{g}$
\end_inset

, in the group actions.
 For example
\begin_inset Formula 
\begin{align*}
\Phi_{g} & =\Phi_{\exp\left(\xi\right)}\\
R_{g} & =R_{\exp\left(\xi\right)}\\
B_{g} & =B_{\exp\left(\xi\right)},
\end{align*}

\end_inset

which is expressed in the following diagram
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/EquivariantMapsLieAlgebra.pdf
	width 40col%

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Since the Lie algebra is an algebra, scalar multiplication is defined such
 that 
\begin_inset Formula $t\xi\in\mathfrak{g}$
\end_inset

 where 
\begin_inset Formula $\xi\in\mathfrak{g}$
\end_inset

 and 
\begin_inset Formula $t\in\mathbb{R}$
\end_inset

, and 
\begin_inset Formula $\exp\left(t\xi\right)\in G$
\end_inset

.
 Using this idea, we can construct a one parameter group action from every
 element in 
\begin_inset Formula $\mathfrak{g}$
\end_inset

.
\end_layout

\begin_layout Definition
(
\series bold
One Parameter Group Action
\series default
).
 A one-parameter group action is a continuous map 
\begin_inset Formula $\Phi:\mathbb{R}\times M\to M$
\end_inset

 (for left actions) or 
\begin_inset Formula $\Phi:M\times\mathbb{R}\to M$
\end_inset

 (for right actions) that adhere to the group action properties for left
 and right actions defined in definition 
\begin_inset CommandInset ref
LatexCommand ref
reference "def:(Group-Action).-Let"

\end_inset

 where the group operator is addition.
 
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $\xi\in\mathfrak{g}$
\end_inset

, 
\begin_inset Formula $\exp:\mathfrak{g}\to G$
\end_inset

, 
\begin_inset Formula $s,t\in\mathbb{R}$
\end_inset

, and 
\begin_inset Formula $m\in M$
\end_inset

, then the right one-parameter group action is 
\begin_inset Formula 
\[
\Phi\left(t,m\right)=m\exp\left(t\xi\right)
\]

\end_inset

with the properties 
\begin_inset Formula 
\begin{align*}
\Phi\left(0,m\right) & =m\\
\Phi\left(t,\Phi\left(s,m\right)\right) & =\Phi\left(t+s,m\right).
\end{align*}

\end_inset

Other continuous maps can be constructed from the one parameter group action
 by evaluating it at an element 
\begin_inset Formula $t\in\mathbb{R}$
\end_inset

 and 
\begin_inset Formula $m\in M$
\end_inset

 defined as 
\begin_inset Formula 
\begin{align*}
\Phi_{t}\left(m\right) & \coloneqq\Phi\left(t,\cdot\right)=\exp\left(t\xi\right)\left(m\right)\\
\Phi_{m}\left(t\right) & \coloneqq\Phi\left(\cdot,m\right)=m\left(G\right).
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
From the one-parameter group action on the manifold 
\begin_inset Formula $M$
\end_inset

, we can construct the corresponding group actions on 
\begin_inset Formula $G$
\end_inset

 and 
\begin_inset Formula $\mathfrak{g}$
\end_inset

 
\begin_inset Formula 
\begin{align*}
\Phi_{g} & =\Phi_{\exp\left(t\xi\right)}\\
R_{g} & =R_{\exp\left(t\xi\right)}\\
B_{g} & =B_{\exp\left(t\xi\right)},
\end{align*}

\end_inset

which is expressed in the following diagram
\end_layout

\begin_layout Quotation
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/EquivariantMapOneParam.pdf
	width 40col%

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Note that the one parameter group action describes a flow on the manifold
 
\begin_inset Formula $M$
\end_inset

, and 
\begin_inset Formula $\Phi_{m}$
\end_inset

 is the corresponding integral curve, and we constructed the flow from a
 Lie group action on the manifold.
 Not only that, but it can be shown that the corresponding vector field
 (or infinitesimal generator) is an element of the Lie algebra.
 The infinitesimal generator of the right one-parameter group action 
\begin_inset Formula $\Phi\left(t,m\right)=m\exp\left(t\xi\right)$
\end_inset

 is calculated using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:infiitesimal_generator"

\end_inset

 
\begin_inset Formula 
\begin{align*}
\left.\frac{d}{dt}\right|_{t=0}m\exp\left(t\xi\right) & =m\xi\\
 & =\xi_{M}\left(m\right).
\end{align*}

\end_inset

and 
\begin_inset Formula $\xi_{M}=\xi\in\mathfrak{g}$
\end_inset

.
 More importantly, any vector field 
\begin_inset Formula $X\in\mathfrak{X}\left(M\right)$
\end_inset

 that is liner in 
\begin_inset Formula $M$
\end_inset

 can be represented as a Lie algebra if the 
\begin_inset Formula $G$
\end_inset

-action is transitive.
 In the cases where the vector field is not linear in 
\begin_inset Formula $M$
\end_inset

, we can approximate it by using the method of frozen frames discussed in
 
\begin_inset CommandInset citation
LatexCommand cite
key "Crouch1993"

\end_inset

 which we will briefly discuss in a later section.
 
\end_layout

\begin_layout Definition
(
\series bold
Lie-Algebra Action
\series default
).
 If 
\begin_inset Formula $\mathfrak{g}$
\end_inset

 is an arbitrary finite-dimensional Lie algebra, any Lie algebra homomorphism
 
\begin_inset Formula $\lambda:\mathfrak{g}\to X\in\mathfrak{X}\left(M\right)$
\end_inset

 is a Lie algebra action on 
\begin_inset Formula $M$
\end_inset

.
 The right Lie algebra action on 
\begin_inset Formula $M$
\end_inset

 for matrix Lie groups is 
\begin_inset Formula 
\[
\lambda\coloneqq\left.\frac{d}{dt}\right|_{t=0}m\exp\left(t\xi\right),
\]

\end_inset

and the left Lie algebra action on 
\begin_inset Formula $M$
\end_inset

 for matrix Lie groups is 
\begin_inset Formula 
\[
\lambda\coloneqq\left.\frac{d}{dt}\right|_{t=0}\exp\left(t\xi\right)m.
\]

\end_inset

Note that right Lie algebra actions on 
\begin_inset Formula $M$
\end_inset

 produce left invariant vector fields on 
\begin_inset Formula $M$
\end_inset

.
\end_layout

\begin_layout Definition
Since the map 
\begin_inset Formula $\Phi_{m}$
\end_inset

 isn't necessarily a diffeomorphism, we cannot pull back a vector field
 defined on 
\begin_inset Formula $M$
\end_inset

 to 
\begin_inset Formula $G$
\end_inset

 or 
\begin_inset Formula $\mathfrak{g}$
\end_inset

; however, since we have the equivariant maps 
\begin_inset Formula $\exp$
\end_inset

 and 
\begin_inset Formula $\Phi_{m}$
\end_inset

 w.r.t.
 the flows 
\begin_inset Formula 
\begin{align*}
\Phi_{g} & =\Phi_{\exp\left(t\xi\right)}\\
R_{g} & =R_{\exp\left(t\xi\right)}\\
B_{g} & =B_{\exp\left(t\xi\right)}
\end{align*}

\end_inset

the infinitesimal generators of these flows are going to be related by the
 maps 
\begin_inset Formula $\exp$
\end_inset

 and 
\begin_inset Formula $\Phi_{m}$
\end_inset

.
 They are calculated using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:infiitesimal_generator"

\end_inset

 as 
\begin_inset Formula 
\begin{align*}
\xi_{M} & =\left.\frac{d}{dt}\right|_{t=0}\Phi_{\exp\left(t\xi\right)}\\
\xi_{G} & =\left.\frac{d}{dt}\right|_{t=0}R_{\exp\left(t\xi\right)}\\
\xi_{\mathfrak{g}} & =\left.\frac{d}{dt}\right|_{t=0}B_{\exp\left(t\xi\right)}
\end{align*}

\end_inset

and their relations are denoted as 
\begin_inset Formula 
\begin{gather*}
\xi_{\mathfrak{g}}\sim_{\exp\circ\Phi_{m}}\xi_{M}\\
\xi_{\mathfrak{g}}\sim_{\exp}\xi_{G}.
\end{gather*}

\end_inset

The following diagram depicts the relation between vector fields
\end_layout

\begin_layout Definition
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/VectorfieldRelations.pdf
	width 40col%

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

where 
\begin_inset Formula $T\Phi_{m}$
\end_inset

 is the tangent map of 
\begin_inset Formula $\Phi_{m}$
\end_inset

 and 
\begin_inset Formula $T\exp$
\end_inset

 is the tangent map of 
\begin_inset Formula $\exp$
\end_inset

.
 The question remains, what is the vector field 
\begin_inset Formula $\xi_{\mathfrak{g}}$
\end_inset

.
 Let 
\begin_inset Formula $u\in\mathfrak{g}$
\end_inset

, and using the definition of the flow 
\begin_inset Formula $B_{\exp\left(t\xi\right)}$
\end_inset

 we get 
\begin_inset Formula 
\begin{align*}
B_{\exp\left(t\xi\right)}\left(u\right) & =\log\left(\exp\left(u\right)\exp\left(t\xi\right)\right).\\
 & =z\left(t\right)
\end{align*}

\end_inset

The infinitesimal generator is constructed using 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:infiitesimal_generator"

\end_inset

 and is 
\begin_inset Formula 
\begin{align*}
\xi_{\mathfrak{g}} & =\left.\frac{d}{dt}\right|_{t=0}B_{\exp\left(t\xi\right)}\left(u\right)\\
 & =\left.\frac{d}{dt}\right|_{t=0}\log\left(\exp\left(u\right)\exp\left(t\xi\right)\right)\\
 & =\left(\frac{I-\exp\left(ad_{z\left(t\right)}\right)}{ad_{z\left(t\right)}}\right)^{-1}\xi,
\end{align*}

\end_inset

where 
\begin_inset Formula $ad_{z\left(t\right)}$
\end_inset

 is the adjoint of 
\begin_inset Formula $z\left(t\right)$
\end_inset

.
 Recall that 
\begin_inset Formula $\xi$
\end_inset

 is an element of 
\begin_inset Formula $\mathfrak{g}$
\end_inset

 which we can define as the vector field on 
\begin_inset Formula $M$
\end_inset

 by 
\begin_inset Formula $\xi_{M}$
\end_inset

, thus 
\begin_inset Formula 
\[
\xi_{\mathfrak{g}}=\left(\frac{I-\exp\left(-ad_{z\left(t\right)}\right)}{ad_{z\left(t\right)}}\right)^{-1}\xi_{M}.
\]

\end_inset

This formula is based on the 
\emph on
left trivializations
\emph default
, i.e.
 tangents at a point 
\begin_inset Formula $g\in G$
\end_inset

 being written as 
\begin_inset Formula $G\xi,\,\xi\in\mathfrak{g}$
\end_inset

 and is denoted as 
\begin_inset Formula 
\[
\text{dexp}{}_{z,l}^{-1}=\left(\frac{I-\exp\left(-ad_{z\left(t\right)}\right)}{ad_{z\left(t\right)}}\right)^{-1}
\]

\end_inset

where the subscript 
\begin_inset Formula $l$
\end_inset

 denotes that it is based on the 
\emph on
left trivializations
\emph default
 or is a left invariant vector field constructed from a left group action.
 See appendix 
\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Deriv_Exp"

\end_inset

 for more information about the derivative of the matrix exponential and
 it's inverse.
 
\end_layout

\begin_layout Definition
Now that we have a vector field defined on the Lie algebra, we can use any
 classical numerical integration technique to solve the differential equation
 in the Lie algebra and map the solution to the manifold.
 We will cover a few techniques in the next section, but before moving on
 we will apply what we presented in this section to example 
\begin_inset CommandInset ref
LatexCommand eqref
reference "exa:s1"

\end_inset

.
\end_layout

\begin_layout Definition
In example 
\begin_inset CommandInset ref
LatexCommand eqref
reference "exa:s1"

\end_inset

 we constructed the left group action.
 By using elements in the Lie algebra 
\begin_inset Formula $\xi\in\mathfrak{so}\left(2\right)$
\end_inset

 we construct the one-parameter left group action (
\begin_inset Formula $\mathbb{R}-action$
\end_inset

)
\begin_inset Formula 
\[
\Phi_{\exp\left(t\xi\right)}:\mathbb{R}\times S^{1}\to S^{1},\,\left(t,s\right)\mapsto\exp\left(t\xi\right)s.
\]

\end_inset

A unique 
\begin_inset Formula $\mathbb{R}-action$
\end_inset

 can be constructed from the every element of the Lie algebra.
 The corresponding Lie algebra action is the infinitesimal generator 
\begin_inset Formula 
\begin{align*}
\xi_{S^{1}}\left(s\right) & =\left.\frac{d}{dt}\right|_{t=0}\exp\left(t\xi\right)s\\
 & =\xi s,
\end{align*}

\end_inset

thus 
\begin_inset Formula $\xi_{S^{1}}=\xi$
\end_inset

.
 The corresponding 
\begin_inset Formula $\mathbb{R}-action$
\end_inset

 on the Lie group is
\begin_inset Formula 
\[
L_{\exp\left(t\xi\right)}:\mathbb{R}\times SO\left(2\right)\to SO\left(2\right),\,\left(t,R\right)\mapsto\exp\left(t\xi\right)R
\]

\end_inset

with the associated infinitesimal generator being 
\begin_inset Formula 
\begin{align*}
\xi_{SO\left(2\right)}\left(R\right) & =\left.\frac{d}{dt}\right|_{t=0}\exp\left(t\xi\right)R\\
 & =\xi R.
\end{align*}

\end_inset

Lastly the corresponding 
\begin_inset Formula $\mathbb{R}-action$
\end_inset

 on the Lie group is 
\begin_inset Formula 
\[
B_{\exp\left(t\xi\right)}:\mathbb{R}\times\mathfrak{g}\to\mathfrak{g},\,\left(t,u\right)\mapsto\log\left(\exp\left(t\xi\right)\exp\left(u\right)\right)
\]

\end_inset

with the associated infinitesimal generator being 
\begin_inset Formula 
\begin{align*}
\xi_{\mathfrak{g}}\left(u\right) & =\left.\frac{d}{dt}\right|_{t=0}\log\left(\exp\left(t\xi\right)\exp\left(u\right)\right)\\
 & =\left(\frac{\exp\left(ad_{z\left(t\right)}\right)-I}{ad_{z\left(t\right)}}\right)^{-1}\xi\\
 & =\text{dexp}_{z,r}^{-1}\left(\xi\right),
\end{align*}

\end_inset

where 
\begin_inset Formula $z\left(t\right)=B_{\exp\left(t\xi\right)}\left(u\right)$
\end_inset

.
 
\end_layout

\begin_layout Definition
In example 
\begin_inset CommandInset ref
LatexCommand eqref
reference "exa:s1"

\end_inset

 we defined the integral curve 
\begin_inset Formula $\gamma\left(t\right)$
\end_inset

 at the point 
\begin_inset Formula $s=\left(x_{0},y_{0}\right)$
\end_inset

 as, which can be written in matrix notation as 
\begin_inset Formula 
\[
\gamma\left(t\right)=\underbrace{\begin{bmatrix}\cos\left(t\right) & -\sin\left(t\right)\\
\sin\left(t\right) & \cos\left(t\right)
\end{bmatrix}}_{R}\begin{bmatrix}x_{0}\\
y_{0}
\end{bmatrix},
\]

\end_inset

where 
\begin_inset Formula 
\[
R\left(t\right)=\begin{bmatrix}\cos\left(t\right) & -\sin\left(t\right)\\
\sin\left(t\right) & \cos\left(t\right)
\end{bmatrix}\in SO\left(2\right),
\]

\end_inset

and is a left 
\begin_inset Formula $\mathbb{R}-action$
\end_inset

.
 The corresponding infinitesimal generator is 
\begin_inset Formula 
\begin{align*}
\xi_{S^{1}}\left(s\right) & =\left.\frac{d}{dt}\right|_{t=0}\begin{bmatrix}\cos\left(t\right) & -\sin\left(t\right)\\
\sin\left(t\right) & \cos\left(t\right)
\end{bmatrix}s\\
 & =\begin{bmatrix}0 & -1\\
1 & 0
\end{bmatrix}s
\end{align*}

\end_inset

where 
\begin_inset Formula 
\[
\xi=\begin{bmatrix}0 & -1\\
1 & 0
\end{bmatrix},
\]

\end_inset

is an element of the Lie algebra.
 Thus we have the ODE on 
\begin_inset Formula $S^{1}$
\end_inset


\begin_inset Formula 
\begin{align*}
\frac{d}{dt}\gamma\left(t\right) & =\xi R\left(t\right)s
\end{align*}

\end_inset

and the corresponding ODE on 
\begin_inset Formula $SO\left(2\right)$
\end_inset

 is 
\begin_inset Formula 
\[
\frac{d}{dt}R\left(t\right)=\xi R\left(t\right)
\]

\end_inset

such that 
\begin_inset Formula 
\[
T\Phi_{s}\circ\xi_{SO\left(3\right)}=\xi_{S^{1}}\circ\Phi_{s},
\]

\end_inset

where 
\begin_inset Formula $T\Phi_{s}:TSO\left(2\right)\to TS^{1},\,v\mapsto vs$
\end_inset

.
 The corresponding ODE on 
\begin_inset Formula $\mathfrak{so}\left(2\right)$
\end_inset

 is 
\begin_inset Formula 
\[
\frac{d}{dt}z\left(t\right)=\text{dexp}_{z\left(t\right),r}^{-1}\left(\xi\right).
\]

\end_inset


\end_layout

\begin_layout Section
Runge-Kutta-Munthe-Kaas
\begin_inset CommandInset label
LatexCommand label
name "sec:Runge-Kutta-Munthe-Kaas"

\end_inset


\end_layout

\begin_layout Standard
We now are now ready to present the RK-MK algorithm of any order.
 Let 
\begin_inset Formula $\gamma\left(t\right):I\to M$
\end_inset

 be an integral curve of the vector field 
\begin_inset Formula $X\in\mathfrak{X}\left(M\right)$
\end_inset

 at 
\begin_inset Formula $m_{0}=\gamma\left(t\right)$
\end_inset

, and assume that the vector field 
\begin_inset Formula $X$
\end_inset

 can be represented as 
\begin_inset Formula 
\[
X=\xi_{M}\left(t,m\right)m,
\]

\end_inset

where 
\begin_inset Formula $\xi_{M}$
\end_inset

 is the infinitesimal generator of 
\begin_inset Formula $\xi$
\end_inset

 such that 
\begin_inset Formula $\xi_{M}\left(t,m\right)\in\mathfrak{g}$
\end_inset

.
 The s RK-MK algorithm from 
\begin_inset Formula $\gamma\left(t_{0}\right)$
\end_inset

 to 
\begin_inset Formula $\gamma\left(t_{0}+h\right)$
\end_inset

 is
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset


\series bold
 for 
\series default

\begin_inset Formula $i=1,2,\ldots,s$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset


\begin_inset Formula $\quad u_{i}=h\sum_{j=i}^{s}a_{ij}\tilde{k}_{j}$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset


\begin_inset Formula $\quad k_{i}=\xi_{M}\left(hc_{i},\lambda\left(u_{i},\gamma\left(t\right)\right)\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset


\begin_inset Formula $\quad\tilde{k}_{i}=\text{dexpinv}\left(u_{i},k_{i}\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\series bold
end
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $v=h\sum_{j=1}^{s}b_{j}\tilde{k}_{j}$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $\gamma\left(t+h\right)=\lambda\left(v,\gamma\left(t\right)\right)$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
RK-MK
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

The algorithm can be initially confusing, so to help build intuition we
 present the 
\begin_inset Formula $4$
\end_inset

 stage RK-MK method which is also a 
\begin_inset Formula $4^{th}$
\end_inset

 order method in Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:RK-MK-4"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $u_{1}=0$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $k_{1}=\xi_{M}\left(0,\lambda\left(u_{1},\gamma\left(t\right)\right)\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $\tilde{k}_{1}=k_{1}$
\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $u_{2}=h\frac{1}{2}\tilde{k}_{1}$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $k_{2}=\xi_{M}\left(\frac{1}{2}h,\lambda\left(u_{2},\gamma\left(t\right)\right)\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $\tilde{k}_{3}=\text{dexpinv}\left(u_{2},k_{2}\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $u_{3}=h\frac{1}{2}\tilde{k}_{2}$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $k_{3}=\xi_{M}\left(\frac{1}{2}h,\lambda\left(u_{3},\gamma\left(t\right)\right)\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $\tilde{k}_{3}=\text{dexpinv}\left(u_{3},k_{3}\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $u_{4}=h\tilde{k}_{3}$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $k_{4}=\xi_{M}\left(h,\lambda\left(u_{4},\gamma\left(t\right)\right)\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $\tilde{k}_{4}=\text{dexpinv}\left(u_{4},k_{4}\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $v=h\left(\frac{1}{6}\tilde{k}_{1}+\frac{1}{3}\tilde{k}_{2}+\frac{1}{3}\tilde{k}_{3}+\frac{1}{6}\tilde{k}_{4}\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $\gamma\left(t+h\right)=\lambda\left(v,\gamma\left(t\right)\right)$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
RK-MK 4
\begin_inset CommandInset label
LatexCommand label
name "alg:RK-MK-4"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
While the RK-MK method has many advantages, one of the draw backs in the
 increase in the number of flops associated with the exponential mapping
 and 
\begin_inset Formula $\text{dexpinv}$
\end_inset

.
 Fortunately, Munth-Kaas and Owren optimized the RK-MK 4 method in 
\begin_inset CommandInset citation
LatexCommand cite
key "Munthe-Kaas1999a"

\end_inset

.
 We will not go over the details of the derivation, but only present it
 algorithms 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:RK-MK-4-Optimized-Right"

\end_inset

 for right-trivialized and 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:RK-MK-4-Optimized-Left"

\end_inset

 for left trivialized.
 Note that the 
\begin_inset Formula $\text{dexpinv}$
\end_inset

 has been replaced by just two commutators!
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $k_{1}=h\xi_{M}\left(0,\lambda\left(0,\gamma\left(t\right)\right)\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $k_{2}=h\xi_{M}\left(\frac{1}{2}h,\lambda\left(\frac{1}{2}k_{1},\gamma\left(t\right)\right)\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $k_{3}=h\xi_{M}\left(\frac{1}{2}h,\lambda\left(\frac{1}{2}k_{2}-\frac{1}{8}\left[k_{1},k_{2}\right],\gamma\left(t\right)\right)\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $k_{4}=h\xi_{M}\left(h,\lambda\left(k_{3},\gamma\left(t\right)\right)\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $v=\left(\frac{1}{6}k_{1}+\frac{1}{3}k_{2}+\frac{1}{3}k_{3}+\frac{1}{6}k_{4}-\frac{1}{12}\left[k_{1},k_{4}\right]\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $\gamma\left(t+h\right)=\lambda\left(v,\gamma\left(t\right)\right)$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
RK-MK 4 Optimized Right
\begin_inset CommandInset label
LatexCommand label
name "alg:RK-MK-4-Optimized-Right"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $k_{1}=h\xi_{M}\left(0,\lambda\left(0,\gamma\left(t\right)\right)\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $k_{2}=h\xi_{M}\left(\frac{1}{2}h,\lambda\left(\frac{1}{2}k_{1},\gamma\left(t\right)\right)\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $k_{3}=h\xi_{M}\left(\frac{1}{2}h,\lambda\left(\frac{1}{2}k_{2}+\frac{1}{8}\left[k_{1},k_{2}\right],\gamma\left(t\right)\right)\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $k_{4}=h\xi_{M}\left(h,\lambda\left(k_{3},\gamma\left(t\right)\right)\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $v=\left(\frac{1}{6}k_{1}+\frac{1}{3}k_{2}+\frac{1}{3}k_{3}+\frac{1}{6}k_{4}+\frac{1}{12}\left[k_{1},k_{4}\right]\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $\gamma\left(t+h\right)=\lambda\left(v,\gamma\left(t\right)\right)$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
RK-MK 4 Optimized Left
\begin_inset CommandInset label
LatexCommand label
name "alg:RK-MK-4-Optimized-Left"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In the case of example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:s1"

\end_inset

, the RK-MK 4 method reduces to the Lie-Euler method since the vector field
 is constant, and it's solution is 
\begin_inset Formula 
\[
\gamma\left(t\right)=\exp\left(\omega t\right)\gamma\left(0\right).
\]

\end_inset


\end_layout

\begin_layout Standard
To really demonstrate the power of RK-MK we will introduce another example
 in the following subsection.
\end_layout

\begin_layout Remark
It should be noted that there are some vector fields 
\begin_inset Formula $\xi_{M}$
\end_inset

 such that 
\begin_inset Formula $\left[\xi_{M}\left(m_{1}\right),\xi_{M}\left(m_{2}\right)\right]=0,\,\forall m_{1},m_{2}\in M$
\end_inset

.
 This implies that 
\begin_inset Formula $\text{dexpinv}\left(\xi_{M}\left(m_{1}\right),\xi_{M}\left(m_{2}\right)\right)=\xi\left(m_{2}\right)$
\end_inset

 which allows the RK-MK method to be simplified even more.
\end_layout

\begin_layout Subsection
Example
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:so3"

\end_inset

Let 
\begin_inset Formula $y\in SO\left(3\right)$
\end_inset

 and 
\begin_inset Formula $X\in\mathfrak{X}^{r}\left(SO\left(3\right)\right)$
\end_inset

 defined as 
\begin_inset Formula 
\[
X\left(y\right)=\left(3\sin\left(y-y^{\top}\right)y-y^{\top}3\sin\left(y-y^{\top}\right)\right)y,
\]

\end_inset

where the 
\begin_inset Formula $\sin$
\end_inset

 function acts on each component of 
\begin_inset Formula $y$
\end_inset

 such that 
\begin_inset Formula $\sin\left(y\right)\in\mathbb{R}^{3\times3}$
\end_inset

, then the corresponding ODE is
\begin_inset Formula 
\begin{equation}
\dot{y}=X\left(y\right),\label{eq:so3_ode}
\end{equation}

\end_inset

which can be written as 
\begin_inset Formula 
\[
\dot{y}=X_{y}\left(y\right)y,
\]

\end_inset

where 
\begin_inset Formula 
\[
X_{y}\left(y\right)=3\sin\left(y-y^{\top}\right)y-y^{\top}3\sin\left(y-y^{\top}\right).
\]

\end_inset

The solution to the ODE is 
\begin_inset Formula 
\[
y\left(t_{0}+h\right)=\exp\left(\int_{t_{0}}^{t_{0}+h}X_{y}\left(y\right)dt\right)y_{0},
\]

\end_inset

where 
\begin_inset Formula $y_{0}=y\left(t_{0}\right)$
\end_inset

.
 We note that the integral 
\begin_inset Formula 
\[
\int_{t_{0}}^{t}X_{y}\left(y\right)dt
\]

\end_inset

might not have an analytical solution; however, since 
\begin_inset Formula $X_{y}\left(y\right)\in\mathfrak{so}\left(3\right)$
\end_inset

, we can use RK-MK 4 to approximate the integral up to the 4th order.
 Since 
\begin_inset Formula $X_{y}\left(y\right)$
\end_inset

 is right trivialized, we need to use 
\begin_inset Formula $\text{dexpinv}$
\end_inset

 corresponding to right-trivialization.
 Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:Implementation-Example-of"

\end_inset

 shows the implementation for this example based on algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:RK-MK-4"

\end_inset

.
 
\end_layout

\begin_layout Example
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $u_{1}=0$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $k_{1}=X_{y}\left(y_{0}\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $\tilde{k}_{1}=k_{1}$
\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $u_{2}=h\frac{1}{2}\tilde{k}_{1}$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $k_{2}=X_{y}\left(\exp\left(u_{2}\right)y_{0}\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $\tilde{k}_{2}=\text{dexpinv}\left(u_{2},k_{2}\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $u_{3}=h\frac{1}{2}\tilde{k}_{2}$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $k_{3}=X_{y}\left(\exp\left(u_{3}\right)y_{0}\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $\tilde{k}_{3}=\text{dexpinv}\left(u_{3},k_{3}\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $u_{4}=h\tilde{k}_{3}$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $k_{4}=X_{y}\left(\exp\left(u_{4}\right)y_{0}\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $\tilde{k}_{4}=\text{dexpinv}\left(u_{4},k_{4}\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $v=h\left(\frac{1}{6}\tilde{k}_{1}+\frac{1}{3}\tilde{k}_{2}+\frac{1}{3}\tilde{k}_{3}+\frac{1}{6}\tilde{k}_{4}\right)$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
STATE
\end_layout

\end_inset

 
\begin_inset Formula $y\left(t_{0}+h\right)=\exp\left(v\right)y_{0}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Implementation Example of RK-MK 4
\begin_inset CommandInset label
LatexCommand label
name "alg:Implementation-Example-of"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Example
We finish this section with a results from a simulation.
 We numerically integrated the ODE described by 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:so3_ode"

\end_inset

 using RK4, RK-MK6, RK-MK4, RK-MK4 OPT over a time period of 10 seconds
 with interval steps of 
\begin_inset Formula $h=\left\{ 5^{-1},10^{-1},10^{-2},10^{-3},10^{-4}\right\} $
\end_inset

.
 The result obtained from RK-MK6 using a time interval of 
\begin_inset Formula $h=10^{-4}$
\end_inset

 was used as truth data.
 We calculated the error in the solution using the function 
\begin_inset Formula 
\[
e=\left\Vert \log\left(R_{T}^{\top}R_{E}\right)\right\Vert ,
\]

\end_inset

where 
\begin_inset Formula $R_{T}$
\end_inset

 is our true result and 
\begin_inset Formula $R_{E}$
\end_inset

 is the estimated result obtained by one of the four algorithms.
 We also measured the total time required for each algorithm to perform
 the numerical integration.
 Lastly we measured in error in the determinant of the result obtained from
 the RK4 method.
 These results are shown in fig 
\begin_inset CommandInset ref
LatexCommand eqref
reference "fig:so3_example"

\end_inset

.
\end_layout

\begin_layout Example
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "40col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/example2Error.pdf
	width 40col%

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "40col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/example2Det.pdf
	width 40col%

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The image on the left shows the error as a function of computation time,
 and the image on the right shows the error in the determinant as a function
 of time step size.
\begin_inset CommandInset label
LatexCommand label
name "fig:so3_example"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The results are surprising.
 Note that the computation time required for a certain numerical accuracy
 for the RK-MK4 OPT method is very similar to that of RK4; however, the
 RK4 method does leave the manifold slightly.
 
\end_layout

\begin_layout Section
Partitioned RK-MK
\begin_inset CommandInset label
LatexCommand label
name "sec:Partitioned-RK-MK"

\end_inset


\end_layout

\begin_layout Standard
The RK-MK method that we have discussed so far works on flows defined in
 Homogenous spaces that are a first order ordinary differential equation.
 The RK-MK method can be extended to flows that are second ordinary differential
 equations if these flows can be described as a group action on itself where
 the group is a tangent bundle of a Lie group.
 In other words we are working with the homogenous space 
\begin_inset Formula $\left(TG,TG,\Phi\right)$
\end_inset

 where 
\begin_inset Formula $G$
\end_inset

 is a lie group, and 
\begin_inset Formula $TG$
\end_inset

 is the tangent bundle of the Lie group 
\begin_inset Formula $G$
\end_inset

.
 
\end_layout

\begin_layout Standard
Since the tangent bundle of a Lie group is diffeomorphic to the direct product
 of the Lie group with its Lie algebra, i.e.
 
\begin_inset Formula $TG\approxeq G\times\mathfrak{g}$
\end_inset

, we can work with the homogenous space 
\begin_inset Formula $\left(G\times\mathfrak{g},G\times\mathfrak{g},\Phi\right)$
\end_inset

.
 This allows us to work with a simpler structure.
 The group action 
\begin_inset Formula $\Phi$
\end_inset

, in this case is defined as 
\begin_inset Formula 
\[
\Phi:\left(\left(G\times\mathfrak{g}\right)\times\left(G\times\mathfrak{g}\right)\right)\to\left(G\times\mathfrak{g}\right);\,\left(g_{1},v_{1}\right)\times\left(g_{2},v_{2}\right)\mapsto\left(g_{1}g_{2},v_{1}+v_{2}\right).
\]

\end_inset

However, this doesn't properly represent the structure of the tangent bundle.
 To understand why, consider the two flows 
\begin_inset Formula $F_{1}=g_{1}\exp\left(tv_{1}\right)$
\end_inset

 and 
\begin_inset Formula $F_{2}=g_{2}\exp\left(tv_{2}\right)$
\end_inset

.
 We can construct a new flow that is the product of the two flows 
\begin_inset Formula 
\[
F_{3}=F_{1}F_{2}=g_{1}\exp\left(tv_{1}\right)g_{2}\exp\left(tv_{2}\right),
\]

\end_inset

taking the directional derivative yields 
\begin_inset Formula 
\begin{align*}
\left.\frac{d}{dt}\right|_{t=0}g_{1}\exp\left(tv_{1}\right)g_{2}\exp\left(tv_{2}\right) & =g_{1}v_{1}g_{2}+g_{1}g_{2}v_{2}\\
 & =g_{1}g_{2}\left(\text{Ad}_{g_{2}^{-1}}v_{1}+v_{2}\right).
\end{align*}

\end_inset

This shows that the Lie algebra of the product of two flows is 
\begin_inset Formula $\text{Ad}_{g_{2}^{-1}}v_{1}+v_{2}$
\end_inset

, and not simply 
\begin_inset Formula $v_{1}+v_{2}$
\end_inset

.
 Because of this reason, we will work with the semi-direct product 
\begin_inset Formula $\left(G\ltimes_{\text{Ad}}\mathfrak{g}\right)$
\end_inset

.
 For more information on the semi-direct product see 
\begin_inset CommandInset citation
LatexCommand cite
key "Engo2003"

\end_inset

 or appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Semi_DirectProduct"

\end_inset

.
\end_layout

\begin_layout Subsection
Lie Algebra Action
\end_layout

\begin_layout Standard
Given the homogenous space 
\begin_inset Formula $\left(G\ltimes_{\text{Ad}}\mathfrak{g},G\ltimes_{\text{Ad}}\mathfrak{g},\Phi\right)$
\end_inset

, we know that we can represent flows on 
\begin_inset Formula $G\ltimes_{\text{Ad}}\mathfrak{g}$
\end_inset

 as a group action of the group on itself.
 We do this by utilizing the Lie algebra of the Lie group.
 Let 
\begin_inset Formula $\left(\mathfrak{g}\ltimes_{\text{ad}}\mathfrak{h}\right)$
\end_inset

 be the Lie algebra of the semi-direct product of 
\begin_inset Formula $G\ltimes_{\text{Ad}}\mathfrak{g}$
\end_inset

, then 
\begin_inset Formula 
\begin{equation}
\Phi_{\exp\left(t\left(\mathfrak{g}\ltimes_{\text{ad}}\mathfrak{h}\right)\right)}\left(G\ltimes_{\text{Ad}}\mathfrak{g}\right)\label{eq:flow_on_TG}
\end{equation}

\end_inset

represents a flow on 
\begin_inset Formula $G\ltimes_{\text{Ad}}\mathfrak{g}$
\end_inset

.
 The automorphism 
\begin_inset Formula $\Phi_{\exp\left(t\left(\mathfrak{g}\ltimes_{\text{ad}}\mathfrak{h}\right)\right)}$
\end_inset

 can represent either a left or right group action.
 By taking the directional derivative of 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:flow_on_TG"

\end_inset

 with respect to time, we can derive the infinitesimal generator, which
 is the Lie Algebra Action;
\begin_inset Formula 
\[
\left.\frac{d}{dt}\right|_{t=0}\Phi_{\exp\left(t\left(\mathfrak{g}\ltimes_{\text{ad}}\mathfrak{h}\right)\right)}\left(G\ltimes_{\text{Ad}}\mathfrak{g}\right).
\]

\end_inset

What this is depends on the type of action and group.
 Let 
\begin_inset Formula $\left(g,w\right)\in G\ltimes_{\text{Ad}}\mathfrak{g}$
\end_inset

 and 
\begin_inset Formula $\left(v,u\right)\in\mathfrak{g}\ltimes_{\text{ad}}\mathfrak{h}$
\end_inset

.
 The infinitesimal generator corresponding to the left action is 
\begin_inset Formula 
\begin{align*}
 & \left.\frac{d}{dt}\right|_{t=0}\left(g\exp\left(tv\right),\text{Ad}_{\exp\left(tv\right)^{-1}}w+\text{dexp}_{\left(tv\right),l}\left(tu\right)\right)\\
 & =\left(gv,\text{ad}_{-v}w+u\right),
\end{align*}

\end_inset

where 
\begin_inset Formula $\frac{d}{dt}g=gv$
\end_inset

 and 
\begin_inset Formula $\frac{d}{dt}w=\text{ad}_{-v}w+u$
\end_inset

.
 The infinitesimal generator corresponding to the right action is 
\begin_inset Formula 
\begin{align*}
 & \left.\frac{d}{dt}\right|_{t=0}\left(\exp\left(tv\right)g,w+\text{Ad}_{g^{-1}}\left(\text{dexp}_{\left(tv\right),r}\left(tu\right)\right)\right)\\
 & =\left(vg,w+\text{Ad}_{g^{-1}}u\right),
\end{align*}

\end_inset

where 
\begin_inset Formula $\frac{d}{dt}g=vg$
\end_inset

 and 
\begin_inset Formula $\frac{d}{dt}w=\text{Ad}_{g^{-1}}u+w$
\end_inset

.
 
\end_layout

\begin_layout Standard
We can think of an element 
\begin_inset Formula $\xi_{G\ltimes_{\text{Ad}}\mathfrak{g}}\in\mathfrak{g}\ltimes_{\text{ad}}\mathfrak{h}$
\end_inset

 as a vector field of the tangent bundle that maps 
\begin_inset Formula $TG$
\end_inset

 to 
\begin_inset Formula $TTG$
\end_inset

 and is thus a function of 
\begin_inset Formula $TG$
\end_inset

 and time.
 So the objective is to integrate the vector field 
\begin_inset Formula $\xi_{G\ltimes_{\text{Ad}}\mathfrak{g}}$
\end_inset

 using the RK-MK method.
 
\end_layout

\begin_layout Example
Consider a small unmanned air vehicle (sUAV) with the following equations
 of motion
\begin_inset Formula 
\begin{align*}
\dot{P}_{b/i}^{i} & =R_{b}^{i}v_{b/i}^{b}\\
m\dot{v}_{b/i}^{b} & =-\omega_{b/i}^{b}\times mv_{b/i}^{b}+F_{1}\left(R,P,\omega,v,t\right)\\
\dot{R}_{b}^{i} & =R_{b}^{i}\omega_{b/i}^{b}\\
J\dot{\omega}_{b/i}^{b} & =-\omega_{b/i}^{b}\times J\omega_{b/i}^{b}+F_{2}\left(R,P,\omega,v,t\right),
\end{align*}

\end_inset

where 
\begin_inset Formula $P_{b/i}^{i}$
\end_inset

 is the position of the sUAV w.r.t.
 the inertial frame expressed in the inertial frame, 
\begin_inset Formula $R_{b}^{i}$
\end_inset

 is the rotation from the body frame to the inertial frame, 
\begin_inset Formula $v_{b/i}^{b}$
\end_inset

 is the translational velocity of the sUAV w.r.t.
 in the inertial frame and expressed in the body frame, 
\begin_inset Formula $\omega_{b/i}^{b}$
\end_inset

 is the angular velocity w.r.t.
 the inertial frame and expressed in the body frame, 
\begin_inset Formula $m$
\end_inset

 is the mass of the sUAV, 
\begin_inset Formula $J$
\end_inset

 is the moment of inertial about the center of mass, and 
\begin_inset Formula $F_{1}$
\end_inset

 and 
\begin_inset Formula $F_{2}$
\end_inset

 are forces on the system.
 
\end_layout

\begin_layout Example
Since a sUAV moves on 
\begin_inset Formula $SE\left(3\right)$
\end_inset

, we can express the equations of motion as a Lie algebra action on the
 semi-direct product group 
\begin_inset Formula $SE\left(3\right)\ltimes_{\text{Ad}}\mathfrak{se}\left(3\right)$
\end_inset

.
 To show this, let 
\begin_inset Formula $\left(x,z\right)\in SE\left(3\right)\ltimes_{\text{Ad}}\mathfrak{se}\left(3\right)$
\end_inset

 where 
\begin_inset Formula 
\[
x=\begin{bmatrix}R_{b}^{i} & P_{b/i}^{i}\\
0 & 1
\end{bmatrix},
\]

\end_inset

and 
\begin_inset Formula 
\[
z=\begin{bmatrix}J\omega_{b/i}^{b} & mv_{b/i}^{b}\\
0 & 0
\end{bmatrix},
\]

\end_inset

and let 
\begin_inset Formula $\left(a,b\right)\in\left(\mathfrak{se}\left(3\right)\ltimes_{\text{ad}}\mathfrak{se}\left(3\right)\right)$
\end_inset

 where 
\begin_inset Formula 
\[
a=\begin{bmatrix}\omega_{b/i}^{b} & v_{b/i}^{b}\\
0 & 0
\end{bmatrix},
\]

\end_inset

and 
\begin_inset Formula 
\[
b=\begin{bmatrix}F_{2} & F_{1}\\
0 & 0
\end{bmatrix}.
\]

\end_inset


\end_layout

\begin_layout Example
The infinitesimal generator corresponding to the left action is 
\begin_inset Formula 
\begin{align*}
 & \left.\frac{d}{dt}\right|_{t=0}\left(x,z\right)\exp\left(t\left(a,b\right)\right)\\
 & =\left(xa,\text{ad}_{-a}z+b\right).
\end{align*}

\end_inset

Thus we have this vector field 
\begin_inset Formula $\xi_{SE\left(3\right)\ltimes_{\text{Ad}}\mathfrak{se}\left(3\right)}=\left(a,b\right)$
\end_inset

 that maps elements from 
\begin_inset Formula $TSE\left(3\right)$
\end_inset

 to 
\begin_inset Formula $TTSE\left(3\right)$
\end_inset

.
 
\end_layout

\begin_layout Subsection
Partitioned Runge-Kutta-Munthe-Kass Method
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $H$
\end_inset

 denote a semi-direct product of a Lie group such that 
\begin_inset Formula $H=G\ltimes_{\Phi}\mathfrak{g}$
\end_inset

, and let 
\begin_inset Formula $\xi$
\end_inset

 be the vector field on 
\begin_inset Formula $H$
\end_inset

 that is the infinitesimal generator of the left multiplication action of
 
\begin_inset Formula $H$
\end_inset

 on itself.
 The vector field can be written as 
\begin_inset Formula $\xi=\left(\zeta\left(H,t\right),\eta\left(H,t\right)\right)$
\end_inset

 where 
\begin_inset Formula $\zeta,\eta\in\mathfrak{g}$
\end_inset

.
 Let 
\begin_inset Formula $h\in H$
\end_inset

 with the flow 
\begin_inset Formula $h\exp\left(\int_{t_{0}}^{t}\xi\left(t,h\right)\right)$
\end_inset

, our objective is to use the RK-MK method to numerically calculate the
 integral 
\begin_inset Formula $\int_{t_{0}}^{t}\xi\left(t,h\right)$
\end_inset

.
 
\end_layout

\begin_layout Appendix

\end_layout

\begin_layout Section
Direct Product and Semi-Direct Product
\begin_inset CommandInset label
LatexCommand label
name "sec:Semi_DirectProduct"

\end_inset


\end_layout

\begin_layout Standard
In this appendix we quickly review the direct product of manifolds and spaces
 and the semi-direct product of homogenous spaces.
 We review this in preparation to discuss the partitioned RK-MK method that
 is discussed in section 
\begin_inset CommandInset ref
LatexCommand eqref
reference "sec:Partitioned-RK-MK"

\end_inset

.
 
\end_layout

\begin_layout Subsection
Direct Product of Spaces
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $M$
\end_inset

 and 
\begin_inset Formula $N$
\end_inset

 be two spaces (sets with additional structure), then the direct product
 of the spaces constructs a new space 
\begin_inset Formula $M\times N\coloneqq\left\{ \left(m,n\right)\in M\times N|\,m\in M,\,n\in N\right\} $
\end_inset

 that preserves the structure of 
\begin_inset Formula $M$
\end_inset

 and 
\begin_inset Formula $N$
\end_inset

.
 For example let 
\begin_inset Formula $\Delta:M\times M\to M$
\end_inset

 be an operation defined on 
\begin_inset Formula $M$
\end_inset

 and 
\begin_inset Formula $\nabla:N\times N\to N$
\end_inset

 be an operation defined on 
\begin_inset Formula $N$
\end_inset

, then we can define a new operation 
\begin_inset Formula 
\[
*:\left(M\times N\right)\times\left(M\times N\right)\to M\times N,\,\left(\left(m_{1},n_{1}\right),\left(m_{2},n_{2}\right)\right)\mapsto\left(m_{1}\Delta m_{1},n_{1}\nabla n_{2}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
For another example, let 
\begin_inset Formula $G$
\end_inset

 be a group with operator 
\begin_inset Formula $\Delta:G\times G\to G$
\end_inset

 and 
\begin_inset Formula $H$
\end_inset

 be another group with operator 
\begin_inset Formula $\nabla:H\times H\to H$
\end_inset

, then we can form the direct product of the spaces 
\begin_inset Formula $G\times H$
\end_inset

 and define a new operation
\begin_inset Formula 
\[
*:\left(G\times H\right)\times\left(G\times H\right)\to G\times H,\,\left(\left(g_{1},h_{1}\right),\left(g_{2},h_{2}\right)\right)\mapsto\left(g_{1}\Delta g_{2},h_{1}\nabla h_{2}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
As a final example,let 
\begin_inset Formula $G$
\end_inset

 be a group with operator 
\begin_inset Formula $\Delta:G\times G\to G$
\end_inset

 and 
\begin_inset Formula $M$
\end_inset

 be a vector space, then we can form the direct product of the spaces 
\begin_inset Formula $G\times M$
\end_inset

 and define a new operation 
\begin_inset Formula 
\[
*:\left(G\times M\right)\times\left(G\times M\right)\to G\times M,\,\left(\left(g_{1},m_{1}\right),\left(g_{2},m_{2}\right)\right)\mapsto\left(g_{1}\Delta g_{2},m_{1}+m_{2}\right).
\]

\end_inset


\end_layout

\begin_layout Subsection
Semi-Direct Product of Groups
\end_layout

\begin_layout Standard
Given a Homogenous space 
\begin_inset Formula $\left(H,G,\Phi\right)$
\end_inset

 where 
\begin_inset Formula $H$
\end_inset

 is a group equipped with the operator 
\begin_inset Formula $\nabla:H\times H\to H$
\end_inset

, 
\begin_inset Formula $G$
\end_inset

 is a group with the operator 
\begin_inset Formula $\Delta:G\times G\to G$
\end_inset

 and 
\begin_inset Formula $\Phi:G\to\text{Aut}\left(H\right)$
\end_inset

 is a map from 
\begin_inset Formula $G$
\end_inset

 to the automorphism of 
\begin_inset Formula $H$
\end_inset

 such that 
\begin_inset Formula $\Phi\left(g\right)\left(h\right)\in H$
\end_inset

 where 
\begin_inset Formula $g\in G$
\end_inset

 and 
\begin_inset Formula $h\in H$
\end_inset

.
 For shorthand notation we denote 
\begin_inset Formula $\Phi\left(g\right)$
\end_inset

 as 
\begin_inset Formula $\Phi_{g}$
\end_inset

.
 Note that 
\begin_inset Formula $\Phi_{g}$
\end_inset

 can be either a left, right or conjugate action on 
\begin_inset Formula $H$
\end_inset

, but we do not specify what type of action it is to keep it generic.
 We also note that 
\begin_inset Formula $\Phi$
\end_inset

 is a homomorphism which implies 
\begin_inset Formula 
\[
\Phi_{g_{2}}\circ\Phi_{g_{1}}\left(h\right)=\Phi_{g_{2}\Delta g_{1}}\left(h\right).
\]

\end_inset


\end_layout

\begin_layout Standard
Using the automorphism, we can construct a new group which is the semi-direct
 product 
\begin_inset Formula $G\ltimes_{\Phi}H\coloneqq\left\{ \left(g,h\right):\,g\in G,\,h\in H\right\} $
\end_inset

 with the operator 
\begin_inset Formula $*$
\end_inset

.
 The operator 
\begin_inset Formula $*$
\end_inset

 can be defined as either a left or right operator (sometimes referred as
 left and right group multiplication).
 In the case that 
\begin_inset Formula $*$
\end_inset

 is a right operator we define it as 
\begin_inset Formula 
\[
*:\left(G\times H\right)\times\left(G\times H\right)\to G\times H,\,\left(\left(g_{1},h_{1}\right),\left(g_{2},h_{2}\right)\right)\mapsto\left(g_{1}\Delta g_{2},\Phi_{g_{2}}\left(h_{1}\right)\nabla h_{2}\right),
\]

\end_inset

and in the case 
\begin_inset Formula $*$
\end_inset

 is a left operator we define it as
\begin_inset Formula 
\[
*:\left(G\times H\right)\times\left(G\times H\right)\to G\times H,\,\left(\left(g_{1},h_{1}\right),\left(g_{2},h_{2}\right)\right)\mapsto\left(g_{1}\Delta g_{2},h_{1}\nabla\Phi_{g_{1}}\left(h_{2}\right)\right).
\]

\end_inset


\end_layout

\begin_layout Standard
Since 
\begin_inset Formula $G\ltimes_{\Phi}H$
\end_inset

 is a group, it must also have an identity element and an inverse element.
 The identity element is simply 
\begin_inset Formula $\left(e_{G},e_{H}\right)$
\end_inset

 where 
\begin_inset Formula $e_{G}$
\end_inset

 is the identity element in 
\begin_inset Formula $G$
\end_inset

 and 
\begin_inset Formula $e_{H}$
\end_inset

 is the identity element in 
\begin_inset Formula $H$
\end_inset

.
 To find the inverse, we use the identity 
\begin_inset Formula 
\[
\left(g_{1},h_{1}\right)*\left(g_{1},h_{1}\right)^{-1}=\left(e_{G},e_{H}\right),
\]

\end_inset

where 
\begin_inset Formula $*$
\end_inset

 can be either the right or left operator.
 To fine the inverse element, let 
\begin_inset Formula $\left(g_{2},h_{2}\right)=\left(g_{1},h_{1}\right)^{-1}$
\end_inset

, then for the right group operation we have 
\begin_inset Formula 
\[
\left(g_{1}\Delta g_{2},\Phi_{g_{2}}\left(h_{1}\right)\nabla h_{2}\right)=\left(e_{G},e_{H}\right)
\]

\end_inset

which holds when 
\begin_inset Formula $g_{2}=g_{1}^{-1}$
\end_inset

 and 
\begin_inset Formula $h_{2}=\Phi_{g_{2}}\left(h_{1}\right)^{-1}$
\end_inset

, thus 
\begin_inset Formula 
\[
\left(g_{1},h_{1}\right)^{-1}=\left(g_{1}^{-1},\Phi_{g_{1}^{-1}}\left(h_{1}\right)^{-1}\right).
\]

\end_inset

Similarly for the left group operation we get 
\begin_inset Formula 
\[
\left(g_{1},h_{1}\right)^{-1}=\left(g_{1}^{-1},\Phi_{g_{1}^{-1}}\left(h_{1}\right)^{-1}\right).
\]

\end_inset


\end_layout

\begin_layout Remark
Depending on the author, how the semi-direct product is defined can have
 subtle differences.
 We have tried to present it abstractly and simply as possible.
\end_layout

\begin_layout Example

\series bold
\begin_inset CommandInset label
LatexCommand label
name "exa:SDP_SEN"

\end_inset

(The Special Euclidean Group)
\series default
 Let 
\begin_inset Formula $\mathbb{R}^{n}$
\end_inset

 be an n-dimensional vector space and 
\begin_inset Formula $SO\left(n\right)$
\end_inset

 be the n-dimensional special orthogonal group which contains the set of
 all rotational isometries in n-dimensional space.
 We can construct the homogenous space 
\begin_inset Formula $\left(\mathbb{R}^{n},SO\left(n\right),\Phi\right)$
\end_inset

 where 
\begin_inset Formula $\Phi$
\end_inset

 is a left group action 
\begin_inset Formula 
\[
\Phi:SO\left(n\right)\times\mathbb{R}^{n}\to\mathbb{R}^{n},\,\left(R,v\right)\mapsto Rv,
\]

\end_inset

and 
\begin_inset Formula 
\[
\Phi:SO\left(n\right)\to\text{Aut}\left(\mathbb{R}^{n}\right).
\]

\end_inset

 A natural semi-direct product is 
\begin_inset Formula $SO\left(n\right)\ltimes_{\Phi}\mathbb{R}^{n}$
\end_inset

 where new right group operator 
\begin_inset Formula $*$
\end_inset

 is defined as 
\begin_inset Formula 
\[
*:\left(SO\left(n\right)\times\mathbb{R}^{n}\right)\times\left(SO\left(n\right)\times\mathbb{R}^{n}\right)\to SO\left(n\right)\times\mathbb{R}^{n},\,\left(\left(R_{1},p_{1}\right),\left(R_{2},p_{2}\right)\right)\mapsto\left(R_{1}R_{2},p_{1}+\Phi\left(R_{1},p_{2}\right)\right).
\]

\end_inset

To make it more clear what we are doing, we can represent the new group
 
\begin_inset Formula $SO\left(n\right)\ltimes_{\Phi}\mathbb{R}^{n}$
\end_inset

 in matrix notation as 
\begin_inset Formula 
\[
E=\begin{bmatrix}R & p\\
0_{3\times3} & 1
\end{bmatrix},
\]

\end_inset

where 
\begin_inset Formula $R\in SO\left(n\right)$
\end_inset

 and 
\begin_inset Formula $v\in\mathbb{R}^{n}$
\end_inset

.
 The right group multiplication in this representation is simply matrix
 multiplication
\begin_inset Formula 
\begin{align*}
\begin{bmatrix}R_{1} & p_{1}\\
0_{3\times3} & 1
\end{bmatrix}\begin{bmatrix}R_{2} & p_{2}\\
0_{3\times3} & 1
\end{bmatrix} & =\begin{bmatrix}R_{1}R_{2} & p_{1}+R_{1}p_{2}\\
0 & 1
\end{bmatrix}\\
 & =\left(R_{1}R_{2},p_{1}+R_{1}p_{2}\right).
\end{align*}

\end_inset

The identity element is 
\begin_inset Formula 
\[
\begin{bmatrix}I & 0\\
0 & 1
\end{bmatrix},
\]

\end_inset

and the inverse is 
\begin_inset Formula 
\[
\begin{bmatrix}R^{\top} & -R^{\top}p\\
0 & 1
\end{bmatrix}.
\]

\end_inset


\end_layout

\begin_layout Subsection
Semi-Direct Product of Linear Lie Groups Extended to Their Lie Algebras
\begin_inset CommandInset label
LatexCommand label
name "sub:SDP_with_LA"

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $G\ltimes_{\Phi}H$
\end_inset

 be a linear Lie group formed from the semi-direct product of the two Lie
 groups 
\begin_inset Formula $G$
\end_inset

 and 
\begin_inset Formula $H$
\end_inset

, and be equipped with the operator 
\begin_inset Formula $*$
\end_inset

.
 Also, let 
\begin_inset Formula $\mathfrak{g}\ltimes_{\phi}\mathfrak{h}$
\end_inset

 be the semi-direct product of their Lie algebras.
 The objective of this subsection is to define the Lie bracket on 
\begin_inset Formula $\mathfrak{g}\ltimes_{\phi}\mathfrak{h}$
\end_inset

 using the adjoint action of the Lie Group 
\begin_inset Formula $G\ltimes_{\Phi}H$
\end_inset

 on 
\begin_inset Formula $\mathfrak{g}\ltimes_{\phi}\mathfrak{h}$
\end_inset

.
 To do this, we begin with a definition of the exponential and logarithm
 maps and use them with the conjugation action of 
\begin_inset Formula $G\ltimes_{\Phi}H$
\end_inset

 on itself to derive the Lie bracket on 
\begin_inset Formula $\mathfrak{g}\ltimes_{\phi}\mathfrak{h}$
\end_inset

.
 
\end_layout

\begin_layout Standard
In order to properly defined the exponential map, we will make use of the
 Ado theorem.
\end_layout

\begin_layout Theorem

\series bold
(Ado).

\series default
 Let 
\begin_inset Formula $\mathfrak{gl}\left(n\right)$
\end_inset

 denote the Lie algebra of 
\begin_inset Formula $GL\left(n\right)$
\end_inset

.
 Every finite-dimensional real Lie algebra is isomorphic to a subalgebra
 of 
\begin_inset Formula $\mathfrak{gl}\left(n;\mathbb{R}\right)$
\end_inset

.
 Every finite-dimensional complex Lie algebra is isomorphic to a complex
 subalgebra of 
\begin_inset Formula $\mathfrak{gl}\left(n;\mathbb{C}\right)$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
This theorem allows us to represent complex Lie algebras as matrices that
 are a subalgebra of 
\begin_inset Formula $\mathfrak{gl}\left(n;\mathbb{C}\right)$
\end_inset

.
 In other words, let 
\begin_inset Formula $\pi:\mathfrak{g}\ltimes_{\phi}\mathfrak{h}\to\mathfrak{gl}\left(n;\mathbb{C}\right)$
\end_inset

, then we can define matrix multiplication 
\begin_inset Formula 
\[
\cdot:\pi\left(\mathfrak{g}\ltimes_{\phi}\mathfrak{h}\right)\times\pi\left(\mathfrak{g}\ltimes_{\phi}\mathfrak{h}\right)\to\mathfrak{gl}\left(2n;\mathbb{C}\right),
\]

\end_inset

where the image of 
\begin_inset Formula $\cdot$
\end_inset

 is not necessarily 
\begin_inset Formula $\pi\left(\mathfrak{g}\ltimes_{\phi}\mathfrak{h}\right)$
\end_inset

.
 
\end_layout

\begin_layout Theorem
Every Linear Lie group is isomorphic to a matrix Lie group.
\end_layout

\begin_layout Standard
This theorem allows us to map any Linear Lie group to a matrix Lie group.
 Essentially, since the Lie algebras and the Lie groups can be represented
 as matrices, we can easily define their exponential and logarithm maps
 using the matrix exponential and matrix logarithm as 
\begin_inset Formula 
\begin{align*}
\exp:\mathfrak{g}\ltimes_{\phi}\mathfrak{h} & \to G\ltimes_{\Phi}H,\,\left(v,u\right)\mapsto\sum_{k=0}^{\infty}\frac{1}{k!}\left(v,u\right)^{k}\\
\log:G\ltimes_{\Phi}H & \to\mathfrak{g}\ltimes_{\phi}\mathfrak{h},\,\left(g,h\right)\mapsto\sum_{k=1}^{\infty}\left(-1\right)^{k+1}\frac{\left(\left(g,h\right)-\left(e_{G},e_{H}\right)\right)^{k}}{k},
\end{align*}

\end_inset

where the mappings to their matrix representations are inferred, and will
 be inferred from here on out.
 
\end_layout

\begin_layout Standard
The conjugation action of a group on itself is defined as 
\begin_inset Formula 
\[
\Psi:\left(G\ltimes_{\Phi}H\right)\times\left(G\ltimes_{\Phi}H\right)\to G\ltimes_{\Phi}H,\,\left(\left(g_{1},h_{1}\right),\left(g_{2},h_{2}\right)\right)\to\left(g_{1},h_{1}\right)*\left(g_{2},h_{2}\right)*\left(g_{1},h_{1}\right)^{-1},
\]

\end_inset

and the corresponding automorphism is 
\begin_inset Formula 
\[
\Psi_{\left(g_{1},h_{1}\right)}:\left(G\ltimes_{\Phi}H\right)\to\left(G\ltimes_{\Phi}H\right).
\]

\end_inset

The adjoint action of a Lie group on it's Lie algebra is define as 
\begin_inset Formula 
\[
\left.\frac{d}{dt}\right|_{t=0}\Psi_{\left(g_{1},h_{1}\right)}\left(\exp\left(t\left(v,u\right)\right)\right),
\]

\end_inset

and is denoted 
\begin_inset Formula 
\[
\text{Ad}_{\left(g_{1},h_{1}\right)}:\mathfrak{g}\ltimes_{\phi}\mathfrak{h}\to\mathfrak{g}\ltimes_{\phi}\mathfrak{h}.
\]

\end_inset


\end_layout

\begin_layout Standard
The adjoint action of a Lie algebra on itself is defined as 
\begin_inset Formula 
\[
\left.\frac{d}{dt}\right|_{t=0}\text{Ad}_{\exp t\left(v_{1},u_{1}\right)}\left(v_{2},u_{2}\right),
\]

\end_inset

and is denoted 
\begin_inset Formula 
\[
\text{ad}_{\left(v_{1},u_{1}\right)}:\mathfrak{g}\ltimes_{\phi}\mathfrak{h}\to\mathfrak{g}\ltimes_{\phi}\mathfrak{h},
\]

\end_inset

and is equivalent to the Lie bracket 
\begin_inset Formula 
\[
\left[\left(v_{1},u_{1}\right),\left(v_{2},u_{2}\right)\right].
\]

\end_inset


\end_layout

\begin_layout Standard
To help solidify what we discussed, we continue with example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:SDP_SEN"

\end_inset

.
\end_layout

\begin_layout Example

\series bold
(The Special Euclidean Group and Lie Algebra)
\begin_inset CommandInset label
LatexCommand label
name "exa:SE3_LA"

\end_inset


\series default
 The Lie algebra of the Lie group 
\begin_inset Formula $SO\left(n\right)\ltimes_{\Phi}\mathbb{R}^{n}$
\end_inset

 is 
\begin_inset Formula $\mathfrak{so}\left(n\right)\ltimes_{\phi}\mathbb{R}^{n}$
\end_inset

.
 The conjugate action of 
\begin_inset Formula $SO\left(n\right)\ltimes_{\Phi}\mathbb{R}^{n}$
\end_inset

 with 
\begin_inset Formula $*$
\end_inset

 being a left operator is 
\begin_inset Formula 
\begin{align*}
\Psi_{\left(R_{1},v_{1}\right)}\left(R_{2},v_{2}\right) & =\left(R_{1},p_{1}\right)*\left(R_{2},p_{2}\right)*\left(R_{1},p_{1}\right)^{-1}\\
 & =\left(R_{1}R_{2}R_{1}^{-1},p_{1}+R_{1}p_{2}-R_{1}R_{2}R_{1}^{-1}p_{1}\right).
\end{align*}

\end_inset

The adjoint action of the Lie group on it's Lie algebra is derived as 
\begin_inset Formula 
\begin{align*}
 & \left.\frac{d}{dt}\right|_{t=0}\Psi_{\left(R_{1},p_{1}\right)}\left(\exp\left(t\left(\omega,\rho\right)\right)\right)\\
 & =\left.\frac{d}{dt}\right|_{t=0}\left(R_{1},p_{1}\right)*\exp\left(t\left(\omega,\rho\right)\right)*\left(R_{1},p_{1}\right)^{-1}\\
 & =\left.\frac{d}{dt}\right|_{t=0}\left(R_{1},p_{1}\right)*\sum_{k=0}^{\infty}\frac{t^{k}}{k!}\left(\omega,\rho\right)^{k}*\left(R_{1},p_{1}\right)^{-1}\\
 & =\left.\frac{d}{dt}\right|_{t=0}\left(R_{1},p_{1}\right)*\left(I+t\left(\omega,\rho\right)+\mathcal{O}\left(t^{2}\right)\right)*\left(R_{1},p_{1}\right)^{-1}\\
 & =\left(R_{1},p_{1}\right)\bullet\left(\omega,\rho\right)\bullet\left(R_{1},p_{1}\right)^{-1}\\
 & =\left(R_{1}\omega R_{1}^{-1},-R_{1}\omega R_{1}^{-1}p_{1}+R_{1}\rho\right)\\
 & =\text{Ad}_{\left(R_{1},p_{1}\right)}\left(\omega,\rho\right)
\end{align*}

\end_inset

where the operator 
\begin_inset Formula $\bullet$
\end_inset

 is dependent on the Lie group and Lie algebra, but in this case is matrix
 multiplication.
 In matrix notation we get 
\begin_inset Formula 
\begin{align*}
\left(R_{1},p_{1}\right)\bullet\left(\omega,\rho\right)\bullet\left(R_{1},p_{1}\right)^{-1} & \cong\begin{bmatrix}R_{1} & p_{1}\\
0_{3\times3} & 1
\end{bmatrix}\begin{bmatrix}\omega & \rho\\
0 & 0
\end{bmatrix}\begin{bmatrix}R_{1}^{-1} & -R_{1}^{-1}p_{1}\\
0_{3\times3} & 1
\end{bmatrix}\\
 & \cong\begin{bmatrix}R_{1}\omega R_{1}^{-1} & -R_{1}\omega R_{1}^{-1}p_{1}+R_{1}\rho\\
0 & 0
\end{bmatrix}.
\end{align*}

\end_inset


\end_layout

\begin_layout Example
The adjoint action of the Lie algebra on itself is derived as 
\begin_inset Formula 
\begin{align*}
 & \left.\frac{d}{dt}\right|_{t=0}\text{Ad}_{\exp t\left(\omega_{1},\rho_{1}\right)}\left(\omega_{2},\rho_{2}\right)\\
 & =\left.\frac{d}{dt}\right|_{t=0}\exp\left(t\left(\omega_{1},\rho_{1}\right)\right)\bullet\left(\omega_{2},\rho_{2}\right)\bullet\exp\left(t\left(\omega_{1},\rho_{1}\right)\right)^{-1}\\
 & =\left.\frac{d}{dt}\right|_{t=0}\left(I+t\left(\omega_{1},\rho_{1}\right)+\mathcal{O}\left(t^{2}\right)\right)\bullet\left(\omega_{2},\rho_{2}\right)\bullet\left(I-t\left(\omega_{1},\rho_{1}\right)+\mathcal{O}\left(t^{2}\right)\right)\\
 & =\left(\omega_{1},\rho_{1}\right)\left(\omega_{2},\rho_{2}\right)-\left(\omega_{2},\rho_{2}\right)\left(\omega_{1},\rho_{1}\right)\\
 & =\text{ad}_{\left(\omega_{1},\rho_{1}\right)}\left(\omega_{2},\rho_{2}\right)\\
 & =\left[\left(\omega_{1},\rho_{1}\right),\left(\omega_{2},\rho_{2}\right)\right].
\end{align*}

\end_inset

In matrix notation we get 
\begin_inset Formula 
\begin{align*}
\text{ad}_{\left(\omega_{1},\rho_{1}\right)}\left(\omega_{2},\rho_{2}\right) & =\begin{bmatrix}\omega_{1} & \rho_{1}\\
0 & 0
\end{bmatrix}\begin{bmatrix}\omega_{2} & \rho_{2}\\
0 & 0
\end{bmatrix}-\begin{bmatrix}\omega_{2} & \rho_{2}\\
0 & 0
\end{bmatrix}\begin{bmatrix}\omega_{1} & \rho_{1}\\
0 & 0
\end{bmatrix}\\
 & =\begin{bmatrix}\omega_{1}\omega_{2}-\omega_{1}\omega_{2} & \omega_{1}\rho_{2}-\omega_{2}\rho_{2}\\
0 & 0
\end{bmatrix}.
\end{align*}

\end_inset

The adjoint is a group operation of the lie group 
\begin_inset Formula $\mathfrak{so}\left(n\right)\ltimes_{\phi}\mathbb{R}^{n}$
\end_inset

 and can be represented as 
\begin_inset Formula 
\[
\text{ad}_{\left(\omega_{1},\rho_{1}\right)}\left(\omega_{2},\rho_{2}\right)=\left(\omega_{1}\omega_{2}-\omega_{2}\omega_{1},\phi\left(\left(\omega_{1},\rho_{1}\right),\left(\omega_{1},\rho_{2}\right)\right)\right),
\]

\end_inset

where 
\begin_inset Formula 
\[
\phi:\left(\mathfrak{so}\left(n\right)\ltimes_{\phi}\mathbb{R}^{n}\right)\times\left(\mathfrak{so}\left(n\right)\ltimes_{\phi}\mathbb{R}^{n}\right)\to\mathbb{R}^{n},\,\left(\left(\omega_{1},\rho_{1}\right),\left(\omega_{1},\rho_{2}\right)\right)\mapsto\left(\omega_{1}\rho_{2}-\omega_{2}\rho_{2}\right).
\]

\end_inset


\end_layout

\begin_layout Subsection
Semi-Direct Product of Linear Lie Groups with Their Lie Algebra
\end_layout

\begin_layout Standard
In this subsection we will assume we are working with matrix Lie groups
 and their corresponding Lie algebras since every linear Lie group is isomorphic
 to a matrix Lie group whose Lie Algebra is a subset of 
\begin_inset Formula $\mathfrak{gl}\left(n\right)$
\end_inset

.
 We can form a new group by taking the semi-direct product of a lie group
 
\begin_inset Formula $G$
\end_inset

 with it's Lie algebra 
\begin_inset Formula $\mathfrak{g}$
\end_inset

 where the action of 
\begin_inset Formula $G$
\end_inset

 on 
\begin_inset Formula $\mathfrak{g}$
\end_inset

 is the adjoint.
 We denote this new group as 
\begin_inset Formula $G\ltimes_{\text{Ad}}\mathfrak{g}$
\end_inset

.
 
\end_layout

\begin_layout Standard
The reason behind the construction of this new group is to create a group
 that is isomorphic to the tangent bundle of 
\begin_inset Formula $G$
\end_inset

.
 To understand how this is done, create the map 
\begin_inset Formula 
\[
\Phi:G\to\text{Aut}\left(G\right),
\]

\end_inset

which can be a left or right group action of 
\begin_inset Formula $G$
\end_inset

 on 
\begin_inset Formula $G$
\end_inset

.
 We can then extend it to the Lie algebra
\begin_inset Formula 
\[
\Phi\circ\exp:\mathfrak{g}\to\text{Aut}\left(G\right),
\]

\end_inset

and construct the infinitesimal generator 
\begin_inset Formula 
\begin{align*}
 & \left.\frac{d}{dt}\right|_{t=0}\Phi\circ\exp\left(t\xi\right)\left(g\right)\\
 & =\xi_{G}\left(g\right),
\end{align*}

\end_inset

where 
\begin_inset Formula $\xi\in\mathfrak{g}$
\end_inset

.
 We now have a vector field 
\begin_inset Formula $\xi_{G}$
\end_inset

 on 
\begin_inset Formula $G$
\end_inset

.
 In the case the action is a right group action, it would look like 
\begin_inset Formula 
\[
\dot{g}=g\xi\in T_{g}G.
\]

\end_inset


\end_layout

\begin_layout Standard
By multiplying the above tangent vector on the left by 
\begin_inset Formula $g^{-1}$
\end_inset

 we get 
\begin_inset Formula 
\begin{align*}
g^{-1}\dot{g} & =g^{-1}g\xi\\
 & =\xi\in\mathfrak{g}.
\end{align*}

\end_inset

By now you should see that 
\begin_inset Formula $T_{g}G\cong g\times\mathfrak{g}$
\end_inset

, and thus 
\begin_inset Formula $TG\cong G\times\mathfrak{g}$
\end_inset

.
 However, this is not a semi-direct product yet.
 The derivation of the semi-direct product comes from considering two integral
 curves 
\begin_inset Formula $\gamma_{1}$
\end_inset

 and 
\begin_inset Formula $\gamma_{2}$
\end_inset

 over the vector fields 
\begin_inset Formula $\xi_{1}$
\end_inset

 and 
\begin_inset Formula $\xi_{2}$
\end_inset

 in 
\begin_inset Formula $G$
\end_inset

.
 These curves can be written in the form 
\begin_inset Formula 
\begin{align*}
\gamma_{1} & =g_{1}\exp\left(t\xi_{1}\right)\\
\gamma_{2} & =g_{2}\exp\left(t\xi_{2}\right).
\end{align*}

\end_inset

If we multiply the curves together we get 
\begin_inset Formula 
\begin{align*}
\gamma_{1}\gamma_{2} & =g_{1}\exp\left(t\xi_{1}\right)g_{2}\exp\left(t\xi_{2}\right)\\
 & =g_{1}g_{2}\exp\left(\text{Ad}_{g_{2}^{-1}}t\xi_{1}\right)\exp\left(t\xi_{2}\right),
\end{align*}

\end_inset

and their corresponding infinitesimal generator is 
\begin_inset Formula 
\begin{align*}
 & \left.\frac{d}{dt}\right|_{t=0}g_{1}g_{2}\exp\left(\text{Ad}_{g_{2}^{-1}}t\xi_{1}\right)\exp\left(t\xi_{2}\right)\\
 & =g_{1}g_{2}\left(\text{Ad}_{g_{2}^{-1}}\xi_{1}+\xi_{2}\right)\\
 & =\xi_{G}\left(g_{1}g_{2}\right),
\end{align*}

\end_inset

where 
\begin_inset Formula $\xi_{G}=\text{Ad}_{g_{2}^{-1}}\xi_{1}+\xi_{2}$
\end_inset

 is the infinitesimal generator.
 From this relation, we form the semi-direct product 
\begin_inset Formula $G\ltimes_{\text{Ad}}\mathfrak{g}$
\end_inset

 and define the group operator 
\begin_inset Formula $*$
\end_inset

 to be 
\begin_inset Formula 
\[
*:\left(G\ltimes_{\text{Ad}}\mathfrak{g}\right)\times\left(G\ltimes_{\text{Ad}}\mathfrak{g}\right)\to G\ltimes_{\text{Ad}}\mathfrak{g},\,\left(\left(g_{1},v_{1}\right),\left(g_{2},v_{2}\right)\right)\mapsto\left(g_{1}g_{2},\text{Ad}_{g_{2}^{-1}}v_{1}+v_{2}\right).
\]

\end_inset

Note that this definition of the group operator is for left trivialization
 of the vector field 
\begin_inset Formula $\text{Ad}_{g_{2}^{-1}}v_{1}+v_{2}$
\end_inset

.
 We could have defined the curves as 
\begin_inset Formula 
\begin{align*}
\gamma_{1} & =\exp\left(t\xi_{1}\right)g_{1}\\
\gamma_{2} & =\exp\left(t\xi_{2}\right)g_{2}
\end{align*}

\end_inset

to get 
\begin_inset Formula 
\begin{align*}
\gamma_{1}\gamma_{2} & =\exp\left(t\xi_{1}\right)g_{1}\exp\left(t\xi_{2}\right)g_{2}\\
 & =\exp\left(t\xi_{1}\right)\exp\left(\text{Ad}_{g_{1}}t\xi_{2}\right)g_{1}g_{2}
\end{align*}

\end_inset

which has the corresponding infinitesimal generator 
\begin_inset Formula $\xi_{G}=\text{Ad}_{g_{1}}\xi_{2}+\xi_{1}$
\end_inset

 which is right trivialized.
 From this relation, we would form the group operator 
\begin_inset Formula $*$
\end_inset

 to be 
\begin_inset Formula 
\[
*:\left(G\ltimes_{\text{Ad}}\mathfrak{g}\right)\times\left(G\ltimes_{\text{Ad}}\mathfrak{g}\right)\to G\ltimes_{\text{Ad}}\mathfrak{g},\,\left(\left(g_{1},v_{1}\right),\left(g_{2},v_{2}\right)\right)\mapsto\left(g_{1}g_{2},\text{Ad}_{g_{1}}v_{2}+v_{1}\right).
\]

\end_inset

Thus the definition of the group operator 
\begin_inset Formula $*$
\end_inset

 is dependent on if the vector field is left or right trivialized.
 
\end_layout

\begin_layout Standard
Using this operator, we can define a left and right group action on the
 group, the identity element, and the inverse element.
 These results are summarized in table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:SDP_LG-LA"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top" width="0pt">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $G\ltimes_{\text{Ad}}\mathfrak{g}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Left Trivialized
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Right Trivialized
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(g_{1},v_{1}\right)*\left(g_{2},v_{2}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(g_{1}g_{2},\text{Ad}_{g_{2}^{-1}}v_{1}+v_{2}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(g_{1}g_{2},\text{Ad}_{g_{1}}v_{2}+v_{1}\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Identity
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(I,0\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(I,0\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(g_{1},v_{1}\right)^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(g_{1}^{-1},-\text{Ad}_{g_{1}}v_{1}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(g_{1}^{-1},-\text{Ad}_{g_{1}^{-1}}v_{1}\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $R_{\left(g_{1},v_{1}\right)}\left(g_{2},v_{2}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(g_{2}g_{1},\text{Ad}_{g_{1}^{-1}}v_{2}+v_{1}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(g_{2}g_{1},\text{Ad}_{g_{2}}v_{1}+v_{2}\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $L_{\left(g_{1},v_{1}\right)}\left(g_{2},v_{2}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(g_{1}g_{2},\text{Ad}_{g_{2}^{-1}}v_{1}+v_{2}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(g_{1}g_{2},\text{Ad}_{g_{1}}v_{2}+v_{1}\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Group Actions of 
\begin_inset Formula $G\ltimes_{\text{Ad}}\mathfrak{g}$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "tab:SDP_LG-LA"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Since 
\begin_inset Formula $G\ltimes_{\text{Ad}}\mathfrak{g}$
\end_inset

 is a Lie group, it has a Lie algebra 
\begin_inset Formula $\mathfrak{g}\ltimes_{\text{ad}}\mathfrak{h}$
\end_inset

.
 The matrix exponential and logarithm maps between the Lie group 
\begin_inset Formula $G\ltimes_{\text{Ad}}\mathfrak{g}$
\end_inset

 and its Lie algebra 
\begin_inset Formula $\mathfrak{g}\ltimes_{\text{ad}}\mathfrak{h}$
\end_inset

.
 They are defined as 
\begin_inset Formula 
\begin{align*}
\exp:\mathfrak{g}\ltimes_{\text{ad}}\mathfrak{h} & \to G\ltimes_{\text{Ad}}\mathfrak{g},\,\left(v,u\right)\mapsto\sum_{k=0}^{\infty}\frac{1}{k!}\left(v,u\right)^{k}\\
\log:G\ltimes_{\text{Ad}}\mathfrak{g} & \to\mathfrak{g}\ltimes_{\text{ad}}\mathfrak{h},\,\left(g,w\right)\mapsto\sum_{k=1}^{\infty}\left(-1\right)^{k+1}\frac{\left(\left(g,w\right)-\left(I,0\right)\right)^{k}}{k}.
\end{align*}

\end_inset

These mappings will be helpful when defining the Lie bracket in the Lie
 algebra.
 To define the Lie bracket, we follow the steps outlined in subsection 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:SDP_with_LA"

\end_inset

.
 We repeat them here to show that the derivation is very similar with only
 minor on the definition of the Lie group.
\end_layout

\begin_layout Standard
The first step is to define the conjugate action of the Lie group on itself
 as 
\begin_inset Formula 
\[
\psi:\left(G\ltimes_{\text{Ad}}\mathfrak{g}\right)\times\left(G\ltimes_{\text{Ad}}\mathfrak{g}\right)\to G\ltimes_{\text{Ad}}\mathfrak{g},\,\left(\left(g_{1},w_{1}\right),\left(g_{2},w_{2}\right)\right)\mapsto\left(g_{1},w_{1}\right)*\left(g_{2},w_{2}\right)*\left(g_{1},w_{1}\right)^{-1},
\]

\end_inset

and the corresponding automorphism is 
\begin_inset Formula 
\[
\Psi_{\left(g_{1},w_{1}\right)}:G\ltimes_{\text{Ad}}\mathfrak{g}\to G\ltimes_{\text{Ad}}\mathfrak{g}.
\]

\end_inset

The adjoint action of the Lie group on it's Lie algebra is defined as 
\begin_inset Formula 
\[
\left.\frac{d}{dt}\right|_{t=0}\Psi_{\left(g_{1},w_{1}\right)}\left(\exp\left(t\left(v,u\right)\right)\right),
\]

\end_inset

and is denoted 
\begin_inset Formula 
\[
\text{Ad}_{\left(g_{1},w_{1}\right)}:\mathfrak{g}\ltimes_{\text{ad}}\mathfrak{h}\to\mathfrak{g}\ltimes_{\text{ad}}\mathfrak{h}.
\]

\end_inset

The adjoint action of a Lie algebra on itself is defined as 
\begin_inset Formula 
\[
\left.\frac{d}{dt}\right|_{t=0}\text{Ad}_{\exp t\left(v_{1},u_{1}\right)}\left(v_{2},u_{2}\right),
\]

\end_inset

and is denoted 
\begin_inset Formula 
\[
\text{ad}_{\left(v_{1},u_{1}\right)}:\mathfrak{g}\ltimes_{\text{ad}}\mathfrak{h}\to\mathfrak{g}\ltimes_{\text{ad}}\mathfrak{h},
\]

\end_inset

and is equivalent to the Lie bracket.
 
\end_layout

\begin_layout Standard
The matrix exponential, matrix logarithm, adjoint actions, and Lie bracket
 have simplified versions for each left and right trivialized case.
 These are shown in table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:SDP_LA"

\end_inset

.
 In the table we have used the notation 
\begin_inset Formula $\exp_{G}$
\end_inset

 and 
\begin_inset Formula $\log_{G}$
\end_inset

 to indicate that these mappings are the ones defined on the group.
 Also, where there is 
\begin_inset Formula $\text{Ad}_{G}$
\end_inset

 or 
\begin_inset Formula $\text{ad}_{\mathfrak{g}}$
\end_inset

, these are the adjoint actions defined in the group and Lie algebra.
 For more information about this table, see 
\begin_inset CommandInset citation
LatexCommand cite
key "Engo2003"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathfrak{g}\ltimes_{\text{ad}}\mathfrak{h}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Left
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Right
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\exp\left(v,u\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\exp_{G}\left(v\right),\text{dexp}_{v,l}\left(u\right)\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\exp_{G}\left(v\right),\text{dexp}_{v,r}\left(u\right)\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\log\left(g,w\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\log_{G}\left(g\right),\text{dexp}_{\log\left(g\right),l}^{-1}\left(w\right)\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\log_{G}\left(g\right),\text{dexp}_{\log\left(g\right),r}^{-1}\left(w\right)\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\text{Ad}_{\left(g,w\right)}\left(v,u\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\text{Ad}_{g}v,\text{Ad}_{g}\left(-\text{ad}_{v}w+u\right)\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\text{Ad}_{g}v,-\text{ad}_{\text{Ad}_{g}v}w+\text{Ad}_{g}u\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left[\left(v_{1},u_{1}\right),\left(v_{2},u_{2}\right)\right]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\text{ad}_{v_{1}}v_{2},-\text{ad}_{v_{2}}u_{1}+\text{ad}_{v_{1}}u_{2}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\text{ad}_{v_{1}}v_{2},-\text{ad}_{v_{2}}u_{1}+\text{ad}_{v_{1}}u_{2}\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\text{dexp}_{\left(v_{1},u_{1}\right)}^{-1}\left(v_{2},u_{2}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\sum_{k=0}^{\infty}\frac{B_{k}}{k!}\left(-\text{ad}_{\left(v_{1},u_{1}\right)}\right)^{k}\left(u_{2},v_{2}\right)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\sum_{k=0}^{\infty}\frac{B_{k}}{k!}\left(\text{ad}_{\left(v_{1},u_{1}\right)}\right)^{k}\left(u_{2},v_{2}\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Semi-direct product Lie algebra operations
\begin_inset CommandInset label
LatexCommand label
name "tab:SDP_LA"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Example

\series bold
(Lie algebra of 
\begin_inset Formula $SE\left(n\right)\ltimes_{\text{Ad}}\mathfrak{se}\left(n\right)$
\end_inset

).
 
\series default
This example is a continuation of example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:SE3_LA"

\end_inset

.
 Recall that 
\begin_inset Formula $SO\left(n\right)\ltimes_{\Phi}\mathbb{R}^{n}$
\end_inset

 is isomorphic to 
\begin_inset Formula $SE\left(n\right)$
\end_inset

, in fact 
\begin_inset Formula $SE\left(n\right)$
\end_inset

 is just a matrix representation of 
\begin_inset Formula $SO\left(n\right)\ltimes_{\Phi}\mathbb{R}^{n}$
\end_inset

.
 
\begin_inset Formula $SE\left(n\right)$
\end_inset

 has the familiar matrix form 
\begin_inset Formula 
\[
\begin{bmatrix}R & p\\
0 & 1
\end{bmatrix},
\]

\end_inset

where 
\begin_inset Formula $R\in SO\left(n\right)$
\end_inset

 and 
\begin_inset Formula $p\in\mathbb{R}^{n}$
\end_inset

.
 It's Lie algebra has the form 
\begin_inset Formula 
\[
\begin{bmatrix}\omega & \rho\\
0 & 0
\end{bmatrix},
\]

\end_inset

where 
\begin_inset Formula $\omega\in\mathfrak{so}\left(n\right)$
\end_inset

 and 
\begin_inset Formula $\rho\in\mathbb{R}^{n}$
\end_inset

.
 We define the semi-direct product 
\series bold

\begin_inset Formula $SE\left(n\right)\ltimes_{\text{Ad}}\mathfrak{se}\left(n\right)$
\end_inset

 
\series default
with the group action being defined by the left trivialized case.
 An example of group multiplication is 
\begin_inset Formula 
\[
\left(\begin{bmatrix}R_{1} & p_{1}\\
0 & 1
\end{bmatrix},\begin{bmatrix}\omega_{1} & \rho_{1}\\
0 & 0
\end{bmatrix}\right)*\left(\begin{bmatrix}R_{2} & p_{2}\\
0 & 1
\end{bmatrix},\begin{bmatrix}\omega_{2} & \rho_{2}\\
0 & 0
\end{bmatrix}\right)=\left(\begin{bmatrix}R_{1}R_{2} & R_{1}p_{2}+p_{1}\\
0 & 0
\end{bmatrix},\begin{bmatrix}R_{2}\omega_{1}R_{2}^{-1} & -R_{2}\omega_{1}R_{2}^{-1}p_{2}+R_{2}\rho_{1}\\
0 & 0
\end{bmatrix}+\begin{bmatrix}\omega_{2} & \rho_{2}\\
0 & 0
\end{bmatrix}\right).
\]

\end_inset

The identity element is 
\begin_inset Formula 
\[
\left(\begin{bmatrix}I & 0\\
0 & 1
\end{bmatrix},\begin{bmatrix}0 & 0\\
0 & 0
\end{bmatrix}\right),
\]

\end_inset

and the inverse element is 
\begin_inset Formula 
\[
\left(\begin{bmatrix}R^{-1} & -R^{-1}p\\
0 & 1
\end{bmatrix},\begin{bmatrix}-R\omega R^{-1} & R\omega R^{-1}p-R\rho\\
0 & 0
\end{bmatrix}\right).
\]

\end_inset


\end_layout

\begin_layout Example
The matrix exponential is 
\begin_inset Formula 
\[
\exp\left(\underbrace{\begin{bmatrix}\nu & \zeta\\
0 & 0
\end{bmatrix}}_{v},\underbrace{\begin{bmatrix}\upsilon & \eta\\
0 & 0
\end{bmatrix}}_{u}\right)=\left(\exp\left(v\right),\text{dexp}_{v,l}u\right),
\]

\end_inset

where 
\begin_inset Formula $\text{dexp}$
\end_inset

 is defined in appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Deriv_Exp"

\end_inset

.
\end_layout

\begin_layout Example
The matrix logarithm is 
\begin_inset Formula 
\[
\log\left(\underbrace{\begin{bmatrix}R & p\\
0 & 1
\end{bmatrix}}_{g},\underbrace{\begin{bmatrix}\omega & \rho\\
0 & 0
\end{bmatrix}}_{w}\right)=\left(\log\left(g\right),\text{dexp}_{\log\left(g\right),l}^{-1}\left(w\right)\right),
\]

\end_inset

where 
\begin_inset Formula $\text{dexp}^{-1}$
\end_inset

 is defined in appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Deriv_Exp"

\end_inset

.
\end_layout

\begin_layout Example
The adjoint action of the Lie group on the Lie algebra is 
\begin_inset Formula 
\[
\text{Ad}_{\left(g,w\right)}\left(v,u\right)=\left(\begin{bmatrix}R\nu R^{-1} & -R\nu R^{-1}p+R\zeta\\
0 & 0
\end{bmatrix},\text{Ad}_{g}\left(wv-vw+u\right)\right).
\]

\end_inset

Lastly the Lie bracket is 
\begin_inset Formula 
\[
\left[\left(\underbrace{\begin{bmatrix}\nu_{1} & \zeta_{1}\\
0 & 0
\end{bmatrix}}_{v_{1}},\underbrace{\begin{bmatrix}\upsilon_{1} & \eta_{1}\\
0 & 0
\end{bmatrix}}_{u_{1}}\right),\left(\underbrace{\begin{bmatrix}\nu_{2} & \zeta_{2}\\
0 & 1
\end{bmatrix}}_{v_{2}},\underbrace{\begin{bmatrix}\upsilon_{2} & \eta_{2}\\
0 & 0
\end{bmatrix}}_{u_{2}}\right)\right]=\left(\text{ad}_{v_{1}}v_{2},-\text{ad}_{v_{2}}u_{1}+\text{ad}_{v_{1}}u_{2}\right),
\]

\end_inset

where 
\begin_inset Formula 
\[
\text{ad}_{x}y=xy-yx.
\]

\end_inset


\end_layout

\begin_layout Section
The Derivative of the Exponential Mapping and It's Inverse
\begin_inset CommandInset label
LatexCommand label
name "sec:Deriv_Exp"

\end_inset


\end_layout

\begin_layout Standard
The derivative of the exponential mapping and it's inverse is commonly used
 in Lie theory such as in proving the Baker-Campbell-Hausdorff formula 
\begin_inset CommandInset citation
LatexCommand cite
key "Hall2003"

\end_inset

, and in many numerical integration techniques for solving ODE 
\begin_inset CommandInset citation
LatexCommand cite
key "Iserles2000"

\end_inset

.
 We present the general form of the derivative of the exponential mapping
 with it's inverse, and it's computationally efficient form for 
\begin_inset Formula $SO\left(3\right)$
\end_inset

 and 
\begin_inset Formula $SE\left(3\right)$
\end_inset

.
\end_layout

\begin_layout Subsection
General Form
\end_layout

\begin_layout Theorem
Let 
\begin_inset Formula $X\left(t\right)$
\end_inset

 be a smooth matrix-valued function, then
\begin_inset Formula 
\begin{equation}
\frac{d}{dt}\exp\left(X\left(t\right)\right)=\exp\left(X\left(t\right)\right)\frac{I-\exp\left(-ad_{X\left(t\right)}\right)}{ad_{X\left(t\right)}}\left(\frac{dX}{dt}\right).\label{eq:dexp_left}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
This theorem is proved in 
\begin_inset CommandInset citation
LatexCommand cite
key "Hall2003"

\end_inset

.
 
\end_layout

\begin_layout Standard
When we refer to the derivative of the matrix exponential we refer to 
\begin_inset Formula 
\[
\text{dexp}_{X\left(t\right),l}=\frac{I-\exp\left(-ad_{X\left(t\right)}\right)}{ad_{X\left(t\right)}},
\]

\end_inset

where the subscript 
\begin_inset Formula $l$
\end_inset

 denotes that it is left trivialized.
 The right derivative of the matrix exponential is found using the adjoint
\begin_inset Formula 
\begin{align*}
\text{dexp}_{X\left(t\right),r} & =Ad_{X\left(t\right)}\left(\text{dexp}_{X\left(t\right),l}\right)\\
 & =\frac{\exp\left(X\left(t\right)\right)-I}{ad_{X\left(t\right)}}.
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
The derivative of the matrix exponential also have their geometric series
 representation
\begin_inset Formula 
\begin{align*}
\text{dexp}_{X\left(t\right),l} & =\sum_{k=0}^{\infty}\left(-1\right)^{k}\frac{ad_{X\left(t\right)}^{k}}{\left(k+1\right)!}\\
\text{dexp}_{X\left(t\right),r} & =\sum_{k=0}^{\infty}\frac{ad_{X\left(t\right)}^{k}}{\left(k+1\right)!}.
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Their inverses are 
\begin_inset Formula 
\begin{align*}
\text{dexp}_{X\left(t\right),l}^{-1} & =\\
 & =\sum_{k=0}^{\infty}\left(-1\right)^{k}\frac{B_{k}}{k!}ad_{X\left(t\right)}^{k}
\end{align*}

\end_inset


\begin_inset Formula 
\begin{align*}
\text{dexp}_{X\left(t\right),r}^{-1} & =\frac{ad_{X\left(t\right)}}{\exp\left(X\left(t\right)\right)-I}\\
 & =\sum_{k=0}^{\infty}\frac{B_{k}}{k!}ad_{X\left(t\right)}^{k},
\end{align*}

\end_inset

where 
\begin_inset Formula $B_{k}$
\end_inset

 are Bernoulli numbers.
 
\end_layout

\begin_layout Remark
Not every adjoint of a Lie algebra can be inverted.
 In these cases you must use the geometric series.
 In some special cases, the derivative of the matrix exponential and it's
 inverse have closed forms.
 We present the closed form solutions for 
\begin_inset Formula $SO\left(3\right)$
\end_inset

 and 
\begin_inset Formula $SE\left(3\right)$
\end_inset

 next.
\end_layout

\begin_layout Subsection
\begin_inset Formula $SO\left(3\right)$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sub:dexp_so3"

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $x\in\mathfrak{so}\left(3\right)$
\end_inset

 with norm 
\begin_inset Formula $\theta=\left\Vert x\right\Vert $
\end_inset

 then 
\begin_inset Formula 
\begin{align*}
\text{dexp}_{x,l} & =I+\frac{\cos\left(\theta\right)-1}{\theta^{2}}x+\frac{\theta-\sin\left(\theta\right)}{\theta^{3}}x^{2}\\
\text{dexp}_{x,r} & =I+\frac{1-\cos\left(\theta\right)}{\theta^{2}}x+\frac{\theta-\sin\left(\theta\right)}{\theta^{3}}x^{2}
\end{align*}

\end_inset

It is instructive to see the derivation for at least one of the above terms.
 In the derivation we will use the property of a skew symmetric matrix that
\begin_inset Formula 
\begin{align*}
ad_{x} & =x\\
ad_{x}^{2} & =x^{2}\\
ad_{x}^{2n+1} & =\left(-1\right)^{n}\left\Vert x\right\Vert ^{2n}x\\
ad_{x}^{2n+2} & =\left(-1\right)^{n}\left\Vert x\right\Vert ^{2n}x^{2},
\end{align*}

\end_inset

for 
\begin_inset Formula $n\geq0$
\end_inset

.
 The derivation proceeds as follows 
\begin_inset Formula 
\begin{align*}
\text{dexp}_{x,l} & =\sum_{k=0}^{\infty}\left(-1\right)^{k}\frac{ad_{X\left(t\right)}^{k}}{\left(k+1\right)!}\\
 & =\sum_{k=0}^{\infty}\left(-1\right)^{k}\frac{x^{k}}{\left(k+1\right)!}\\
 & =I-\frac{1}{2!}x+\frac{1}{3!}x^{2}+\frac{\left\Vert x\right\Vert ^{2}}{4!}x-\frac{\left\Vert x\right\Vert ^{2}}{5!}x^{2}\cdots\\
 & =I+\left[\left(1-\frac{\left\Vert x\right\Vert ^{2}}{2!}+\frac{\left\Vert x\right\Vert ^{4}}{4!}\cdots\right)-1\right]\frac{x}{\left\Vert x\right\Vert ^{2}}+\left[1-\left(\left\Vert x\right\Vert -\frac{\left\Vert x\right\Vert ^{3}}{3!}+\frac{\left\Vert x\right\Vert ^{5}}{5!}\cdots\right)/\left\Vert x\right\Vert \right]\frac{x^{2}}{\left\Vert x\right\Vert ^{2}}\\
 & =I+\frac{\cos\left(\theta\right)-1}{\theta^{2}}x+\frac{\theta-\sin\left(\theta\right)}{\theta^{3}}x^{2}.
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Their corresponding inverses are 
\begin_inset Formula 
\begin{align*}
\text{dexp}_{x,l}^{-1} & =I+\frac{1}{2}x-\frac{\left\Vert x\right\Vert \cot\left(\frac{\left\Vert x\right\Vert }{2}\right)-2}{2\left\Vert x\right\Vert ^{2}}x^{2}\\
\text{dexp}_{x,r}^{-1} & =I-\frac{1}{2}x-\frac{\left\Vert x\right\Vert \cot\left(\frac{\left\Vert x\right\Vert }{2}\right)-2}{2\left\Vert x\right\Vert ^{2}}x^{2}
\end{align*}

\end_inset


\end_layout

\begin_layout Subsection
\begin_inset Formula $SE\left(3\right)$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "sub:dexp_se3"

\end_inset


\end_layout

\begin_layout Standard
An element 
\begin_inset Formula $x\in\mathfrak{se}\left(3\right)$
\end_inset

 has the form 
\begin_inset Formula 
\[
x=\begin{bmatrix}w & v\\
0_{3\times1} & 0
\end{bmatrix}
\]

\end_inset

where 
\begin_inset Formula $w\in\mathfrak{so}\left(3\right)$
\end_inset

 and 
\begin_inset Formula $v\in\mathbb{R}^{3}$
\end_inset

.
 The adjoint of 
\begin_inset Formula $x$
\end_inset

 and it's powers are 
\begin_inset Formula 
\begin{align*}
ad_{x} & =\begin{bmatrix}w & v_{\times}\\
0_{3\times3} & w
\end{bmatrix}\\
ad_{x}^{2} & =\begin{bmatrix}w^{2} & \left(wv_{\times}+v_{\times}w\right)\\
 & w^{2}
\end{bmatrix}\\
ad_{x}^{3} & =-\theta^{2}ad_{x}-2\left(\left(w^{\vee}\right)^{\top}v\right)\begin{bmatrix}0 & w\\
0 & 0
\end{bmatrix}\\
ad_{x}^{2n+1} & =\left(-1\right)^{n}\left(\theta^{2n}ad_{x}+\begin{bmatrix}0 & \alpha\left(n\right)w\\
0 & 0
\end{bmatrix}\right)\\
ad_{x}^{2n+2} & =\left(-1\right)^{n}\left(\theta^{2n}ad_{x}^{2}+\begin{bmatrix}0 & \alpha\left(n\right)w^{2}\\
0 & 0
\end{bmatrix}\right),
\end{align*}

\end_inset

for 
\begin_inset Formula $n\geq0$
\end_inset

 and where
\begin_inset Formula 
\[
\alpha\left(n\right)=\left(2n\right)\left(\left(w^{\vee}\right)^{\top}v\right)\theta^{2\left(n-1\right)}.
\]

\end_inset

The geometric series of 
\begin_inset Formula $\text{dexp}_{x,l}$
\end_inset

 is 
\begin_inset Formula 
\begin{align*}
\text{dexp}_{-x} & =\sum_{k=0}^{\infty}\left(-1\right)^{k}\frac{ad_{X\left(t\right)}^{k}}{\left(k+1\right)!}\\
 & =1+\sum_{n=0}^{\infty}\frac{\left(-1\right)^{2n+1}}{\left(2n+2\right)!}ad_{x}^{2n+1}+\sum_{n=0}^{\infty}\frac{\left(-1\right)^{2n+2}}{\left(2n+3\right)!}ad_{x}^{2n+2}\\
 & =1+\sum_{n=0}^{\infty}\frac{\left(-1\right)^{2n+1}}{\left(2n+2\right)!}\left(-1\right)^{n}\left(\theta^{2n}ad_{x}+\begin{bmatrix}0 & \alpha\left(n\right)w\\
0 & 0
\end{bmatrix}\right)+\sum_{n=0}^{\infty}\frac{\left(-1\right)^{2n+2}}{\left(2n+3\right)!}\left(-1\right)^{n}\left(\theta^{2n}ad_{x}^{2}+\begin{bmatrix}0 & \alpha\left(n\right)w^{2}\\
0 & 0
\end{bmatrix}\right)\\
 & =1+\sum_{n=0}^{\infty}\frac{\left(-1\right)^{2n+1}}{\left(2n+2\right)!}\left(-1\right)^{n}\left(\theta^{2n}ad_{x}+\begin{bmatrix}0 & \alpha\left(n\right)w\\
0 & 0
\end{bmatrix}\right)+\sum_{n=0}^{\infty}\frac{\left(-1\right)^{2n+2}}{\left(2n+3\right)!}\left(-1\right)^{n}\left(\theta^{2n}ad_{x}^{2}+\right)\\
 & =1+\sum_{n=0}^{\infty}\frac{\left(-1\right)^{n+1}}{\left(2n+2\right)!}\theta^{2n}ad_{x}+\sum_{n=0}^{\infty}\frac{\left(-1\right)^{n+2}}{\left(2n+3\right)!}\theta^{2n}ad_{x}^{2}+\sum_{n=0}^{\infty}\frac{\left(-1\right)^{n+1}}{\left(2n+2\right)!}\begin{bmatrix}0 & \alpha\left(n\right)w\\
0 & 0
\end{bmatrix}+\sum_{n=0}^{\infty}\frac{\left(-1\right)^{n+2}}{\left(2n+3\right)!}\begin{bmatrix}0 & \alpha\left(n\right)w^{2}\\
0 & 0
\end{bmatrix}.
\end{align*}

\end_inset

We can solve for the closed form solution of this geometric series by solving
 for the closed form solution of the sub geometric series.
 We already know 
\begin_inset Formula 
\begin{align*}
\sum_{n=0}^{\infty}\frac{\left(-1\right)^{n+1}}{\left(2n+2\right)!}\theta^{2n}ad_{x} & =\frac{\cos\left(\theta\right)-1}{\theta^{2}}ad_{x}\\
\sum_{n=0}^{\infty}\frac{\left(-1\right)^{n+2}}{\left(2n+3\right)!}\theta^{2n}ad_{x}^{2} & =\frac{\theta-\sin\left(\theta\right)}{\theta^{3}}ad_{x}^{2}
\end{align*}

\end_inset

since they were solved in subsection 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:dexp_so3"

\end_inset

.
 This leaves us to solve the other two series.
 We being with 
\begin_inset Formula 
\[
\sum_{n=0}^{\infty}\frac{\left(-1\right)^{n+1}}{\left(2n+2\right)!}\begin{bmatrix}0 & \alpha\left(n\right)w\\
0 & 0
\end{bmatrix}
\]

\end_inset

which can be written as 
\begin_inset Formula 
\[
\left(w^{\vee}\right)^{\top}v\left(\sum_{n=0}^{\infty}\frac{\left(-1\right)^{n+1}\left(2n\right)}{\left(2n+2\right)!}\theta^{2\left(n-1\right)}\right)\begin{bmatrix}0 & w\\
0 & 0
\end{bmatrix},
\]

\end_inset

thus were left with solving for 
\begin_inset Formula 
\begin{align*}
\sum_{n=0}^{\infty}\frac{\left(-1\right)^{n+1}\left(2n\right)}{\left(2n+2\right)!}\theta^{2\left(n-1\right)} & =0+\frac{2}{4!}-\frac{4}{6!}\theta^{2}+\frac{6}{8!}\theta^{4}-\frac{8}{10!}\theta^{6}+\frac{10}{12!}\theta^{8}\cdots\\
 & =\left(\frac{1}{3!}-\frac{1}{5!}\theta^{2}+\frac{1}{7!}\theta^{4}-\frac{1}{9!}\theta^{6}\cdots\right)+\left(\frac{-2}{4!}+\frac{2}{6!}\theta^{2}-\frac{2}{8!}\theta^{4}+\frac{2}{10!}\theta^{6}\cdots\right)\\
 & =\frac{1}{\theta^{2}}-\frac{1}{\theta^{3}}\left(\theta-\frac{1}{3!}\theta^{3}+\frac{1}{5!}\theta^{5}-\frac{1}{7!}\theta^{7}+\frac{1}{9!}\theta^{9}\cdots\right)+-\frac{1}{\theta^{2}}+\frac{2}{\theta^{4}}-\frac{2}{\theta^{4}}\left(1-\frac{1}{2}\theta^{2}+\frac{1}{4!}\theta^{4}-\frac{1}{6!}\theta^{6}+\frac{1}{8!}\theta^{8}-\frac{1}{10!}\theta^{10}\cdots\right)\\
 & =-\frac{1}{\theta^{3}}\sin\left(\theta\right)+2\left(\frac{1-\cos\left(\theta\right)}{\theta^{4}}\right),
\end{align*}

\end_inset

where we used the identity 
\begin_inset Formula 
\[
\frac{n-2}{n!}=\frac{1}{\left(n-1\right)!}-\frac{2}{n!}.
\]

\end_inset

Note that you can calculate the geometric series with the first few terms
 (about 2-3) and have very little error (about 
\begin_inset Formula $10^{-7}$
\end_inset

).
 We calculate the second series in a similar manner.
 The series
\begin_inset Formula 
\[
\sum_{n=0}^{\infty}\frac{\left(-1\right)^{n+2}}{\left(2n+3\right)!}\begin{bmatrix}0 & \alpha\left(n\right)w^{2}\\
0 & 0
\end{bmatrix}
\]

\end_inset

can be written as 
\begin_inset Formula 
\[
\left(w^{\vee}\right)^{\top}v\left(\sum_{n=0}^{\infty}\frac{\left(-1\right)^{n+2}\left(2n\right)}{\left(2n+3\right)!}\theta^{2\left(n-1\right)}\right)\begin{bmatrix}0 & w^{2}\\
0 & 0
\end{bmatrix},
\]

\end_inset

thus we are left with solving for 
\begin_inset Formula 
\begin{align*}
\sum_{n=0}^{\infty}\frac{\left(-1\right)^{n+2}\left(2n\right)}{\left(2n+3\right)!}\theta^{2\left(n-1\right)} & =0-\frac{2}{5!}+\frac{4}{7!}\theta^{2}-\frac{6}{9!}\theta^{4}+\frac{8}{11!}\theta^{6}\cdots\\
 & =\left(\frac{3}{5!}-\frac{3}{7!}\theta^{2}+\frac{3}{9!}\theta^{4}-\frac{3}{11!}\theta^{6}\cdots\right)+\left(-\frac{1}{4!}+\frac{1}{6!}\theta^{2}-\frac{1}{8!}\theta^{4}+\frac{1}{10!}\theta^{6}\cdots\right)\\
 & =-\frac{3}{\theta^{4}}+\frac{3}{3!\theta^{2}}+\frac{3}{\theta^{5}}\left(\theta-\frac{1}{3!}\theta^{3}+\frac{1}{5!}\theta^{5}-\frac{1}{7!}\theta^{7}+\frac{1}{9!}\theta^{9}-\frac{1}{11!}\theta^{11}\cdots\right)+\frac{1}{\theta^{4}}-\frac{1}{2!\theta^{2}}-\frac{1}{\theta^{4}}\left(1-\frac{1}{2!}\theta^{2}+\frac{1}{4!}\theta^{4}-\frac{1}{6!}\theta^{6}+\frac{1}{8!}\theta^{8}-\frac{1}{10!}\theta^{10}\cdots\right)\\
 & =-\frac{2}{\theta^{4}}+\frac{3}{\theta^{5}}\sin\left(\theta\right)-\frac{1}{\theta^{4}}\cos\left(\theta\right),
\end{align*}

\end_inset

where we used the identity 
\begin_inset Formula 
\[
\frac{n-3}{n!}=\frac{1}{\left(n-1\right)!}-\frac{3}{n!}.
\]

\end_inset


\end_layout

\begin_layout Standard
For clarity, let 
\begin_inset Formula 
\begin{align*}
a_{\theta} & =\frac{\cos\left(\theta\right)-1}{\theta^{2}}\\
b_{\theta} & =\frac{\theta-\sin\left(\theta\right)}{\theta^{3}}\\
c_{\theta} & =-\frac{1}{\theta^{3}}\sin\left(\theta\right)+2\left(\frac{1-\cos\left(\theta\right)}{\theta^{4}}\right)\\
d_{\theta} & =-\frac{2}{\theta^{4}}+\frac{3}{\theta^{5}}\sin\left(\theta\right)-\frac{1}{\theta^{4}}\cos\left(\theta\right)\\
q_{-x}\left(w\right) & =\left(\left(w^{\vee}\right)^{\top}v\right)\left(c_{\theta}w+d_{\theta}w^{2}\right).
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Putting all of the pieces together we get
\begin_inset Formula 
\[
\text{dexp}_{-x}=\begin{bmatrix}\text{dexp}_{-w} & \left(a_{\theta}v_{\times}+b_{\theta}\left(wv_{\times}+v_{\times}w\right)+q_{-x}\left(w\right)\right)\\
0 & \text{dexp}_{-w}
\end{bmatrix}.
\]

\end_inset

The closed form solution for 
\begin_inset Formula $\text{dexp}_{x,r}$
\end_inset

 is derived in a similar manner, which we will not do here; however, its
 closed form is 
\begin_inset Formula 
\[
\text{dexp}_{x}=\begin{bmatrix}\text{dexp}_{w} & \left(-a_{\theta}+b_{\theta}\left(wv_{\times}+v_{\times}w\right)+q_{x}\left(w\right)\right)\\
 & \text{dexp}_{w}
\end{bmatrix}
\]

\end_inset

where
\begin_inset Formula 
\[
q_{x}\left(w\right)=\left(\left(w^{\vee}\right)^{\top}v\right)\left(-c_{\theta}w+d_{\theta}w^{2}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
The inverses of 
\begin_inset Formula $\text{dexp}_{x,r}$
\end_inset

 and 
\begin_inset Formula $\text{dexp}_{x,l}$
\end_inset

 are easily computed since a square block matrix 
\begin_inset Formula $M$
\end_inset

 with the from 
\begin_inset Formula 
\[
M=\begin{bmatrix}A & B\\
0 & A
\end{bmatrix}
\]

\end_inset

has an inverse
\begin_inset Formula 
\[
M^{-1}=\begin{bmatrix}A^{-1} & -A^{-1}BA^{-1}\\
0 & A^{-1}
\end{bmatrix}.
\]

\end_inset

Using this identity we compute 
\begin_inset Formula 
\begin{align*}
\text{dexp}_{x,l}^{-1} & =\begin{bmatrix}\text{dexp}_{-w}^{-1} & \text{dexp}_{-w}^{-1}B_{-x}\text{dexp}_{-w}^{-1}\\
0 & \text{dexp}_{-w}^{-1}
\end{bmatrix}\\
\text{dexp}_{x,r}^{-1} & =\begin{bmatrix}\text{dexp}_{w}^{-1} & \text{dexp}_{w}^{-1}B_{x}\text{dexp}_{w}^{-1}\\
0 & \text{dexp}_{w}^{-1}
\end{bmatrix}
\end{align*}

\end_inset

where 
\begin_inset Formula 
\begin{align*}
B_{x,l} & =\left(a_{\theta}v_{\times}+b_{\theta}\left(wv_{\times}+v_{\times}w\right)+q_{-x}\left(w\right)\right)\\
B_{x,r} & =\left(-a_{\theta}v_{\times}+b_{\theta}\left(wv_{\times}+v_{\times}w\right)+q_{x}\left(w\right)\right).
\end{align*}

\end_inset


\end_layout

\begin_layout Section
Classical Runge-Kutta Methods
\begin_inset CommandInset label
LatexCommand label
name "sec:Classical-Runge-Kutta-Methods"

\end_inset


\end_layout

\begin_layout Standard
Consider the 1st order ordinary differential equation with initial conditions
\begin_inset Formula 
\[
\dot{y}=f\left(t,y\right),\,y\left(0\right)=y_{0}.
\]

\end_inset


\end_layout

\begin_layout Standard
The Taylor series expansion of 
\begin_inset Formula $y\left(t\right)$
\end_inset

 is 
\begin_inset Formula 
\begin{align*}
y\left(t+h\right) & =y\left(t\right)+h\dot{y}\left(t\right)+\frac{h^{2}}{2!}\ddot{y}\left(t\right)+\frac{h^{3}}{3!}\dddot{y}\left(t\right)+\frac{h^{4}}{4!}\ddddot{y}\left(t\right)+\mathcal{O}\left(h^{5}\right)\\
 & =y\left(t\right)+hf\left(t,y\right)+\frac{h^{2}}{2}\frac{d}{dt}f\left(t,y\right)+\frac{h^{3}}{3!}\frac{d^{2}}{dt^{2}}f\left(t,y\right)+\frac{h^{4}}{4!}\frac{d^{3}}{dt^{3}}f\left(t,y\right)+\mathcal{O}\left(h^{5}\right).
\end{align*}

\end_inset

The idea of the Runge-Kutta method is to construct a new vector field 
\begin_inset Formula $\bar{f}\left(t,y\right)$
\end_inset

 from 
\begin_inset Formula $f\left(t,y\right)$
\end_inset

 that is equivalent to Taylor series up to some order 
\begin_inset Formula $k$
\end_inset

 such that 
\begin_inset Formula 
\[
y\left(t+h\right)=y\left(t\right)+h\bar{f}\left(t,y\right)+\mathcal{O}\left(h^{k+1}\right).
\]

\end_inset

In the case the RK method is of order 2, the new vector field 
\begin_inset Formula $\bar{f}\left(t,y\right)$
\end_inset

 would be equivalent to 
\begin_inset Formula 
\[
\bar{f}\left(t,y\right)=f\left(t,y\right)+\frac{h}{2}\frac{d}{dt}f\left(t,y\right)+\mathcal{O}\left(h^{3}\right),
\]

\end_inset

and the Taylor series would be 
\begin_inset Formula 
\[
y\left(t+h\right)=y\left(t\right)+h\bar{f}\left(t,y\right)+\mathcal{O}\left(h^{3}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
The derivation of RK methods of order greater than 2 is complex, and we
 refer the interested reader to 
\begin_inset CommandInset citation
LatexCommand cite
key "Butcher2008"

\end_inset

.
 However, we will derive the order 2 method and give an example of it.
\end_layout

\begin_layout Subsection
Explicit RK Order 2
\end_layout

\begin_layout Standard
We return to the Taylor series expansion of 
\begin_inset Formula $y\left(t\right)$
\end_inset


\begin_inset Formula 
\[
y\left(t+h\right)=y\left(t\right)+hf\left(t,y\right)+\frac{h^{2}}{2}\frac{d}{dt}f\left(t,y\right)+\frac{h^{3}}{3!}\frac{d^{2}}{dt^{2}}f\left(t,y\right)+\frac{h^{4}}{4!}\frac{d^{3}}{dt^{3}}f\left(t,y\right)+\mathcal{O}\left(h^{5}\right),
\]

\end_inset

and take the derivative of the vector field 
\begin_inset Formula $f\left(t,y\right)$
\end_inset

 with respect to time
\begin_inset Formula 
\begin{align*}
\frac{d}{dt}f\left(t,y\right) & =\frac{\partial f}{\partial t}\frac{dt}{dt}+\frac{\partial f}{\partial y}\frac{dy}{dt}\\
 & =\frac{\partial f}{\partial t}1+\frac{\partial f}{\partial y}f\left(t,y\right)\\
 & =f_{t}\left(t,y\right)+f_{y}\left(t,y\right)f\left(t,y\right).
\end{align*}

\end_inset

The derivative can be substituted into the Taylor series and then simplified
 to get 
\begin_inset Formula 
\begin{align}
y\left(t+h\right) & =y\left(t\right)+hf\left(t,y\right)+\frac{h^{2}}{2}\left(f_{t}\left(t,y\right)+f_{y}\left(t,y\right)f\left(t,y\right)\right)+O\left(h^{3}\right)\nonumber \\
 & =y\left(t\right)+\frac{h}{2}f\left(t,y\right)+\frac{h}{2}\left(f\left(t,y\right)+hf_{t}\left(t,y\right)+hf_{y}\left(t,y\right)f\left(t,y\right)\right)+O\left(h^{3}\right).\label{eq:CRK_TS3}
\end{align}

\end_inset

Before we can simplify this expression more, we need to look at the bivariate
 Taylor series expansion.
 
\end_layout

\begin_layout Standard
The Bivariate Taylor series expansion is defined as 
\begin_inset Formula 
\[
x\left(t+h,z+k\right)=\sum_{n=0}^{\infty}\frac{1}{n!}\left(h\frac{\partial}{\partial t}+k\frac{\partial}{\partial z}\right)^{n}f\left(t,y\right),
\]

\end_inset

and can be written as
\begin_inset Formula 
\[
x\left(t+h,z+k\right)=x\left(t,z\right)+hx_{t}\left(t,z\right)+kf_{z}\left(t,z\right)+O\left(h^{2},k^{2}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
Using the Bivariate Taylor series expansion we can approximate 
\begin_inset Formula 
\[
f\left(t+h,y+k\right)\approx f\left(t,y\right)+hf_{t}\left(t,y\right)+kf_{y}\left(t,y\right).
\]

\end_inset

 If we let 
\begin_inset Formula $k=hf\left(t,y\right)$
\end_inset

 then 
\begin_inset Formula 
\[
f\left(t+h,y+hf\left(t,y\right)\right)\approx f\left(t,y\right)+hf_{t}\left(t,y\right)+hf\left(t,y\right)f_{y}\left(t,y\right).
\]

\end_inset

We can then substitute this into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:CRK_TS3"

\end_inset

 to get 
\begin_inset Formula 
\[
y\left(t+h\right)=\frac{h}{2}f\left(t,y\right)+\frac{h}{2}f\left(t+h,y+hf\left(t,y\right)\right)+O\left(h^{3}\right),
\]

\end_inset

which gives us the 
\begin_inset Formula $2$
\end_inset

-stage Runge-Kutta Method
\begin_inset Formula 
\begin{align*}
k_{1} & =f\left(t,y\right)\\
k_{2} & =f\left(t+h,y+hk_{1}\right)\\
y\left(t+h\right) & =\frac{h}{2}\left(k_{1}+k_{2}\right).
\end{align*}

\end_inset

This particular second order method is known as the Heun's method.
 
\end_layout

\begin_layout Standard
To solidify what we have just shown, consider the simple ODE 
\begin_inset Formula 
\[
\dot{y}=\frac{1}{2}y^{2}
\]

\end_inset

whose Taylor series is 
\begin_inset Formula 
\[
y\left(t+h\right)=y\left(t\right)+h\left(\frac{1}{2}y^{2}+y\frac{h}{2!}\right)+\mathcal{O}\left(h^{3}\right).
\]

\end_inset

Applying Heun's method we calculate the first two stages 
\begin_inset Formula 
\begin{align*}
k_{1} & =\frac{1}{2}y^{2}\\
k_{2} & =\frac{1}{2}\left(y+\frac{h}{2}y^{2}\right)^{2}\\
 & =\frac{1}{2}\left(y^{2}+hy+\frac{h^{2}}{4}y^{4}\right)\\
 & =\frac{1}{2}\left(y^{2}+hy\right)+\mathcal{O}\left(h^{4}\right)
\end{align*}

\end_inset

and get the final result 
\begin_inset Formula 
\begin{align*}
y\left(t+h\right) & =y\left(t\right)+\frac{1}{2}\left(k_{1}+k_{2}\right)\\
 & =y\left(t\right)+h\left(\frac{1}{2}y^{2}+y\frac{h}{2!}\right)+\mathcal{O}\left(h^{4}\right),
\end{align*}

\end_inset

which is an accurate numerical integration up to the second order.
\end_layout

\begin_layout Subsection
Higher Stages
\end_layout

\begin_layout Standard
An s-stage classical Runge-Kutta method is expressed as 
\begin_inset Formula 
\begin{align*}
k_{i} & =f\left(t+c_{i}h,y_{n}+h\sum_{j<i}^{i}a_{ij}k_{j}\right)\\
y\left(t+h\right) & =y\left(t\right)+\sum_{i=1}^{s}b_{i}k_{i}
\end{align*}

\end_inset

where the coefficients 
\begin_inset Formula $c_{i}$
\end_inset

, 
\begin_inset Formula $b_{i}$
\end_inset

, 
\begin_inset Formula $a_{ij}$
\end_inset

 are read off a Butcher Tableau.
 It should be noted that the number of stages involved does not determine
 the order of the method.
 For RK methods of order 
\begin_inset Formula $4$
\end_inset

 or less, they have as many stages as their order.
 Afterward, you start to need more and more stages for a given order.
 Since this note focuses on explicit RK methods that are 4 stages, we include
 the corresponding Butcher Tableau
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="5">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1/2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1/2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1/2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1/2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1/6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1/3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1/3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1/6
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "/home/mark/Documents/mendeley/library"
options "plain"

\end_inset


\end_layout

\end_body
\end_document
